import{u as ks,w as Me,Y as hn,aj as Xo,a6 as Ve,x as Dt,ak as Bs,al as Qo,am as ta,an as ea,ao as ra,ap as na,aq as ia,ar as sa,as as oa,_ as Kr,H as Mn,n as $t,at as Zi,N as li,V as di,au as fn,ai as Ln}from"./index-ec16bbbc.js";import{B as pi,p as gi,e as aa}from"./baseProvider.esm-72597f3e.js";import{n as ca}from"./nacl-fast-e944f0da.js";function Vi(o){if(!Number.isSafeInteger(o)||o<0)throw new Error(`Wrong positive integer: ${o}`)}function As(o,...t){if(!(o instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(o.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${o.length}`)}function ua(o){if(typeof o!="function"||typeof o.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Vi(o.outputLen),Vi(o.blockLen)}function _n(o,t=!0){if(o.destroyed)throw new Error("Hash instance has been destroyed");if(t&&o.finished)throw new Error("Hash#digest() has already been called")}function ha(o,t){As(o);const e=t.outputLen;if(o.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}const Dn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Is=o=>o instanceof Uint8Array,Hn=o=>new DataView(o.buffer,o.byteOffset,o.byteLength),Be=(o,t)=>o<<32-t|o>>>t,fa=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!fa)throw new Error("Non little-endian hardware is not supported");function Rs(o){if(typeof o!="string")throw new Error(`utf8ToBytes expected string, got ${typeof o}`);return new Uint8Array(new TextEncoder().encode(o))}function mi(o){if(typeof o=="string"&&(o=Rs(o)),!Is(o))throw new Error(`expected Uint8Array, got ${typeof o}`);return o}function Ts(...o){const t=new Uint8Array(o.reduce((r,c)=>r+c.length,0));let e=0;return o.forEach(r=>{if(!Is(r))throw new Error("Uint8Array expected");t.set(r,e),e+=r.length}),t}class Ls{clone(){return this._cloneInto()}}function Cs(o){const t=r=>o().update(mi(r)).digest(),e=o();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>o(),t}function Ps(o=32){if(Dn&&typeof Dn.getRandomValues=="function")return Dn.getRandomValues(new Uint8Array(o));throw new Error("crypto.getRandomValues must be defined")}function la(o,t,e,r){if(typeof o.setBigUint64=="function")return o.setBigUint64(t,e,r);const c=BigInt(32),i=BigInt(4294967295),h=Number(e>>c&i),w=Number(e&i),y=r?4:0,b=r?0:4;o.setUint32(t+y,h,r),o.setUint32(t+b,w,r)}class Os extends Ls{constructor(t,e,r,c){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=c,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Hn(this.buffer)}update(t){_n(this);const{view:e,buffer:r,blockLen:c}=this;t=mi(t);const i=t.length;for(let h=0;h<i;){const w=Math.min(c-this.pos,i-h);if(w===c){const y=Hn(t);for(;c<=i-h;h+=c)this.process(y,h);continue}r.set(t.subarray(h,h+w),this.pos),this.pos+=w,h+=w,this.pos===c&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){_n(this),ha(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:c,isLE:i}=this;let{pos:h}=this;e[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>c-h&&(this.process(r,0),h=0);for(let _=h;_<c;_++)e[_]=0;la(r,c-8,BigInt(this.length*8),i),this.process(r,0);const w=Hn(t),y=this.outputLen;if(y%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const b=y/4,x=this.get();if(b>x.length)throw new Error("_sha2: outputLen bigger than state");for(let _=0;_<b;_++)w.setUint32(4*_,x[_],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:c,finished:i,destroyed:h,pos:w}=this;return t.length=c,t.pos=w,t.finished=i,t.destroyed=h,c%e&&t.buffer.set(r),t}}const mn=BigInt(2**32-1),Xn=BigInt(32);function Ns(o,t=!1){return t?{h:Number(o&mn),l:Number(o>>Xn&mn)}:{h:Number(o>>Xn&mn)|0,l:Number(o&mn)|0}}function da(o,t=!1){let e=new Uint32Array(o.length),r=new Uint32Array(o.length);for(let c=0;c<o.length;c++){const{h:i,l:h}=Ns(o[c],t);[e[c],r[c]]=[i,h]}return[e,r]}const pa=(o,t)=>BigInt(o>>>0)<<Xn|BigInt(t>>>0),ga=(o,t,e)=>o>>>e,ma=(o,t,e)=>o<<32-e|t>>>e,wa=(o,t,e)=>o>>>e|t<<32-e,ya=(o,t,e)=>o<<32-e|t>>>e,va=(o,t,e)=>o<<64-e|t>>>e-32,ba=(o,t,e)=>o>>>e-32|t<<64-e,xa=(o,t)=>t,Ma=(o,t)=>o,_a=(o,t,e)=>o<<e|t>>>32-e,Sa=(o,t,e)=>t<<e|o>>>32-e,Ea=(o,t,e)=>t<<e-32|o>>>64-e,ka=(o,t,e)=>o<<e-32|t>>>64-e;function Ba(o,t,e,r){const c=(t>>>0)+(r>>>0);return{h:o+e+(c/2**32|0)|0,l:c|0}}const Aa=(o,t,e)=>(o>>>0)+(t>>>0)+(e>>>0),Ia=(o,t,e,r)=>t+e+r+(o/2**32|0)|0,Ra=(o,t,e,r)=>(o>>>0)+(t>>>0)+(e>>>0)+(r>>>0),Ta=(o,t,e,r,c)=>t+e+r+c+(o/2**32|0)|0,La=(o,t,e,r,c)=>(o>>>0)+(t>>>0)+(e>>>0)+(r>>>0)+(c>>>0),Ca=(o,t,e,r,c,i)=>t+e+r+c+i+(o/2**32|0)|0,Pa={fromBig:Ns,split:da,toBig:pa,shrSH:ga,shrSL:ma,rotrSH:wa,rotrSL:ya,rotrBH:va,rotrBL:ba,rotr32H:xa,rotr32L:Ma,rotlSH:_a,rotlSL:Sa,rotlBH:Ea,rotlBL:ka,add:Ba,add3L:Aa,add3H:Ia,add4L:Ra,add4H:Ta,add5H:Ca,add5L:La},Kt=Pa,[Oa,Na]=(()=>Kt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(o=>BigInt(o))))(),Ke=new Uint32Array(80),ze=new Uint32Array(80);class qa extends Os{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:r,Bl:c,Ch:i,Cl:h,Dh:w,Dl:y,Eh:b,El:x,Fh:_,Fl:L,Gh:k,Gl:E,Hh:S,Hl:M}=this;return[t,e,r,c,i,h,w,y,b,x,_,L,k,E,S,M]}set(t,e,r,c,i,h,w,y,b,x,_,L,k,E,S,M){this.Ah=t|0,this.Al=e|0,this.Bh=r|0,this.Bl=c|0,this.Ch=i|0,this.Cl=h|0,this.Dh=w|0,this.Dl=y|0,this.Eh=b|0,this.El=x|0,this.Fh=_|0,this.Fl=L|0,this.Gh=k|0,this.Gl=E|0,this.Hh=S|0,this.Hl=M|0}process(t,e){for(let I=0;I<16;I++,e+=4)Ke[I]=t.getUint32(e),ze[I]=t.getUint32(e+=4);for(let I=16;I<80;I++){const N=Ke[I-15]|0,U=ze[I-15]|0,B=Kt.rotrSH(N,U,1)^Kt.rotrSH(N,U,8)^Kt.shrSH(N,U,7),K=Kt.rotrSL(N,U,1)^Kt.rotrSL(N,U,8)^Kt.shrSL(N,U,7),F=Ke[I-2]|0,V=ze[I-2]|0,et=Kt.rotrSH(F,V,19)^Kt.rotrBH(F,V,61)^Kt.shrSH(F,V,6),D=Kt.rotrSL(F,V,19)^Kt.rotrBL(F,V,61)^Kt.shrSL(F,V,6),Ft=Kt.add4L(K,D,ze[I-7],ze[I-16]),m=Kt.add4H(Ft,B,et,Ke[I-7],Ke[I-16]);Ke[I]=m|0,ze[I]=Ft|0}let{Ah:r,Al:c,Bh:i,Bl:h,Ch:w,Cl:y,Dh:b,Dl:x,Eh:_,El:L,Fh:k,Fl:E,Gh:S,Gl:M,Hh:T,Hl:q}=this;for(let I=0;I<80;I++){const N=Kt.rotrSH(_,L,14)^Kt.rotrSH(_,L,18)^Kt.rotrBH(_,L,41),U=Kt.rotrSL(_,L,14)^Kt.rotrSL(_,L,18)^Kt.rotrBL(_,L,41),B=_&k^~_&S,K=L&E^~L&M,F=Kt.add5L(q,U,K,Na[I],ze[I]),V=Kt.add5H(F,T,N,B,Oa[I],Ke[I]),et=F|0,D=Kt.rotrSH(r,c,28)^Kt.rotrBH(r,c,34)^Kt.rotrBH(r,c,39),Ft=Kt.rotrSL(r,c,28)^Kt.rotrBL(r,c,34)^Kt.rotrBL(r,c,39),m=r&i^r&w^i&w,n=c&h^c&y^h&y;T=S|0,q=M|0,S=k|0,M=E|0,k=_|0,E=L|0,{h:_,l:L}=Kt.add(b|0,x|0,V|0,et|0),b=w|0,x=y|0,w=i|0,y=h|0,i=r|0,h=c|0;const a=Kt.add3L(et,Ft,n);r=Kt.add3H(a,V,D,m),c=a|0}({h:r,l:c}=Kt.add(this.Ah|0,this.Al|0,r|0,c|0)),{h:i,l:h}=Kt.add(this.Bh|0,this.Bl|0,i|0,h|0),{h:w,l:y}=Kt.add(this.Ch|0,this.Cl|0,w|0,y|0),{h:b,l:x}=Kt.add(this.Dh|0,this.Dl|0,b|0,x|0),{h:_,l:L}=Kt.add(this.Eh|0,this.El|0,_|0,L|0),{h:k,l:E}=Kt.add(this.Fh|0,this.Fl|0,k|0,E|0),{h:S,l:M}=Kt.add(this.Gh|0,this.Gl|0,S|0,M|0),{h:T,l:q}=Kt.add(this.Hh|0,this.Hl|0,T|0,q|0),this.set(r,c,i,h,w,y,b,x,_,L,k,E,S,M,T,q)}roundClean(){Ke.fill(0),ze.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const qs=Cs(()=>new qa);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Us=BigInt(0),Cn=BigInt(1),Ua=BigInt(2),Pn=o=>o instanceof Uint8Array,Fa=Array.from({length:256},(o,t)=>t.toString(16).padStart(2,"0"));function _r(o){if(!Pn(o))throw new Error("Uint8Array expected");let t="";for(let e=0;e<o.length;e++)t+=Fa[o[e]];return t}function Fs(o){const t=o.toString(16);return t.length&1?`0${t}`:t}function wi(o){if(typeof o!="string")throw new Error("hex string expected, got "+typeof o);return BigInt(o===""?"0":`0x${o}`)}function Or(o){if(typeof o!="string")throw new Error("hex string expected, got "+typeof o);const t=o.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const e=new Uint8Array(t/2);for(let r=0;r<e.length;r++){const c=r*2,i=o.slice(c,c+2),h=Number.parseInt(i,16);if(Number.isNaN(h)||h<0)throw new Error("Invalid byte sequence");e[r]=h}return e}function xr(o){return wi(_r(o))}function Cr(o){if(!Pn(o))throw new Error("Uint8Array expected");return wi(_r(Uint8Array.from(o).reverse()))}function Nr(o,t){return Or(o.toString(16).padStart(t*2,"0"))}function an(o,t){return Nr(o,t).reverse()}function Ka(o){return Or(Fs(o))}function oe(o,t,e){let r;if(typeof t=="string")try{r=Or(t)}catch(i){throw new Error(`${o} must be valid hex string, got "${t}". Cause: ${i}`)}else if(Pn(t))r=Uint8Array.from(t);else throw new Error(`${o} must be hex string or Uint8Array`);const c=r.length;if(typeof e=="number"&&c!==e)throw new Error(`${o} expected ${e} bytes, got ${c}`);return r}function Sr(...o){const t=new Uint8Array(o.reduce((r,c)=>r+c.length,0));let e=0;return o.forEach(r=>{if(!Pn(r))throw new Error("Uint8Array expected");t.set(r,e),e+=r.length}),t}function za(o,t){if(o.length!==t.length)return!1;for(let e=0;e<o.length;e++)if(o[e]!==t[e])return!1;return!0}function Da(o){if(typeof o!="string")throw new Error(`utf8ToBytes expected string, got ${typeof o}`);return new Uint8Array(new TextEncoder().encode(o))}function Ha(o){let t;for(t=0;o>Us;o>>=Cn,t+=1);return t}function $a(o,t){return o>>BigInt(t)&Cn}const Wa=(o,t,e)=>o|(e?Cn:Us)<<BigInt(t),yi=o=>(Ua<<BigInt(o-1))-Cn,$n=o=>new Uint8Array(o),Yi=o=>Uint8Array.from(o);function Ks(o,t,e){if(typeof o!="number"||o<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let r=$n(o),c=$n(o),i=0;const h=()=>{r.fill(1),c.fill(0),i=0},w=(..._)=>e(c,r,..._),y=(_=$n())=>{c=w(Yi([0]),_),r=w(),_.length!==0&&(c=w(Yi([1]),_),r=w())},b=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let _=0;const L=[];for(;_<t;){r=w();const k=r.slice();L.push(k),_+=r.length}return Sr(...L)};return(_,L)=>{h(),y(_);let k;for(;!(k=L(b()));)y();return h(),k}}const ja={bigint:o=>typeof o=="bigint",function:o=>typeof o=="function",boolean:o=>typeof o=="boolean",string:o=>typeof o=="string",stringOrUint8Array:o=>typeof o=="string"||o instanceof Uint8Array,isSafeInteger:o=>Number.isSafeInteger(o),array:o=>Array.isArray(o),field:(o,t)=>t.Fp.isValid(o),hash:o=>typeof o=="function"&&Number.isSafeInteger(o.outputLen)};function zr(o,t,e={}){const r=(c,i,h)=>{const w=ja[i];if(typeof w!="function")throw new Error(`Invalid validator "${i}", expected function`);const y=o[c];if(!(h&&y===void 0)&&!w(y,o))throw new Error(`Invalid param ${String(c)}=${y} (${typeof y}), expected ${i}`)};for(const[c,i]of Object.entries(t))r(c,i,!1);for(const[c,i]of Object.entries(e))r(c,i,!0);return o}const Ga=Object.freeze(Object.defineProperty({__proto__:null,bitGet:$a,bitLen:Ha,bitMask:yi,bitSet:Wa,bytesToHex:_r,bytesToNumberBE:xr,bytesToNumberLE:Cr,concatBytes:Sr,createHmacDrbg:Ks,ensureBytes:oe,equalBytes:za,hexToBytes:Or,hexToNumber:wi,numberToBytesBE:Nr,numberToBytesLE:an,numberToHexUnpadded:Fs,numberToVarBytesBE:Ka,utf8ToBytes:Da,validateObject:zr},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ae=BigInt(0),te=BigInt(1),wr=BigInt(2),Za=BigInt(3),Qn=BigInt(4),Ji=BigInt(5),Xi=BigInt(8);BigInt(9);BigInt(16);function Jt(o,t){const e=o%t;return e>=ae?e:t+e}function Va(o,t,e){if(e<=ae||t<ae)throw new Error("Expected power/modulo > 0");if(e===te)return ae;let r=te;for(;t>ae;)t&te&&(r=r*o%e),o=o*o%e,t>>=te;return r}function ee(o,t,e){let r=o;for(;t-- >ae;)r*=r,r%=e;return r}function ti(o,t){if(o===ae||t<=ae)throw new Error(`invert: expected positive integers, got n=${o} mod=${t}`);let e=Jt(o,t),r=t,c=ae,i=te;for(;e!==ae;){const w=r/e,y=r%e,b=c-i*w;r=e,e=y,c=i,i=b}if(r!==te)throw new Error("invert: does not exist");return Jt(c,t)}function Ya(o){const t=(o-te)/wr;let e,r,c;for(e=o-te,r=0;e%wr===ae;e/=wr,r++);for(c=wr;c<o&&Va(c,t,o)!==o-te;c++);if(r===1){const h=(o+te)/Qn;return function(y,b){const x=y.pow(b,h);if(!y.eql(y.sqr(x),b))throw new Error("Cannot find square root");return x}}const i=(e+te)/wr;return function(w,y){if(w.pow(y,t)===w.neg(w.ONE))throw new Error("Cannot find square root");let b=r,x=w.pow(w.mul(w.ONE,c),e),_=w.pow(y,i),L=w.pow(y,e);for(;!w.eql(L,w.ONE);){if(w.eql(L,w.ZERO))return w.ZERO;let k=1;for(let S=w.sqr(L);k<b&&!w.eql(S,w.ONE);k++)S=w.sqr(S);const E=w.pow(x,te<<BigInt(b-k-1));x=w.sqr(E),_=w.mul(_,E),L=w.mul(L,x),b=k}return _}}function Ja(o){if(o%Qn===Za){const t=(o+te)/Qn;return function(r,c){const i=r.pow(c,t);if(!r.eql(r.sqr(i),c))throw new Error("Cannot find square root");return i}}if(o%Xi===Ji){const t=(o-Ji)/Xi;return function(r,c){const i=r.mul(c,wr),h=r.pow(i,t),w=r.mul(c,h),y=r.mul(r.mul(w,wr),h),b=r.mul(w,r.sub(y,r.ONE));if(!r.eql(r.sqr(b),c))throw new Error("Cannot find square root");return b}}return Ya(o)}const Xa=(o,t)=>(Jt(o,t)&te)===te,Qa=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function tc(o){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=Qa.reduce((r,c)=>(r[c]="function",r),t);return zr(o,e)}function ec(o,t,e){if(e<ae)throw new Error("Expected power > 0");if(e===ae)return o.ONE;if(e===te)return t;let r=o.ONE,c=t;for(;e>ae;)e&te&&(r=o.mul(r,c)),c=o.sqr(c),e>>=te;return r}function rc(o,t){const e=new Array(t.length),r=t.reduce((i,h,w)=>o.is0(h)?i:(e[w]=i,o.mul(i,h)),o.ONE),c=o.inv(r);return t.reduceRight((i,h,w)=>o.is0(h)?i:(e[w]=o.mul(i,e[w]),o.mul(i,h)),c),e}function zs(o,t){const e=t!==void 0?t:o.toString(2).length,r=Math.ceil(e/8);return{nBitLength:e,nByteLength:r}}function Ds(o,t,e=!1,r={}){if(o<=ae)throw new Error(`Expected Field ORDER > 0, got ${o}`);const{nBitLength:c,nByteLength:i}=zs(o,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const h=Ja(o),w=Object.freeze({ORDER:o,BITS:c,BYTES:i,MASK:yi(c),ZERO:ae,ONE:te,create:y=>Jt(y,o),isValid:y=>{if(typeof y!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof y}`);return ae<=y&&y<o},is0:y=>y===ae,isOdd:y=>(y&te)===te,neg:y=>Jt(-y,o),eql:(y,b)=>y===b,sqr:y=>Jt(y*y,o),add:(y,b)=>Jt(y+b,o),sub:(y,b)=>Jt(y-b,o),mul:(y,b)=>Jt(y*b,o),pow:(y,b)=>ec(w,y,b),div:(y,b)=>Jt(y*ti(b,o),o),sqrN:y=>y*y,addN:(y,b)=>y+b,subN:(y,b)=>y-b,mulN:(y,b)=>y*b,inv:y=>ti(y,o),sqrt:r.sqrt||(y=>h(w,y)),invertBatch:y=>rc(w,y),cmov:(y,b,x)=>x?b:y,toBytes:y=>e?an(y,i):Nr(y,i),fromBytes:y=>{if(y.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${y.length}`);return e?Cr(y):xr(y)}});return Object.freeze(w)}function nc(o,t){if(!o.isOdd)throw new Error("Field doesn't have isOdd");const e=o.sqrt(t);return o.isOdd(e)?o.neg(e):e}function Hs(o){if(typeof o!="bigint")throw new Error("field order must be bigint");const t=o.toString(2).length;return Math.ceil(t/8)}function $s(o){const t=Hs(o);return t+Math.ceil(t/2)}function ic(o,t,e=!1){const r=o.length,c=Hs(t),i=$s(t);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const h=e?xr(o):Cr(o),w=Jt(h,t-te)+te;return e?an(w,c):Nr(w,c)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const sc=BigInt(0),Wn=BigInt(1);function Ws(o,t){const e=(c,i)=>{const h=i.negate();return c?h:i},r=c=>{const i=Math.ceil(t/c)+1,h=2**(c-1);return{windows:i,windowSize:h}};return{constTimeNegate:e,unsafeLadder(c,i){let h=o.ZERO,w=c;for(;i>sc;)i&Wn&&(h=h.add(w)),w=w.double(),i>>=Wn;return h},precomputeWindow(c,i){const{windows:h,windowSize:w}=r(i),y=[];let b=c,x=b;for(let _=0;_<h;_++){x=b,y.push(x);for(let L=1;L<w;L++)x=x.add(b),y.push(x);b=x.double()}return y},wNAF(c,i,h){const{windows:w,windowSize:y}=r(c);let b=o.ZERO,x=o.BASE;const _=BigInt(2**c-1),L=2**c,k=BigInt(c);for(let E=0;E<w;E++){const S=E*y;let M=Number(h&_);h>>=k,M>y&&(M-=L,h+=Wn);const T=S,q=S+Math.abs(M)-1,I=E%2!==0,N=M<0;M===0?x=x.add(e(I,i[T])):b=b.add(e(N,i[q]))}return{p:b,f:x}},wNAFCached(c,i,h,w){const y=c._WINDOW_SIZE||1;let b=i.get(c);return b||(b=this.precomputeWindow(c,y),y!==1&&i.set(c,w(b))),this.wNAF(y,b,h)}}}function vi(o){return tc(o.Fp),zr(o,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...zs(o.n,o.nBitLength),...o,p:o.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Se=BigInt(0),pe=BigInt(1),wn=BigInt(2),oc=BigInt(8),ac={zip215:!0};function cc(o){const t=vi(o);return zr(o,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function bi(o){const t=cc(o),{Fp:e,n:r,prehash:c,hash:i,randomBytes:h,nByteLength:w,h:y}=t,b=wn<<BigInt(w*8)-pe,x=e.create,_=t.uvRatio||((d,g)=>{try{return{isValid:!0,value:e.sqrt(d*e.inv(g))}}catch{return{isValid:!1,value:Se}}}),L=t.adjustScalarBytes||(d=>d),k=t.domain||((d,g,v)=>{if(g.length||v)throw new Error("Contexts/pre-hash are not supported");return d}),E=d=>typeof d=="bigint"&&Se<d,S=(d,g)=>E(d)&&E(g)&&d<g,M=d=>d===Se||S(d,b);function T(d,g){if(S(d,g))return d;throw new Error(`Expected valid scalar < ${g}, got ${typeof d} ${d}`)}function q(d){return d===Se?d:T(d,r)}const I=new Map;function N(d){if(!(d instanceof U))throw new Error("ExtendedPoint expected")}class U{constructor(g,v,f,s){if(this.ex=g,this.ey=v,this.ez=f,this.et=s,!M(g))throw new Error("x required");if(!M(v))throw new Error("y required");if(!M(f))throw new Error("z required");if(!M(s))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(g){if(g instanceof U)throw new Error("extended point not allowed");const{x:v,y:f}=g||{};if(!M(v)||!M(f))throw new Error("invalid affine point");return new U(v,f,pe,x(v*f))}static normalizeZ(g){const v=e.invertBatch(g.map(f=>f.ez));return g.map((f,s)=>f.toAffine(v[s])).map(U.fromAffine)}_setWindowSize(g){this._WINDOW_SIZE=g,I.delete(this)}assertValidity(){const{a:g,d:v}=t;if(this.is0())throw new Error("bad point: ZERO");const{ex:f,ey:s,ez:p,et:C}=this,P=x(f*f),O=x(s*s),Y=x(p*p),j=x(Y*Y),Z=x(P*g),Xt=x(Y*x(Z+O)),J=x(j+x(v*x(P*O)));if(Xt!==J)throw new Error("bad point: equation left != right (1)");const tt=x(f*s),Vt=x(p*C);if(tt!==Vt)throw new Error("bad point: equation left != right (2)")}equals(g){N(g);const{ex:v,ey:f,ez:s}=this,{ex:p,ey:C,ez:P}=g,O=x(v*P),Y=x(p*s),j=x(f*P),Z=x(C*s);return O===Y&&j===Z}is0(){return this.equals(U.ZERO)}negate(){return new U(x(-this.ex),this.ey,this.ez,x(-this.et))}double(){const{a:g}=t,{ex:v,ey:f,ez:s}=this,p=x(v*v),C=x(f*f),P=x(wn*x(s*s)),O=x(g*p),Y=v+f,j=x(x(Y*Y)-p-C),Z=O+C,Xt=Z-P,J=O-C,tt=x(j*Xt),Vt=x(Z*J),rt=x(j*J),st=x(Xt*Z);return new U(tt,Vt,st,rt)}add(g){N(g);const{a:v,d:f}=t,{ex:s,ey:p,ez:C,et:P}=this,{ex:O,ey:Y,ez:j,et:Z}=g;if(v===BigInt(-1)){const qe=x((p-s)*(Y+O)),ut=x((p+s)*(Y-O)),at=x(ut-qe);if(at===Se)return this.double();const Ue=x(C*wn*Z),ht=x(P*wn*j),ft=ht+Ue,Fe=ut+qe,lt=ht-Ue,mt=x(ft*at),Je=x(Fe*lt),wt=x(ft*lt),yt=x(at*Fe);return new U(mt,Je,yt,wt)}const Xt=x(s*O),J=x(p*Y),tt=x(P*f*Z),Vt=x(C*j),rt=x((s+p)*(O+Y)-Xt-J),st=Vt-tt,_e=Vt+tt,ct=x(J-v*Xt),dt=x(rt*st),Ye=x(_e*ct),pt=x(rt*ct),gt=x(st*_e);return new U(dt,Ye,gt,pt)}subtract(g){return this.add(g.negate())}wNAF(g){return F.wNAFCached(this,I,g,U.normalizeZ)}multiply(g){const{p:v,f}=this.wNAF(T(g,r));return U.normalizeZ([v,f])[0]}multiplyUnsafe(g){let v=q(g);return v===Se?K:this.equals(K)||v===pe?this:this.equals(B)?this.wNAF(v).p:F.unsafeLadder(this,v)}isSmallOrder(){return this.multiplyUnsafe(y).is0()}isTorsionFree(){return F.unsafeLadder(this,r).is0()}toAffine(g){const{ex:v,ey:f,ez:s}=this,p=this.is0();g==null&&(g=p?oc:e.inv(s));const C=x(v*g),P=x(f*g),O=x(s*g);if(p)return{x:Se,y:pe};if(O!==pe)throw new Error("invZ was invalid");return{x:C,y:P}}clearCofactor(){const{h:g}=t;return g===pe?this:this.multiplyUnsafe(g)}static fromHex(g,v=!1){const{d:f,a:s}=t,p=e.BYTES;g=oe("pointHex",g,p);const C=g.slice(),P=g[p-1];C[p-1]=P&-129;const O=Cr(C);O===Se||(v?T(O,b):T(O,e.ORDER));const Y=x(O*O),j=x(Y-pe),Z=x(f*Y-s);let{isValid:Xt,value:J}=_(j,Z);if(!Xt)throw new Error("Point.fromHex: invalid y coordinate");const tt=(J&pe)===pe,Vt=(P&128)!==0;if(!v&&J===Se&&Vt)throw new Error("Point.fromHex: x=0 and x_0=1");return Vt!==tt&&(J=x(-J)),U.fromAffine({x:J,y:O})}static fromPrivateKey(g){return D(g).point}toRawBytes(){const{x:g,y:v}=this.toAffine(),f=an(v,e.BYTES);return f[f.length-1]|=g&pe?128:0,f}toHex(){return _r(this.toRawBytes())}}U.BASE=new U(t.Gx,t.Gy,pe,x(t.Gx*t.Gy)),U.ZERO=new U(Se,pe,pe,Se);const{BASE:B,ZERO:K}=U,F=Ws(U,w*8);function V(d){return Jt(d,r)}function et(d){return V(Cr(d))}function D(d){const g=w;d=oe("private key",d,g);const v=oe("hashed private key",i(d),2*g),f=L(v.slice(0,g)),s=v.slice(g,2*g),p=et(f),C=B.multiply(p),P=C.toRawBytes();return{head:f,prefix:s,scalar:p,point:C,pointBytes:P}}function Ft(d){return D(d).pointBytes}function m(d=new Uint8Array,...g){const v=Sr(...g);return et(i(k(v,oe("context",d),!!c)))}function n(d,g,v={}){d=oe("message",d),c&&(d=c(d));const{prefix:f,scalar:s,pointBytes:p}=D(g),C=m(v.context,f,d),P=B.multiply(C).toRawBytes(),O=m(v.context,P,p,d),Y=V(C+O*s);q(Y);const j=Sr(P,an(Y,e.BYTES));return oe("result",j,w*2)}const a=ac;function u(d,g,v,f=a){const{context:s,zip215:p}=f,C=e.BYTES;d=oe("signature",d,2*C),g=oe("message",g),c&&(g=c(g));const P=Cr(d.slice(C,2*C));let O,Y,j;try{O=U.fromHex(v,p),Y=U.fromHex(d.slice(0,C),p),j=B.multiplyUnsafe(P)}catch{return!1}if(!p&&O.isSmallOrder())return!1;const Z=m(s,Y.toRawBytes(),O.toRawBytes(),g);return Y.add(O.multiplyUnsafe(Z)).subtract(j).clearCofactor().equals(U.ZERO)}return B._setWindowSize(8),{CURVE:t,getPublicKey:Ft,sign:n,verify:u,ExtendedPoint:U,utils:{getExtendedPublicKey:D,randomPrivateKey:()=>h(e.BYTES),precompute(d=8,g=U.BASE){return g._setWindowSize(d),g.multiply(BigInt(3)),g}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const xi=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Qi=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const uc=BigInt(1),ei=BigInt(2),hc=BigInt(5),ts=BigInt(10),fc=BigInt(20),lc=BigInt(40),es=BigInt(80);function dc(o){const t=xi,r=o*o%t*o%t,c=ee(r,ei,t)*r%t,i=ee(c,uc,t)*o%t,h=ee(i,hc,t)*i%t,w=ee(h,ts,t)*h%t,y=ee(w,fc,t)*w%t,b=ee(y,lc,t)*y%t,x=ee(b,es,t)*b%t,_=ee(x,es,t)*b%t,L=ee(_,ts,t)*h%t;return{pow_p_5_8:ee(L,ei,t)*o%t,b2:r}}function pc(o){return o[0]&=248,o[31]&=127,o[31]|=64,o}function gc(o,t){const e=xi,r=Jt(t*t*t,e),c=Jt(r*r*t,e),i=dc(o*c).pow_p_5_8;let h=Jt(o*r*i,e);const w=Jt(t*h*h,e),y=h,b=Jt(h*Qi,e),x=w===o,_=w===Jt(-o,e),L=w===Jt(-o*Qi,e);return x&&(h=y),(_||L)&&(h=b),Xa(h,e)&&(h=Jt(-h,e)),{isValid:x||_,value:h}}const Ne=Ds(xi,void 0,!0),Mi={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ne,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:qs,randomBytes:Ps,adjustScalarBytes:pc,uvRatio:gc},Dr=bi(Mi);function js(o,t,e){if(t.length>255)throw new Error("Context is too big");return Ts(Rs("SigEd25519 no Ed25519 collisions"),new Uint8Array([e?1:0,t.length]),t,o)}({...Mi});({...Mi});const mc=(Ne.ORDER+BigInt(3))/BigInt(8);Ne.pow(ei,mc);Ne.sqrt(Ne.neg(Ne.ONE));(Ne.ORDER-BigInt(5))/BigInt(8);BigInt(486662);nc(Ne,Ne.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235");BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838");BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var _i={exports:{}};_i.exports;(function(o){(function(t,e){function r(m,n){if(!m)throw new Error(n||"Assertion failed")}function c(m,n){m.super_=n;var a=function(){};a.prototype=n.prototype,m.prototype=new a,m.prototype.constructor=m}function i(m,n,a){if(i.isBN(m))return m;this.negative=0,this.words=null,this.length=0,this.red=null,m!==null&&((n==="le"||n==="be")&&(a=n,n=10),this._init(m||0,n||10,a||"be"))}typeof t=="object"?t.exports=i:e.BN=i,i.BN=i,i.wordSize=26;var h;try{typeof window<"u"&&typeof window.Buffer<"u"?h=window.Buffer:h=ks.Buffer}catch{}i.isBN=function(n){return n instanceof i?!0:n!==null&&typeof n=="object"&&n.constructor.wordSize===i.wordSize&&Array.isArray(n.words)},i.max=function(n,a){return n.cmp(a)>0?n:a},i.min=function(n,a){return n.cmp(a)<0?n:a},i.prototype._init=function(n,a,u){if(typeof n=="number")return this._initNumber(n,a,u);if(typeof n=="object")return this._initArray(n,a,u);a==="hex"&&(a=16),r(a===(a|0)&&a>=2&&a<=36),n=n.toString().replace(/\s+/g,"");var l=0;n[0]==="-"&&(l++,this.negative=1),l<n.length&&(a===16?this._parseHex(n,l,u):(this._parseBase(n,a,l),u==="le"&&this._initArray(this.toArray(),a,u)))},i.prototype._initNumber=function(n,a,u){n<0&&(this.negative=1,n=-n),n<67108864?(this.words=[n&67108863],this.length=1):n<4503599627370496?(this.words=[n&67108863,n/67108864&67108863],this.length=2):(r(n<9007199254740992),this.words=[n&67108863,n/67108864&67108863,1],this.length=3),u==="le"&&this._initArray(this.toArray(),a,u)},i.prototype._initArray=function(n,a,u){if(r(typeof n.length=="number"),n.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(n.length/3),this.words=new Array(this.length);for(var l=0;l<this.length;l++)this.words[l]=0;var d,g,v=0;if(u==="be")for(l=n.length-1,d=0;l>=0;l-=3)g=n[l]|n[l-1]<<8|n[l-2]<<16,this.words[d]|=g<<v&67108863,this.words[d+1]=g>>>26-v&67108863,v+=24,v>=26&&(v-=26,d++);else if(u==="le")for(l=0,d=0;l<n.length;l+=3)g=n[l]|n[l+1]<<8|n[l+2]<<16,this.words[d]|=g<<v&67108863,this.words[d+1]=g>>>26-v&67108863,v+=24,v>=26&&(v-=26,d++);return this._strip()};function w(m,n){var a=m.charCodeAt(n);if(a>=48&&a<=57)return a-48;if(a>=65&&a<=70)return a-55;if(a>=97&&a<=102)return a-87;r(!1,"Invalid character in "+m)}function y(m,n,a){var u=w(m,a);return a-1>=n&&(u|=w(m,a-1)<<4),u}i.prototype._parseHex=function(n,a,u){this.length=Math.ceil((n.length-a)/6),this.words=new Array(this.length);for(var l=0;l<this.length;l++)this.words[l]=0;var d=0,g=0,v;if(u==="be")for(l=n.length-1;l>=a;l-=2)v=y(n,a,l)<<d,this.words[g]|=v&67108863,d>=18?(d-=18,g+=1,this.words[g]|=v>>>26):d+=8;else{var f=n.length-a;for(l=f%2===0?a+1:a;l<n.length;l+=2)v=y(n,a,l)<<d,this.words[g]|=v&67108863,d>=18?(d-=18,g+=1,this.words[g]|=v>>>26):d+=8}this._strip()};function b(m,n,a,u){for(var l=0,d=0,g=Math.min(m.length,a),v=n;v<g;v++){var f=m.charCodeAt(v)-48;l*=u,f>=49?d=f-49+10:f>=17?d=f-17+10:d=f,r(f>=0&&d<u,"Invalid character"),l+=d}return l}i.prototype._parseBase=function(n,a,u){this.words=[0],this.length=1;for(var l=0,d=1;d<=67108863;d*=a)l++;l--,d=d/a|0;for(var g=n.length-u,v=g%l,f=Math.min(g,g-v)+u,s=0,p=u;p<f;p+=l)s=b(n,p,p+l,a),this.imuln(d),this.words[0]+s<67108864?this.words[0]+=s:this._iaddn(s);if(v!==0){var C=1;for(s=b(n,p,n.length,a),p=0;p<v;p++)C*=a;this.imuln(C),this.words[0]+s<67108864?this.words[0]+=s:this._iaddn(s)}this._strip()},i.prototype.copy=function(n){n.words=new Array(this.length);for(var a=0;a<this.length;a++)n.words[a]=this.words[a];n.length=this.length,n.negative=this.negative,n.red=this.red};function x(m,n){m.words=n.words,m.length=n.length,m.negative=n.negative,m.red=n.red}if(i.prototype._move=function(n){x(n,this)},i.prototype.clone=function(){var n=new i(null);return this.copy(n),n},i.prototype._expand=function(n){for(;this.length<n;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=_}catch{i.prototype.inspect=_}else i.prototype.inspect=_;function _(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var L=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],k=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],E=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(n,a){n=n||10,a=a|0||1;var u;if(n===16||n==="hex"){u="";for(var l=0,d=0,g=0;g<this.length;g++){var v=this.words[g],f=((v<<l|d)&16777215).toString(16);d=v>>>24-l&16777215,l+=2,l>=26&&(l-=26,g--),d!==0||g!==this.length-1?u=L[6-f.length]+f+u:u=f+u}for(d!==0&&(u=d.toString(16)+u);u.length%a!==0;)u="0"+u;return this.negative!==0&&(u="-"+u),u}if(n===(n|0)&&n>=2&&n<=36){var s=k[n],p=E[n];u="";var C=this.clone();for(C.negative=0;!C.isZero();){var P=C.modrn(p).toString(n);C=C.idivn(p),C.isZero()?u=P+u:u=L[s-P.length]+P+u}for(this.isZero()&&(u="0"+u);u.length%a!==0;)u="0"+u;return this.negative!==0&&(u="-"+u),u}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var n=this.words[0];return this.length===2?n+=this.words[1]*67108864:this.length===3&&this.words[2]===1?n+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-n:n},i.prototype.toJSON=function(){return this.toString(16,2)},h&&(i.prototype.toBuffer=function(n,a){return this.toArrayLike(h,n,a)}),i.prototype.toArray=function(n,a){return this.toArrayLike(Array,n,a)};var S=function(n,a){return n.allocUnsafe?n.allocUnsafe(a):new n(a)};i.prototype.toArrayLike=function(n,a,u){this._strip();var l=this.byteLength(),d=u||Math.max(1,l);r(l<=d,"byte array longer than desired length"),r(d>0,"Requested array length <= 0");var g=S(n,d),v=a==="le"?"LE":"BE";return this["_toArrayLike"+v](g,l),g},i.prototype._toArrayLikeLE=function(n,a){for(var u=0,l=0,d=0,g=0;d<this.length;d++){var v=this.words[d]<<g|l;n[u++]=v&255,u<n.length&&(n[u++]=v>>8&255),u<n.length&&(n[u++]=v>>16&255),g===6?(u<n.length&&(n[u++]=v>>24&255),l=0,g=0):(l=v>>>24,g+=2)}if(u<n.length)for(n[u++]=l;u<n.length;)n[u++]=0},i.prototype._toArrayLikeBE=function(n,a){for(var u=n.length-1,l=0,d=0,g=0;d<this.length;d++){var v=this.words[d]<<g|l;n[u--]=v&255,u>=0&&(n[u--]=v>>8&255),u>=0&&(n[u--]=v>>16&255),g===6?(u>=0&&(n[u--]=v>>24&255),l=0,g=0):(l=v>>>24,g+=2)}if(u>=0)for(n[u--]=l;u>=0;)n[u--]=0},Math.clz32?i.prototype._countBits=function(n){return 32-Math.clz32(n)}:i.prototype._countBits=function(n){var a=n,u=0;return a>=4096&&(u+=13,a>>>=13),a>=64&&(u+=7,a>>>=7),a>=8&&(u+=4,a>>>=4),a>=2&&(u+=2,a>>>=2),u+a},i.prototype._zeroBits=function(n){if(n===0)return 26;var a=n,u=0;return a&8191||(u+=13,a>>>=13),a&127||(u+=7,a>>>=7),a&15||(u+=4,a>>>=4),a&3||(u+=2,a>>>=2),a&1||u++,u},i.prototype.bitLength=function(){var n=this.words[this.length-1],a=this._countBits(n);return(this.length-1)*26+a};function M(m){for(var n=new Array(m.bitLength()),a=0;a<n.length;a++){var u=a/26|0,l=a%26;n[a]=m.words[u]>>>l&1}return n}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var n=0,a=0;a<this.length;a++){var u=this._zeroBits(this.words[a]);if(n+=u,u!==26)break}return n},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(n){return this.negative!==0?this.abs().inotn(n).iaddn(1):this.clone()},i.prototype.fromTwos=function(n){return this.testn(n-1)?this.notn(n).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(n){for(;this.length<n.length;)this.words[this.length++]=0;for(var a=0;a<n.length;a++)this.words[a]=this.words[a]|n.words[a];return this._strip()},i.prototype.ior=function(n){return r((this.negative|n.negative)===0),this.iuor(n)},i.prototype.or=function(n){return this.length>n.length?this.clone().ior(n):n.clone().ior(this)},i.prototype.uor=function(n){return this.length>n.length?this.clone().iuor(n):n.clone().iuor(this)},i.prototype.iuand=function(n){var a;this.length>n.length?a=n:a=this;for(var u=0;u<a.length;u++)this.words[u]=this.words[u]&n.words[u];return this.length=a.length,this._strip()},i.prototype.iand=function(n){return r((this.negative|n.negative)===0),this.iuand(n)},i.prototype.and=function(n){return this.length>n.length?this.clone().iand(n):n.clone().iand(this)},i.prototype.uand=function(n){return this.length>n.length?this.clone().iuand(n):n.clone().iuand(this)},i.prototype.iuxor=function(n){var a,u;this.length>n.length?(a=this,u=n):(a=n,u=this);for(var l=0;l<u.length;l++)this.words[l]=a.words[l]^u.words[l];if(this!==a)for(;l<a.length;l++)this.words[l]=a.words[l];return this.length=a.length,this._strip()},i.prototype.ixor=function(n){return r((this.negative|n.negative)===0),this.iuxor(n)},i.prototype.xor=function(n){return this.length>n.length?this.clone().ixor(n):n.clone().ixor(this)},i.prototype.uxor=function(n){return this.length>n.length?this.clone().iuxor(n):n.clone().iuxor(this)},i.prototype.inotn=function(n){r(typeof n=="number"&&n>=0);var a=Math.ceil(n/26)|0,u=n%26;this._expand(a),u>0&&a--;for(var l=0;l<a;l++)this.words[l]=~this.words[l]&67108863;return u>0&&(this.words[l]=~this.words[l]&67108863>>26-u),this._strip()},i.prototype.notn=function(n){return this.clone().inotn(n)},i.prototype.setn=function(n,a){r(typeof n=="number"&&n>=0);var u=n/26|0,l=n%26;return this._expand(u+1),a?this.words[u]=this.words[u]|1<<l:this.words[u]=this.words[u]&~(1<<l),this._strip()},i.prototype.iadd=function(n){var a;if(this.negative!==0&&n.negative===0)return this.negative=0,a=this.isub(n),this.negative^=1,this._normSign();if(this.negative===0&&n.negative!==0)return n.negative=0,a=this.isub(n),n.negative=1,a._normSign();var u,l;this.length>n.length?(u=this,l=n):(u=n,l=this);for(var d=0,g=0;g<l.length;g++)a=(u.words[g]|0)+(l.words[g]|0)+d,this.words[g]=a&67108863,d=a>>>26;for(;d!==0&&g<u.length;g++)a=(u.words[g]|0)+d,this.words[g]=a&67108863,d=a>>>26;if(this.length=u.length,d!==0)this.words[this.length]=d,this.length++;else if(u!==this)for(;g<u.length;g++)this.words[g]=u.words[g];return this},i.prototype.add=function(n){var a;return n.negative!==0&&this.negative===0?(n.negative=0,a=this.sub(n),n.negative^=1,a):n.negative===0&&this.negative!==0?(this.negative=0,a=n.sub(this),this.negative=1,a):this.length>n.length?this.clone().iadd(n):n.clone().iadd(this)},i.prototype.isub=function(n){if(n.negative!==0){n.negative=0;var a=this.iadd(n);return n.negative=1,a._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(n),this.negative=1,this._normSign();var u=this.cmp(n);if(u===0)return this.negative=0,this.length=1,this.words[0]=0,this;var l,d;u>0?(l=this,d=n):(l=n,d=this);for(var g=0,v=0;v<d.length;v++)a=(l.words[v]|0)-(d.words[v]|0)+g,g=a>>26,this.words[v]=a&67108863;for(;g!==0&&v<l.length;v++)a=(l.words[v]|0)+g,g=a>>26,this.words[v]=a&67108863;if(g===0&&v<l.length&&l!==this)for(;v<l.length;v++)this.words[v]=l.words[v];return this.length=Math.max(this.length,v),l!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(n){return this.clone().isub(n)};function T(m,n,a){a.negative=n.negative^m.negative;var u=m.length+n.length|0;a.length=u,u=u-1|0;var l=m.words[0]|0,d=n.words[0]|0,g=l*d,v=g&67108863,f=g/67108864|0;a.words[0]=v;for(var s=1;s<u;s++){for(var p=f>>>26,C=f&67108863,P=Math.min(s,n.length-1),O=Math.max(0,s-m.length+1);O<=P;O++){var Y=s-O|0;l=m.words[Y]|0,d=n.words[O]|0,g=l*d+C,p+=g/67108864|0,C=g&67108863}a.words[s]=C|0,f=p|0}return f!==0?a.words[s]=f|0:a.length--,a._strip()}var q=function(n,a,u){var l=n.words,d=a.words,g=u.words,v=0,f,s,p,C=l[0]|0,P=C&8191,O=C>>>13,Y=l[1]|0,j=Y&8191,Z=Y>>>13,Xt=l[2]|0,J=Xt&8191,tt=Xt>>>13,Vt=l[3]|0,rt=Vt&8191,st=Vt>>>13,_e=l[4]|0,ct=_e&8191,dt=_e>>>13,Ye=l[5]|0,pt=Ye&8191,gt=Ye>>>13,qe=l[6]|0,ut=qe&8191,at=qe>>>13,Ue=l[7]|0,ht=Ue&8191,ft=Ue>>>13,Fe=l[8]|0,lt=Fe&8191,mt=Fe>>>13,Je=l[9]|0,wt=Je&8191,yt=Je>>>13,jr=d[0]|0,vt=jr&8191,bt=jr>>>13,Gr=d[1]|0,xt=Gr&8191,Mt=Gr>>>13,Zr=d[2]|0,_t=Zr&8191,St=Zr>>>13,Vr=d[3]|0,Et=Vr&8191,kt=Vr>>>13,Yr=d[4]|0,Bt=Yr&8191,At=Yr>>>13,Jr=d[5]|0,It=Jr&8191,Rt=Jr>>>13,Xr=d[6]|0,Tt=Xr&8191,Lt=Xr>>>13,Qr=d[7]|0,Ct=Qr&8191,Pt=Qr>>>13,tn=d[8]|0,Ot=tn&8191,Nt=tn>>>13,en=d[9]|0,qt=en&8191,Ut=en>>>13;u.negative=n.negative^a.negative,u.length=19,f=Math.imul(P,vt),s=Math.imul(P,bt),s=s+Math.imul(O,vt)|0,p=Math.imul(O,bt);var Xe=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,f=Math.imul(j,vt),s=Math.imul(j,bt),s=s+Math.imul(Z,vt)|0,p=Math.imul(Z,bt),f=f+Math.imul(P,xt)|0,s=s+Math.imul(P,Mt)|0,s=s+Math.imul(O,xt)|0,p=p+Math.imul(O,Mt)|0;var Qe=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,f=Math.imul(J,vt),s=Math.imul(J,bt),s=s+Math.imul(tt,vt)|0,p=Math.imul(tt,bt),f=f+Math.imul(j,xt)|0,s=s+Math.imul(j,Mt)|0,s=s+Math.imul(Z,xt)|0,p=p+Math.imul(Z,Mt)|0,f=f+Math.imul(P,_t)|0,s=s+Math.imul(P,St)|0,s=s+Math.imul(O,_t)|0,p=p+Math.imul(O,St)|0;var tr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(tr>>>26)|0,tr&=67108863,f=Math.imul(rt,vt),s=Math.imul(rt,bt),s=s+Math.imul(st,vt)|0,p=Math.imul(st,bt),f=f+Math.imul(J,xt)|0,s=s+Math.imul(J,Mt)|0,s=s+Math.imul(tt,xt)|0,p=p+Math.imul(tt,Mt)|0,f=f+Math.imul(j,_t)|0,s=s+Math.imul(j,St)|0,s=s+Math.imul(Z,_t)|0,p=p+Math.imul(Z,St)|0,f=f+Math.imul(P,Et)|0,s=s+Math.imul(P,kt)|0,s=s+Math.imul(O,Et)|0,p=p+Math.imul(O,kt)|0;var er=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(er>>>26)|0,er&=67108863,f=Math.imul(ct,vt),s=Math.imul(ct,bt),s=s+Math.imul(dt,vt)|0,p=Math.imul(dt,bt),f=f+Math.imul(rt,xt)|0,s=s+Math.imul(rt,Mt)|0,s=s+Math.imul(st,xt)|0,p=p+Math.imul(st,Mt)|0,f=f+Math.imul(J,_t)|0,s=s+Math.imul(J,St)|0,s=s+Math.imul(tt,_t)|0,p=p+Math.imul(tt,St)|0,f=f+Math.imul(j,Et)|0,s=s+Math.imul(j,kt)|0,s=s+Math.imul(Z,Et)|0,p=p+Math.imul(Z,kt)|0,f=f+Math.imul(P,Bt)|0,s=s+Math.imul(P,At)|0,s=s+Math.imul(O,Bt)|0,p=p+Math.imul(O,At)|0;var rr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(rr>>>26)|0,rr&=67108863,f=Math.imul(pt,vt),s=Math.imul(pt,bt),s=s+Math.imul(gt,vt)|0,p=Math.imul(gt,bt),f=f+Math.imul(ct,xt)|0,s=s+Math.imul(ct,Mt)|0,s=s+Math.imul(dt,xt)|0,p=p+Math.imul(dt,Mt)|0,f=f+Math.imul(rt,_t)|0,s=s+Math.imul(rt,St)|0,s=s+Math.imul(st,_t)|0,p=p+Math.imul(st,St)|0,f=f+Math.imul(J,Et)|0,s=s+Math.imul(J,kt)|0,s=s+Math.imul(tt,Et)|0,p=p+Math.imul(tt,kt)|0,f=f+Math.imul(j,Bt)|0,s=s+Math.imul(j,At)|0,s=s+Math.imul(Z,Bt)|0,p=p+Math.imul(Z,At)|0,f=f+Math.imul(P,It)|0,s=s+Math.imul(P,Rt)|0,s=s+Math.imul(O,It)|0,p=p+Math.imul(O,Rt)|0;var nr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(nr>>>26)|0,nr&=67108863,f=Math.imul(ut,vt),s=Math.imul(ut,bt),s=s+Math.imul(at,vt)|0,p=Math.imul(at,bt),f=f+Math.imul(pt,xt)|0,s=s+Math.imul(pt,Mt)|0,s=s+Math.imul(gt,xt)|0,p=p+Math.imul(gt,Mt)|0,f=f+Math.imul(ct,_t)|0,s=s+Math.imul(ct,St)|0,s=s+Math.imul(dt,_t)|0,p=p+Math.imul(dt,St)|0,f=f+Math.imul(rt,Et)|0,s=s+Math.imul(rt,kt)|0,s=s+Math.imul(st,Et)|0,p=p+Math.imul(st,kt)|0,f=f+Math.imul(J,Bt)|0,s=s+Math.imul(J,At)|0,s=s+Math.imul(tt,Bt)|0,p=p+Math.imul(tt,At)|0,f=f+Math.imul(j,It)|0,s=s+Math.imul(j,Rt)|0,s=s+Math.imul(Z,It)|0,p=p+Math.imul(Z,Rt)|0,f=f+Math.imul(P,Tt)|0,s=s+Math.imul(P,Lt)|0,s=s+Math.imul(O,Tt)|0,p=p+Math.imul(O,Lt)|0;var ir=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(ir>>>26)|0,ir&=67108863,f=Math.imul(ht,vt),s=Math.imul(ht,bt),s=s+Math.imul(ft,vt)|0,p=Math.imul(ft,bt),f=f+Math.imul(ut,xt)|0,s=s+Math.imul(ut,Mt)|0,s=s+Math.imul(at,xt)|0,p=p+Math.imul(at,Mt)|0,f=f+Math.imul(pt,_t)|0,s=s+Math.imul(pt,St)|0,s=s+Math.imul(gt,_t)|0,p=p+Math.imul(gt,St)|0,f=f+Math.imul(ct,Et)|0,s=s+Math.imul(ct,kt)|0,s=s+Math.imul(dt,Et)|0,p=p+Math.imul(dt,kt)|0,f=f+Math.imul(rt,Bt)|0,s=s+Math.imul(rt,At)|0,s=s+Math.imul(st,Bt)|0,p=p+Math.imul(st,At)|0,f=f+Math.imul(J,It)|0,s=s+Math.imul(J,Rt)|0,s=s+Math.imul(tt,It)|0,p=p+Math.imul(tt,Rt)|0,f=f+Math.imul(j,Tt)|0,s=s+Math.imul(j,Lt)|0,s=s+Math.imul(Z,Tt)|0,p=p+Math.imul(Z,Lt)|0,f=f+Math.imul(P,Ct)|0,s=s+Math.imul(P,Pt)|0,s=s+Math.imul(O,Ct)|0,p=p+Math.imul(O,Pt)|0;var sr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(sr>>>26)|0,sr&=67108863,f=Math.imul(lt,vt),s=Math.imul(lt,bt),s=s+Math.imul(mt,vt)|0,p=Math.imul(mt,bt),f=f+Math.imul(ht,xt)|0,s=s+Math.imul(ht,Mt)|0,s=s+Math.imul(ft,xt)|0,p=p+Math.imul(ft,Mt)|0,f=f+Math.imul(ut,_t)|0,s=s+Math.imul(ut,St)|0,s=s+Math.imul(at,_t)|0,p=p+Math.imul(at,St)|0,f=f+Math.imul(pt,Et)|0,s=s+Math.imul(pt,kt)|0,s=s+Math.imul(gt,Et)|0,p=p+Math.imul(gt,kt)|0,f=f+Math.imul(ct,Bt)|0,s=s+Math.imul(ct,At)|0,s=s+Math.imul(dt,Bt)|0,p=p+Math.imul(dt,At)|0,f=f+Math.imul(rt,It)|0,s=s+Math.imul(rt,Rt)|0,s=s+Math.imul(st,It)|0,p=p+Math.imul(st,Rt)|0,f=f+Math.imul(J,Tt)|0,s=s+Math.imul(J,Lt)|0,s=s+Math.imul(tt,Tt)|0,p=p+Math.imul(tt,Lt)|0,f=f+Math.imul(j,Ct)|0,s=s+Math.imul(j,Pt)|0,s=s+Math.imul(Z,Ct)|0,p=p+Math.imul(Z,Pt)|0,f=f+Math.imul(P,Ot)|0,s=s+Math.imul(P,Nt)|0,s=s+Math.imul(O,Ot)|0,p=p+Math.imul(O,Nt)|0;var or=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(or>>>26)|0,or&=67108863,f=Math.imul(wt,vt),s=Math.imul(wt,bt),s=s+Math.imul(yt,vt)|0,p=Math.imul(yt,bt),f=f+Math.imul(lt,xt)|0,s=s+Math.imul(lt,Mt)|0,s=s+Math.imul(mt,xt)|0,p=p+Math.imul(mt,Mt)|0,f=f+Math.imul(ht,_t)|0,s=s+Math.imul(ht,St)|0,s=s+Math.imul(ft,_t)|0,p=p+Math.imul(ft,St)|0,f=f+Math.imul(ut,Et)|0,s=s+Math.imul(ut,kt)|0,s=s+Math.imul(at,Et)|0,p=p+Math.imul(at,kt)|0,f=f+Math.imul(pt,Bt)|0,s=s+Math.imul(pt,At)|0,s=s+Math.imul(gt,Bt)|0,p=p+Math.imul(gt,At)|0,f=f+Math.imul(ct,It)|0,s=s+Math.imul(ct,Rt)|0,s=s+Math.imul(dt,It)|0,p=p+Math.imul(dt,Rt)|0,f=f+Math.imul(rt,Tt)|0,s=s+Math.imul(rt,Lt)|0,s=s+Math.imul(st,Tt)|0,p=p+Math.imul(st,Lt)|0,f=f+Math.imul(J,Ct)|0,s=s+Math.imul(J,Pt)|0,s=s+Math.imul(tt,Ct)|0,p=p+Math.imul(tt,Pt)|0,f=f+Math.imul(j,Ot)|0,s=s+Math.imul(j,Nt)|0,s=s+Math.imul(Z,Ot)|0,p=p+Math.imul(Z,Nt)|0,f=f+Math.imul(P,qt)|0,s=s+Math.imul(P,Ut)|0,s=s+Math.imul(O,qt)|0,p=p+Math.imul(O,Ut)|0;var ar=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(ar>>>26)|0,ar&=67108863,f=Math.imul(wt,xt),s=Math.imul(wt,Mt),s=s+Math.imul(yt,xt)|0,p=Math.imul(yt,Mt),f=f+Math.imul(lt,_t)|0,s=s+Math.imul(lt,St)|0,s=s+Math.imul(mt,_t)|0,p=p+Math.imul(mt,St)|0,f=f+Math.imul(ht,Et)|0,s=s+Math.imul(ht,kt)|0,s=s+Math.imul(ft,Et)|0,p=p+Math.imul(ft,kt)|0,f=f+Math.imul(ut,Bt)|0,s=s+Math.imul(ut,At)|0,s=s+Math.imul(at,Bt)|0,p=p+Math.imul(at,At)|0,f=f+Math.imul(pt,It)|0,s=s+Math.imul(pt,Rt)|0,s=s+Math.imul(gt,It)|0,p=p+Math.imul(gt,Rt)|0,f=f+Math.imul(ct,Tt)|0,s=s+Math.imul(ct,Lt)|0,s=s+Math.imul(dt,Tt)|0,p=p+Math.imul(dt,Lt)|0,f=f+Math.imul(rt,Ct)|0,s=s+Math.imul(rt,Pt)|0,s=s+Math.imul(st,Ct)|0,p=p+Math.imul(st,Pt)|0,f=f+Math.imul(J,Ot)|0,s=s+Math.imul(J,Nt)|0,s=s+Math.imul(tt,Ot)|0,p=p+Math.imul(tt,Nt)|0,f=f+Math.imul(j,qt)|0,s=s+Math.imul(j,Ut)|0,s=s+Math.imul(Z,qt)|0,p=p+Math.imul(Z,Ut)|0;var cr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(cr>>>26)|0,cr&=67108863,f=Math.imul(wt,_t),s=Math.imul(wt,St),s=s+Math.imul(yt,_t)|0,p=Math.imul(yt,St),f=f+Math.imul(lt,Et)|0,s=s+Math.imul(lt,kt)|0,s=s+Math.imul(mt,Et)|0,p=p+Math.imul(mt,kt)|0,f=f+Math.imul(ht,Bt)|0,s=s+Math.imul(ht,At)|0,s=s+Math.imul(ft,Bt)|0,p=p+Math.imul(ft,At)|0,f=f+Math.imul(ut,It)|0,s=s+Math.imul(ut,Rt)|0,s=s+Math.imul(at,It)|0,p=p+Math.imul(at,Rt)|0,f=f+Math.imul(pt,Tt)|0,s=s+Math.imul(pt,Lt)|0,s=s+Math.imul(gt,Tt)|0,p=p+Math.imul(gt,Lt)|0,f=f+Math.imul(ct,Ct)|0,s=s+Math.imul(ct,Pt)|0,s=s+Math.imul(dt,Ct)|0,p=p+Math.imul(dt,Pt)|0,f=f+Math.imul(rt,Ot)|0,s=s+Math.imul(rt,Nt)|0,s=s+Math.imul(st,Ot)|0,p=p+Math.imul(st,Nt)|0,f=f+Math.imul(J,qt)|0,s=s+Math.imul(J,Ut)|0,s=s+Math.imul(tt,qt)|0,p=p+Math.imul(tt,Ut)|0;var ur=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(ur>>>26)|0,ur&=67108863,f=Math.imul(wt,Et),s=Math.imul(wt,kt),s=s+Math.imul(yt,Et)|0,p=Math.imul(yt,kt),f=f+Math.imul(lt,Bt)|0,s=s+Math.imul(lt,At)|0,s=s+Math.imul(mt,Bt)|0,p=p+Math.imul(mt,At)|0,f=f+Math.imul(ht,It)|0,s=s+Math.imul(ht,Rt)|0,s=s+Math.imul(ft,It)|0,p=p+Math.imul(ft,Rt)|0,f=f+Math.imul(ut,Tt)|0,s=s+Math.imul(ut,Lt)|0,s=s+Math.imul(at,Tt)|0,p=p+Math.imul(at,Lt)|0,f=f+Math.imul(pt,Ct)|0,s=s+Math.imul(pt,Pt)|0,s=s+Math.imul(gt,Ct)|0,p=p+Math.imul(gt,Pt)|0,f=f+Math.imul(ct,Ot)|0,s=s+Math.imul(ct,Nt)|0,s=s+Math.imul(dt,Ot)|0,p=p+Math.imul(dt,Nt)|0,f=f+Math.imul(rt,qt)|0,s=s+Math.imul(rt,Ut)|0,s=s+Math.imul(st,qt)|0,p=p+Math.imul(st,Ut)|0;var hr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(hr>>>26)|0,hr&=67108863,f=Math.imul(wt,Bt),s=Math.imul(wt,At),s=s+Math.imul(yt,Bt)|0,p=Math.imul(yt,At),f=f+Math.imul(lt,It)|0,s=s+Math.imul(lt,Rt)|0,s=s+Math.imul(mt,It)|0,p=p+Math.imul(mt,Rt)|0,f=f+Math.imul(ht,Tt)|0,s=s+Math.imul(ht,Lt)|0,s=s+Math.imul(ft,Tt)|0,p=p+Math.imul(ft,Lt)|0,f=f+Math.imul(ut,Ct)|0,s=s+Math.imul(ut,Pt)|0,s=s+Math.imul(at,Ct)|0,p=p+Math.imul(at,Pt)|0,f=f+Math.imul(pt,Ot)|0,s=s+Math.imul(pt,Nt)|0,s=s+Math.imul(gt,Ot)|0,p=p+Math.imul(gt,Nt)|0,f=f+Math.imul(ct,qt)|0,s=s+Math.imul(ct,Ut)|0,s=s+Math.imul(dt,qt)|0,p=p+Math.imul(dt,Ut)|0;var fr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(fr>>>26)|0,fr&=67108863,f=Math.imul(wt,It),s=Math.imul(wt,Rt),s=s+Math.imul(yt,It)|0,p=Math.imul(yt,Rt),f=f+Math.imul(lt,Tt)|0,s=s+Math.imul(lt,Lt)|0,s=s+Math.imul(mt,Tt)|0,p=p+Math.imul(mt,Lt)|0,f=f+Math.imul(ht,Ct)|0,s=s+Math.imul(ht,Pt)|0,s=s+Math.imul(ft,Ct)|0,p=p+Math.imul(ft,Pt)|0,f=f+Math.imul(ut,Ot)|0,s=s+Math.imul(ut,Nt)|0,s=s+Math.imul(at,Ot)|0,p=p+Math.imul(at,Nt)|0,f=f+Math.imul(pt,qt)|0,s=s+Math.imul(pt,Ut)|0,s=s+Math.imul(gt,qt)|0,p=p+Math.imul(gt,Ut)|0;var lr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(lr>>>26)|0,lr&=67108863,f=Math.imul(wt,Tt),s=Math.imul(wt,Lt),s=s+Math.imul(yt,Tt)|0,p=Math.imul(yt,Lt),f=f+Math.imul(lt,Ct)|0,s=s+Math.imul(lt,Pt)|0,s=s+Math.imul(mt,Ct)|0,p=p+Math.imul(mt,Pt)|0,f=f+Math.imul(ht,Ot)|0,s=s+Math.imul(ht,Nt)|0,s=s+Math.imul(ft,Ot)|0,p=p+Math.imul(ft,Nt)|0,f=f+Math.imul(ut,qt)|0,s=s+Math.imul(ut,Ut)|0,s=s+Math.imul(at,qt)|0,p=p+Math.imul(at,Ut)|0;var dr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(dr>>>26)|0,dr&=67108863,f=Math.imul(wt,Ct),s=Math.imul(wt,Pt),s=s+Math.imul(yt,Ct)|0,p=Math.imul(yt,Pt),f=f+Math.imul(lt,Ot)|0,s=s+Math.imul(lt,Nt)|0,s=s+Math.imul(mt,Ot)|0,p=p+Math.imul(mt,Nt)|0,f=f+Math.imul(ht,qt)|0,s=s+Math.imul(ht,Ut)|0,s=s+Math.imul(ft,qt)|0,p=p+Math.imul(ft,Ut)|0;var pr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(pr>>>26)|0,pr&=67108863,f=Math.imul(wt,Ot),s=Math.imul(wt,Nt),s=s+Math.imul(yt,Ot)|0,p=Math.imul(yt,Nt),f=f+Math.imul(lt,qt)|0,s=s+Math.imul(lt,Ut)|0,s=s+Math.imul(mt,qt)|0,p=p+Math.imul(mt,Ut)|0;var gr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(gr>>>26)|0,gr&=67108863,f=Math.imul(wt,qt),s=Math.imul(wt,Ut),s=s+Math.imul(yt,qt)|0,p=Math.imul(yt,Ut);var mr=(v+f|0)+((s&8191)<<13)|0;return v=(p+(s>>>13)|0)+(mr>>>26)|0,mr&=67108863,g[0]=Xe,g[1]=Qe,g[2]=tr,g[3]=er,g[4]=rr,g[5]=nr,g[6]=ir,g[7]=sr,g[8]=or,g[9]=ar,g[10]=cr,g[11]=ur,g[12]=hr,g[13]=fr,g[14]=lr,g[15]=dr,g[16]=pr,g[17]=gr,g[18]=mr,v!==0&&(g[19]=v,u.length++),u};Math.imul||(q=T);function I(m,n,a){a.negative=n.negative^m.negative,a.length=m.length+n.length;for(var u=0,l=0,d=0;d<a.length-1;d++){var g=l;l=0;for(var v=u&67108863,f=Math.min(d,n.length-1),s=Math.max(0,d-m.length+1);s<=f;s++){var p=d-s,C=m.words[p]|0,P=n.words[s]|0,O=C*P,Y=O&67108863;g=g+(O/67108864|0)|0,Y=Y+v|0,v=Y&67108863,g=g+(Y>>>26)|0,l+=g>>>26,g&=67108863}a.words[d]=v,u=g,g=l}return u!==0?a.words[d]=u:a.length--,a._strip()}function N(m,n,a){return I(m,n,a)}i.prototype.mulTo=function(n,a){var u,l=this.length+n.length;return this.length===10&&n.length===10?u=q(this,n,a):l<63?u=T(this,n,a):l<1024?u=I(this,n,a):u=N(this,n,a),u},i.prototype.mul=function(n){var a=new i(null);return a.words=new Array(this.length+n.length),this.mulTo(n,a)},i.prototype.mulf=function(n){var a=new i(null);return a.words=new Array(this.length+n.length),N(this,n,a)},i.prototype.imul=function(n){return this.clone().mulTo(n,this)},i.prototype.imuln=function(n){var a=n<0;a&&(n=-n),r(typeof n=="number"),r(n<67108864);for(var u=0,l=0;l<this.length;l++){var d=(this.words[l]|0)*n,g=(d&67108863)+(u&67108863);u>>=26,u+=d/67108864|0,u+=g>>>26,this.words[l]=g&67108863}return u!==0&&(this.words[l]=u,this.length++),a?this.ineg():this},i.prototype.muln=function(n){return this.clone().imuln(n)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(n){var a=M(n);if(a.length===0)return new i(1);for(var u=this,l=0;l<a.length&&a[l]===0;l++,u=u.sqr());if(++l<a.length)for(var d=u.sqr();l<a.length;l++,d=d.sqr())a[l]!==0&&(u=u.mul(d));return u},i.prototype.iushln=function(n){r(typeof n=="number"&&n>=0);var a=n%26,u=(n-a)/26,l=67108863>>>26-a<<26-a,d;if(a!==0){var g=0;for(d=0;d<this.length;d++){var v=this.words[d]&l,f=(this.words[d]|0)-v<<a;this.words[d]=f|g,g=v>>>26-a}g&&(this.words[d]=g,this.length++)}if(u!==0){for(d=this.length-1;d>=0;d--)this.words[d+u]=this.words[d];for(d=0;d<u;d++)this.words[d]=0;this.length+=u}return this._strip()},i.prototype.ishln=function(n){return r(this.negative===0),this.iushln(n)},i.prototype.iushrn=function(n,a,u){r(typeof n=="number"&&n>=0);var l;a?l=(a-a%26)/26:l=0;var d=n%26,g=Math.min((n-d)/26,this.length),v=67108863^67108863>>>d<<d,f=u;if(l-=g,l=Math.max(0,l),f){for(var s=0;s<g;s++)f.words[s]=this.words[s];f.length=g}if(g!==0)if(this.length>g)for(this.length-=g,s=0;s<this.length;s++)this.words[s]=this.words[s+g];else this.words[0]=0,this.length=1;var p=0;for(s=this.length-1;s>=0&&(p!==0||s>=l);s--){var C=this.words[s]|0;this.words[s]=p<<26-d|C>>>d,p=C&v}return f&&p!==0&&(f.words[f.length++]=p),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(n,a,u){return r(this.negative===0),this.iushrn(n,a,u)},i.prototype.shln=function(n){return this.clone().ishln(n)},i.prototype.ushln=function(n){return this.clone().iushln(n)},i.prototype.shrn=function(n){return this.clone().ishrn(n)},i.prototype.ushrn=function(n){return this.clone().iushrn(n)},i.prototype.testn=function(n){r(typeof n=="number"&&n>=0);var a=n%26,u=(n-a)/26,l=1<<a;if(this.length<=u)return!1;var d=this.words[u];return!!(d&l)},i.prototype.imaskn=function(n){r(typeof n=="number"&&n>=0);var a=n%26,u=(n-a)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=u)return this;if(a!==0&&u++,this.length=Math.min(u,this.length),a!==0){var l=67108863^67108863>>>a<<a;this.words[this.length-1]&=l}return this._strip()},i.prototype.maskn=function(n){return this.clone().imaskn(n)},i.prototype.iaddn=function(n){return r(typeof n=="number"),r(n<67108864),n<0?this.isubn(-n):this.negative!==0?this.length===1&&(this.words[0]|0)<=n?(this.words[0]=n-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(n),this.negative=1,this):this._iaddn(n)},i.prototype._iaddn=function(n){this.words[0]+=n;for(var a=0;a<this.length&&this.words[a]>=67108864;a++)this.words[a]-=67108864,a===this.length-1?this.words[a+1]=1:this.words[a+1]++;return this.length=Math.max(this.length,a+1),this},i.prototype.isubn=function(n){if(r(typeof n=="number"),r(n<67108864),n<0)return this.iaddn(-n);if(this.negative!==0)return this.negative=0,this.iaddn(n),this.negative=1,this;if(this.words[0]-=n,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var a=0;a<this.length&&this.words[a]<0;a++)this.words[a]+=67108864,this.words[a+1]-=1;return this._strip()},i.prototype.addn=function(n){return this.clone().iaddn(n)},i.prototype.subn=function(n){return this.clone().isubn(n)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(n,a,u){var l=n.length+u,d;this._expand(l);var g,v=0;for(d=0;d<n.length;d++){g=(this.words[d+u]|0)+v;var f=(n.words[d]|0)*a;g-=f&67108863,v=(g>>26)-(f/67108864|0),this.words[d+u]=g&67108863}for(;d<this.length-u;d++)g=(this.words[d+u]|0)+v,v=g>>26,this.words[d+u]=g&67108863;if(v===0)return this._strip();for(r(v===-1),v=0,d=0;d<this.length;d++)g=-(this.words[d]|0)+v,v=g>>26,this.words[d]=g&67108863;return this.negative=1,this._strip()},i.prototype._wordDiv=function(n,a){var u=this.length-n.length,l=this.clone(),d=n,g=d.words[d.length-1]|0,v=this._countBits(g);u=26-v,u!==0&&(d=d.ushln(u),l.iushln(u),g=d.words[d.length-1]|0);var f=l.length-d.length,s;if(a!=="mod"){s=new i(null),s.length=f+1,s.words=new Array(s.length);for(var p=0;p<s.length;p++)s.words[p]=0}var C=l.clone()._ishlnsubmul(d,1,f);C.negative===0&&(l=C,s&&(s.words[f]=1));for(var P=f-1;P>=0;P--){var O=(l.words[d.length+P]|0)*67108864+(l.words[d.length+P-1]|0);for(O=Math.min(O/g|0,67108863),l._ishlnsubmul(d,O,P);l.negative!==0;)O--,l.negative=0,l._ishlnsubmul(d,1,P),l.isZero()||(l.negative^=1);s&&(s.words[P]=O)}return s&&s._strip(),l._strip(),a!=="div"&&u!==0&&l.iushrn(u),{div:s||null,mod:l}},i.prototype.divmod=function(n,a,u){if(r(!n.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var l,d,g;return this.negative!==0&&n.negative===0?(g=this.neg().divmod(n,a),a!=="mod"&&(l=g.div.neg()),a!=="div"&&(d=g.mod.neg(),u&&d.negative!==0&&d.iadd(n)),{div:l,mod:d}):this.negative===0&&n.negative!==0?(g=this.divmod(n.neg(),a),a!=="mod"&&(l=g.div.neg()),{div:l,mod:g.mod}):this.negative&n.negative?(g=this.neg().divmod(n.neg(),a),a!=="div"&&(d=g.mod.neg(),u&&d.negative!==0&&d.isub(n)),{div:g.div,mod:d}):n.length>this.length||this.cmp(n)<0?{div:new i(0),mod:this}:n.length===1?a==="div"?{div:this.divn(n.words[0]),mod:null}:a==="mod"?{div:null,mod:new i(this.modrn(n.words[0]))}:{div:this.divn(n.words[0]),mod:new i(this.modrn(n.words[0]))}:this._wordDiv(n,a)},i.prototype.div=function(n){return this.divmod(n,"div",!1).div},i.prototype.mod=function(n){return this.divmod(n,"mod",!1).mod},i.prototype.umod=function(n){return this.divmod(n,"mod",!0).mod},i.prototype.divRound=function(n){var a=this.divmod(n);if(a.mod.isZero())return a.div;var u=a.div.negative!==0?a.mod.isub(n):a.mod,l=n.ushrn(1),d=n.andln(1),g=u.cmp(l);return g<0||d===1&&g===0?a.div:a.div.negative!==0?a.div.isubn(1):a.div.iaddn(1)},i.prototype.modrn=function(n){var a=n<0;a&&(n=-n),r(n<=67108863);for(var u=(1<<26)%n,l=0,d=this.length-1;d>=0;d--)l=(u*l+(this.words[d]|0))%n;return a?-l:l},i.prototype.modn=function(n){return this.modrn(n)},i.prototype.idivn=function(n){var a=n<0;a&&(n=-n),r(n<=67108863);for(var u=0,l=this.length-1;l>=0;l--){var d=(this.words[l]|0)+u*67108864;this.words[l]=d/n|0,u=d%n}return this._strip(),a?this.ineg():this},i.prototype.divn=function(n){return this.clone().idivn(n)},i.prototype.egcd=function(n){r(n.negative===0),r(!n.isZero());var a=this,u=n.clone();a.negative!==0?a=a.umod(n):a=a.clone();for(var l=new i(1),d=new i(0),g=new i(0),v=new i(1),f=0;a.isEven()&&u.isEven();)a.iushrn(1),u.iushrn(1),++f;for(var s=u.clone(),p=a.clone();!a.isZero();){for(var C=0,P=1;!(a.words[0]&P)&&C<26;++C,P<<=1);if(C>0)for(a.iushrn(C);C-- >0;)(l.isOdd()||d.isOdd())&&(l.iadd(s),d.isub(p)),l.iushrn(1),d.iushrn(1);for(var O=0,Y=1;!(u.words[0]&Y)&&O<26;++O,Y<<=1);if(O>0)for(u.iushrn(O);O-- >0;)(g.isOdd()||v.isOdd())&&(g.iadd(s),v.isub(p)),g.iushrn(1),v.iushrn(1);a.cmp(u)>=0?(a.isub(u),l.isub(g),d.isub(v)):(u.isub(a),g.isub(l),v.isub(d))}return{a:g,b:v,gcd:u.iushln(f)}},i.prototype._invmp=function(n){r(n.negative===0),r(!n.isZero());var a=this,u=n.clone();a.negative!==0?a=a.umod(n):a=a.clone();for(var l=new i(1),d=new i(0),g=u.clone();a.cmpn(1)>0&&u.cmpn(1)>0;){for(var v=0,f=1;!(a.words[0]&f)&&v<26;++v,f<<=1);if(v>0)for(a.iushrn(v);v-- >0;)l.isOdd()&&l.iadd(g),l.iushrn(1);for(var s=0,p=1;!(u.words[0]&p)&&s<26;++s,p<<=1);if(s>0)for(u.iushrn(s);s-- >0;)d.isOdd()&&d.iadd(g),d.iushrn(1);a.cmp(u)>=0?(a.isub(u),l.isub(d)):(u.isub(a),d.isub(l))}var C;return a.cmpn(1)===0?C=l:C=d,C.cmpn(0)<0&&C.iadd(n),C},i.prototype.gcd=function(n){if(this.isZero())return n.abs();if(n.isZero())return this.abs();var a=this.clone(),u=n.clone();a.negative=0,u.negative=0;for(var l=0;a.isEven()&&u.isEven();l++)a.iushrn(1),u.iushrn(1);do{for(;a.isEven();)a.iushrn(1);for(;u.isEven();)u.iushrn(1);var d=a.cmp(u);if(d<0){var g=a;a=u,u=g}else if(d===0||u.cmpn(1)===0)break;a.isub(u)}while(!0);return u.iushln(l)},i.prototype.invm=function(n){return this.egcd(n).a.umod(n)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(n){return this.words[0]&n},i.prototype.bincn=function(n){r(typeof n=="number");var a=n%26,u=(n-a)/26,l=1<<a;if(this.length<=u)return this._expand(u+1),this.words[u]|=l,this;for(var d=l,g=u;d!==0&&g<this.length;g++){var v=this.words[g]|0;v+=d,d=v>>>26,v&=67108863,this.words[g]=v}return d!==0&&(this.words[g]=d,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(n){var a=n<0;if(this.negative!==0&&!a)return-1;if(this.negative===0&&a)return 1;this._strip();var u;if(this.length>1)u=1;else{a&&(n=-n),r(n<=67108863,"Number is too big");var l=this.words[0]|0;u=l===n?0:l<n?-1:1}return this.negative!==0?-u|0:u},i.prototype.cmp=function(n){if(this.negative!==0&&n.negative===0)return-1;if(this.negative===0&&n.negative!==0)return 1;var a=this.ucmp(n);return this.negative!==0?-a|0:a},i.prototype.ucmp=function(n){if(this.length>n.length)return 1;if(this.length<n.length)return-1;for(var a=0,u=this.length-1;u>=0;u--){var l=this.words[u]|0,d=n.words[u]|0;if(l!==d){l<d?a=-1:l>d&&(a=1);break}}return a},i.prototype.gtn=function(n){return this.cmpn(n)===1},i.prototype.gt=function(n){return this.cmp(n)===1},i.prototype.gten=function(n){return this.cmpn(n)>=0},i.prototype.gte=function(n){return this.cmp(n)>=0},i.prototype.ltn=function(n){return this.cmpn(n)===-1},i.prototype.lt=function(n){return this.cmp(n)===-1},i.prototype.lten=function(n){return this.cmpn(n)<=0},i.prototype.lte=function(n){return this.cmp(n)<=0},i.prototype.eqn=function(n){return this.cmpn(n)===0},i.prototype.eq=function(n){return this.cmp(n)===0},i.red=function(n){return new D(n)},i.prototype.toRed=function(n){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),n.convertTo(this)._forceRed(n)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(n){return this.red=n,this},i.prototype.forceRed=function(n){return r(!this.red,"Already a number in reduction context"),this._forceRed(n)},i.prototype.redAdd=function(n){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,n)},i.prototype.redIAdd=function(n){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,n)},i.prototype.redSub=function(n){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,n)},i.prototype.redISub=function(n){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,n)},i.prototype.redShl=function(n){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,n)},i.prototype.redMul=function(n){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,n),this.red.mul(this,n)},i.prototype.redIMul=function(n){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,n),this.red.imul(this,n)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(n){return r(this.red&&!n.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,n)};var U={k256:null,p224:null,p192:null,p25519:null};function B(m,n){this.name=m,this.p=new i(n,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}B.prototype._tmp=function(){var n=new i(null);return n.words=new Array(Math.ceil(this.n/13)),n},B.prototype.ireduce=function(n){var a=n,u;do this.split(a,this.tmp),a=this.imulK(a),a=a.iadd(this.tmp),u=a.bitLength();while(u>this.n);var l=u<this.n?-1:a.ucmp(this.p);return l===0?(a.words[0]=0,a.length=1):l>0?a.isub(this.p):a.strip!==void 0?a.strip():a._strip(),a},B.prototype.split=function(n,a){n.iushrn(this.n,0,a)},B.prototype.imulK=function(n){return n.imul(this.k)};function K(){B.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}c(K,B),K.prototype.split=function(n,a){for(var u=4194303,l=Math.min(n.length,9),d=0;d<l;d++)a.words[d]=n.words[d];if(a.length=l,n.length<=9){n.words[0]=0,n.length=1;return}var g=n.words[9];for(a.words[a.length++]=g&u,d=10;d<n.length;d++){var v=n.words[d]|0;n.words[d-10]=(v&u)<<4|g>>>22,g=v}g>>>=22,n.words[d-10]=g,g===0&&n.length>10?n.length-=10:n.length-=9},K.prototype.imulK=function(n){n.words[n.length]=0,n.words[n.length+1]=0,n.length+=2;for(var a=0,u=0;u<n.length;u++){var l=n.words[u]|0;a+=l*977,n.words[u]=a&67108863,a=l*64+(a/67108864|0)}return n.words[n.length-1]===0&&(n.length--,n.words[n.length-1]===0&&n.length--),n};function F(){B.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}c(F,B);function V(){B.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}c(V,B);function et(){B.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}c(et,B),et.prototype.imulK=function(n){for(var a=0,u=0;u<n.length;u++){var l=(n.words[u]|0)*19+a,d=l&67108863;l>>>=26,n.words[u]=d,a=l}return a!==0&&(n.words[n.length++]=a),n},i._prime=function(n){if(U[n])return U[n];var a;if(n==="k256")a=new K;else if(n==="p224")a=new F;else if(n==="p192")a=new V;else if(n==="p25519")a=new et;else throw new Error("Unknown prime "+n);return U[n]=a,a};function D(m){if(typeof m=="string"){var n=i._prime(m);this.m=n.p,this.prime=n}else r(m.gtn(1),"modulus must be greater than 1"),this.m=m,this.prime=null}D.prototype._verify1=function(n){r(n.negative===0,"red works only with positives"),r(n.red,"red works only with red numbers")},D.prototype._verify2=function(n,a){r((n.negative|a.negative)===0,"red works only with positives"),r(n.red&&n.red===a.red,"red works only with red numbers")},D.prototype.imod=function(n){return this.prime?this.prime.ireduce(n)._forceRed(this):(x(n,n.umod(this.m)._forceRed(this)),n)},D.prototype.neg=function(n){return n.isZero()?n.clone():this.m.sub(n)._forceRed(this)},D.prototype.add=function(n,a){this._verify2(n,a);var u=n.add(a);return u.cmp(this.m)>=0&&u.isub(this.m),u._forceRed(this)},D.prototype.iadd=function(n,a){this._verify2(n,a);var u=n.iadd(a);return u.cmp(this.m)>=0&&u.isub(this.m),u},D.prototype.sub=function(n,a){this._verify2(n,a);var u=n.sub(a);return u.cmpn(0)<0&&u.iadd(this.m),u._forceRed(this)},D.prototype.isub=function(n,a){this._verify2(n,a);var u=n.isub(a);return u.cmpn(0)<0&&u.iadd(this.m),u},D.prototype.shl=function(n,a){return this._verify1(n),this.imod(n.ushln(a))},D.prototype.imul=function(n,a){return this._verify2(n,a),this.imod(n.imul(a))},D.prototype.mul=function(n,a){return this._verify2(n,a),this.imod(n.mul(a))},D.prototype.isqr=function(n){return this.imul(n,n.clone())},D.prototype.sqr=function(n){return this.mul(n,n)},D.prototype.sqrt=function(n){if(n.isZero())return n.clone();var a=this.m.andln(3);if(r(a%2===1),a===3){var u=this.m.add(new i(1)).iushrn(2);return this.pow(n,u)}for(var l=this.m.subn(1),d=0;!l.isZero()&&l.andln(1)===0;)d++,l.iushrn(1);r(!l.isZero());var g=new i(1).toRed(this),v=g.redNeg(),f=this.m.subn(1).iushrn(1),s=this.m.bitLength();for(s=new i(2*s*s).toRed(this);this.pow(s,f).cmp(v)!==0;)s.redIAdd(v);for(var p=this.pow(s,l),C=this.pow(n,l.addn(1).iushrn(1)),P=this.pow(n,l),O=d;P.cmp(g)!==0;){for(var Y=P,j=0;Y.cmp(g)!==0;j++)Y=Y.redSqr();r(j<O);var Z=this.pow(p,new i(1).iushln(O-j-1));C=C.redMul(Z),p=Z.redSqr(),P=P.redMul(p),O=j}return C},D.prototype.invm=function(n){var a=n._invmp(this.m);return a.negative!==0?(a.negative=0,this.imod(a).redNeg()):this.imod(a)},D.prototype.pow=function(n,a){if(a.isZero())return new i(1).toRed(this);if(a.cmpn(1)===0)return n.clone();var u=4,l=new Array(1<<u);l[0]=new i(1).toRed(this),l[1]=n;for(var d=2;d<l.length;d++)l[d]=this.mul(l[d-1],n);var g=l[0],v=0,f=0,s=a.bitLength()%26;for(s===0&&(s=26),d=a.length-1;d>=0;d--){for(var p=a.words[d],C=s-1;C>=0;C--){var P=p>>C&1;if(g!==l[0]&&(g=this.sqr(g)),P===0&&v===0){f=0;continue}v<<=1,v|=P,f++,!(f!==u&&(d!==0||C!==0))&&(g=this.mul(g,l[v]),f=0,v=0)}s=26}return g},D.prototype.convertTo=function(n){var a=n.umod(this.m);return a===n?a.clone():a},D.prototype.convertFrom=function(n){var a=n.clone();return a.red=null,a},i.mont=function(n){return new Ft(n)};function Ft(m){D.call(this,m),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}c(Ft,D),Ft.prototype.convertTo=function(n){return this.imod(n.ushln(this.shift))},Ft.prototype.convertFrom=function(n){var a=this.imod(n.mul(this.rinv));return a.red=null,a},Ft.prototype.imul=function(n,a){if(n.isZero()||a.isZero())return n.words[0]=0,n.length=1,n;var u=n.imul(a),l=u.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=u.isub(l).iushrn(this.shift),g=d;return d.cmp(this.m)>=0?g=d.isub(this.m):d.cmpn(0)<0&&(g=d.iadd(this.m)),g._forceRed(this)},Ft.prototype.mul=function(n,a){if(n.isZero()||a.isZero())return new i(0)._forceRed(this);var u=n.mul(a),l=u.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=u.isub(l).iushrn(this.shift),g=d;return d.cmp(this.m)>=0?g=d.isub(this.m):d.cmpn(0)<0&&(g=d.iadd(this.m)),g._forceRed(this)},Ft.prototype.invm=function(n){var a=this.imod(n._invmp(this.m).mul(this.r2));return a._forceRed(this)}})(o,Me)})(_i);var wc=_i.exports;const rs=hn(wc);var yn=Xo.Buffer;function yc(o){if(o.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),e=0;e<t.length;e++)t[e]=255;for(var r=0;r<o.length;r++){var c=o.charAt(r),i=c.charCodeAt(0);if(t[i]!==255)throw new TypeError(c+" is ambiguous");t[i]=r}var h=o.length,w=o.charAt(0),y=Math.log(h)/Math.log(256),b=Math.log(256)/Math.log(h);function x(k){if((Array.isArray(k)||k instanceof Uint8Array)&&(k=yn.from(k)),!yn.isBuffer(k))throw new TypeError("Expected Buffer");if(k.length===0)return"";for(var E=0,S=0,M=0,T=k.length;M!==T&&k[M]===0;)M++,E++;for(var q=(T-M)*b+1>>>0,I=new Uint8Array(q);M!==T;){for(var N=k[M],U=0,B=q-1;(N!==0||U<S)&&B!==-1;B--,U++)N+=256*I[B]>>>0,I[B]=N%h>>>0,N=N/h>>>0;if(N!==0)throw new Error("Non-zero carry");S=U,M++}for(var K=q-S;K!==q&&I[K]===0;)K++;for(var F=w.repeat(E);K<q;++K)F+=o.charAt(I[K]);return F}function _(k){if(typeof k!="string")throw new TypeError("Expected String");if(k.length===0)return yn.alloc(0);for(var E=0,S=0,M=0;k[E]===w;)S++,E++;for(var T=(k.length-E)*y+1>>>0,q=new Uint8Array(T);k[E];){var I=t[k.charCodeAt(E)];if(I===255)return;for(var N=0,U=T-1;(I!==0||N<M)&&U!==-1;U--,N++)I+=h*q[U]>>>0,q[U]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");M=N,E++}for(var B=T-M;B!==T&&q[B]===0;)B++;var K=yn.allocUnsafe(S+(T-B));K.fill(0,0,S);for(var F=S;B!==T;)K[F++]=q[B++];return K}function L(k){var E=_(k);if(E)return E;throw new Error("Non-base"+h+" character")}return{encode:x,decodeUnsafe:_,decode:L}}var vc=yc,bc=vc,xc="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",Gs=bc(xc);const Zt=hn(Gs),Mc=(o,t,e)=>o&t^~o&e,_c=(o,t,e)=>o&t^o&e^t&e,Sc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),De=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),He=new Uint32Array(64);class Ec extends Os{constructor(){super(64,32,8,!1),this.A=De[0]|0,this.B=De[1]|0,this.C=De[2]|0,this.D=De[3]|0,this.E=De[4]|0,this.F=De[5]|0,this.G=De[6]|0,this.H=De[7]|0}get(){const{A:t,B:e,C:r,D:c,E:i,F:h,G:w,H:y}=this;return[t,e,r,c,i,h,w,y]}set(t,e,r,c,i,h,w,y){this.A=t|0,this.B=e|0,this.C=r|0,this.D=c|0,this.E=i|0,this.F=h|0,this.G=w|0,this.H=y|0}process(t,e){for(let _=0;_<16;_++,e+=4)He[_]=t.getUint32(e,!1);for(let _=16;_<64;_++){const L=He[_-15],k=He[_-2],E=Be(L,7)^Be(L,18)^L>>>3,S=Be(k,17)^Be(k,19)^k>>>10;He[_]=S+He[_-7]+E+He[_-16]|0}let{A:r,B:c,C:i,D:h,E:w,F:y,G:b,H:x}=this;for(let _=0;_<64;_++){const L=Be(w,6)^Be(w,11)^Be(w,25),k=x+L+Mc(w,y,b)+Sc[_]+He[_]|0,S=(Be(r,2)^Be(r,13)^Be(r,22))+_c(r,c,i)|0;x=b,b=y,y=w,w=h+k|0,h=i,i=c,c=r,r=k+S|0}r=r+this.A|0,c=c+this.B|0,i=i+this.C|0,h=h+this.D|0,w=w+this.E|0,y=y+this.F|0,b=b+this.G|0,x=x+this.H|0,this.set(r,c,i,h,w,y,b,x)}roundClean(){He.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const ri=Cs(()=>new Ec);var ue={},Si={exports:{}};Si.exports;(function(o){(function(t,e){function r(m,n){if(!m)throw new Error(n||"Assertion failed")}function c(m,n){m.super_=n;var a=function(){};a.prototype=n.prototype,m.prototype=new a,m.prototype.constructor=m}function i(m,n,a){if(i.isBN(m))return m;this.negative=0,this.words=null,this.length=0,this.red=null,m!==null&&((n==="le"||n==="be")&&(a=n,n=10),this._init(m||0,n||10,a||"be"))}typeof t=="object"?t.exports=i:e.BN=i,i.BN=i,i.wordSize=26;var h;try{typeof window<"u"&&typeof window.Buffer<"u"?h=window.Buffer:h=ks.Buffer}catch{}i.isBN=function(n){return n instanceof i?!0:n!==null&&typeof n=="object"&&n.constructor.wordSize===i.wordSize&&Array.isArray(n.words)},i.max=function(n,a){return n.cmp(a)>0?n:a},i.min=function(n,a){return n.cmp(a)<0?n:a},i.prototype._init=function(n,a,u){if(typeof n=="number")return this._initNumber(n,a,u);if(typeof n=="object")return this._initArray(n,a,u);a==="hex"&&(a=16),r(a===(a|0)&&a>=2&&a<=36),n=n.toString().replace(/\s+/g,"");var l=0;n[0]==="-"&&(l++,this.negative=1),l<n.length&&(a===16?this._parseHex(n,l,u):(this._parseBase(n,a,l),u==="le"&&this._initArray(this.toArray(),a,u)))},i.prototype._initNumber=function(n,a,u){n<0&&(this.negative=1,n=-n),n<67108864?(this.words=[n&67108863],this.length=1):n<4503599627370496?(this.words=[n&67108863,n/67108864&67108863],this.length=2):(r(n<9007199254740992),this.words=[n&67108863,n/67108864&67108863,1],this.length=3),u==="le"&&this._initArray(this.toArray(),a,u)},i.prototype._initArray=function(n,a,u){if(r(typeof n.length=="number"),n.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(n.length/3),this.words=new Array(this.length);for(var l=0;l<this.length;l++)this.words[l]=0;var d,g,v=0;if(u==="be")for(l=n.length-1,d=0;l>=0;l-=3)g=n[l]|n[l-1]<<8|n[l-2]<<16,this.words[d]|=g<<v&67108863,this.words[d+1]=g>>>26-v&67108863,v+=24,v>=26&&(v-=26,d++);else if(u==="le")for(l=0,d=0;l<n.length;l+=3)g=n[l]|n[l+1]<<8|n[l+2]<<16,this.words[d]|=g<<v&67108863,this.words[d+1]=g>>>26-v&67108863,v+=24,v>=26&&(v-=26,d++);return this._strip()};function w(m,n){var a=m.charCodeAt(n);if(a>=48&&a<=57)return a-48;if(a>=65&&a<=70)return a-55;if(a>=97&&a<=102)return a-87;r(!1,"Invalid character in "+m)}function y(m,n,a){var u=w(m,a);return a-1>=n&&(u|=w(m,a-1)<<4),u}i.prototype._parseHex=function(n,a,u){this.length=Math.ceil((n.length-a)/6),this.words=new Array(this.length);for(var l=0;l<this.length;l++)this.words[l]=0;var d=0,g=0,v;if(u==="be")for(l=n.length-1;l>=a;l-=2)v=y(n,a,l)<<d,this.words[g]|=v&67108863,d>=18?(d-=18,g+=1,this.words[g]|=v>>>26):d+=8;else{var f=n.length-a;for(l=f%2===0?a+1:a;l<n.length;l+=2)v=y(n,a,l)<<d,this.words[g]|=v&67108863,d>=18?(d-=18,g+=1,this.words[g]|=v>>>26):d+=8}this._strip()};function b(m,n,a,u){for(var l=0,d=0,g=Math.min(m.length,a),v=n;v<g;v++){var f=m.charCodeAt(v)-48;l*=u,f>=49?d=f-49+10:f>=17?d=f-17+10:d=f,r(f>=0&&d<u,"Invalid character"),l+=d}return l}i.prototype._parseBase=function(n,a,u){this.words=[0],this.length=1;for(var l=0,d=1;d<=67108863;d*=a)l++;l--,d=d/a|0;for(var g=n.length-u,v=g%l,f=Math.min(g,g-v)+u,s=0,p=u;p<f;p+=l)s=b(n,p,p+l,a),this.imuln(d),this.words[0]+s<67108864?this.words[0]+=s:this._iaddn(s);if(v!==0){var C=1;for(s=b(n,p,n.length,a),p=0;p<v;p++)C*=a;this.imuln(C),this.words[0]+s<67108864?this.words[0]+=s:this._iaddn(s)}this._strip()},i.prototype.copy=function(n){n.words=new Array(this.length);for(var a=0;a<this.length;a++)n.words[a]=this.words[a];n.length=this.length,n.negative=this.negative,n.red=this.red};function x(m,n){m.words=n.words,m.length=n.length,m.negative=n.negative,m.red=n.red}if(i.prototype._move=function(n){x(n,this)},i.prototype.clone=function(){var n=new i(null);return this.copy(n),n},i.prototype._expand=function(n){for(;this.length<n;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=_}catch{i.prototype.inspect=_}else i.prototype.inspect=_;function _(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var L=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],k=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],E=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(n,a){n=n||10,a=a|0||1;var u;if(n===16||n==="hex"){u="";for(var l=0,d=0,g=0;g<this.length;g++){var v=this.words[g],f=((v<<l|d)&16777215).toString(16);d=v>>>24-l&16777215,l+=2,l>=26&&(l-=26,g--),d!==0||g!==this.length-1?u=L[6-f.length]+f+u:u=f+u}for(d!==0&&(u=d.toString(16)+u);u.length%a!==0;)u="0"+u;return this.negative!==0&&(u="-"+u),u}if(n===(n|0)&&n>=2&&n<=36){var s=k[n],p=E[n];u="";var C=this.clone();for(C.negative=0;!C.isZero();){var P=C.modrn(p).toString(n);C=C.idivn(p),C.isZero()?u=P+u:u=L[s-P.length]+P+u}for(this.isZero()&&(u="0"+u);u.length%a!==0;)u="0"+u;return this.negative!==0&&(u="-"+u),u}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var n=this.words[0];return this.length===2?n+=this.words[1]*67108864:this.length===3&&this.words[2]===1?n+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-n:n},i.prototype.toJSON=function(){return this.toString(16,2)},h&&(i.prototype.toBuffer=function(n,a){return this.toArrayLike(h,n,a)}),i.prototype.toArray=function(n,a){return this.toArrayLike(Array,n,a)};var S=function(n,a){return n.allocUnsafe?n.allocUnsafe(a):new n(a)};i.prototype.toArrayLike=function(n,a,u){this._strip();var l=this.byteLength(),d=u||Math.max(1,l);r(l<=d,"byte array longer than desired length"),r(d>0,"Requested array length <= 0");var g=S(n,d),v=a==="le"?"LE":"BE";return this["_toArrayLike"+v](g,l),g},i.prototype._toArrayLikeLE=function(n,a){for(var u=0,l=0,d=0,g=0;d<this.length;d++){var v=this.words[d]<<g|l;n[u++]=v&255,u<n.length&&(n[u++]=v>>8&255),u<n.length&&(n[u++]=v>>16&255),g===6?(u<n.length&&(n[u++]=v>>24&255),l=0,g=0):(l=v>>>24,g+=2)}if(u<n.length)for(n[u++]=l;u<n.length;)n[u++]=0},i.prototype._toArrayLikeBE=function(n,a){for(var u=n.length-1,l=0,d=0,g=0;d<this.length;d++){var v=this.words[d]<<g|l;n[u--]=v&255,u>=0&&(n[u--]=v>>8&255),u>=0&&(n[u--]=v>>16&255),g===6?(u>=0&&(n[u--]=v>>24&255),l=0,g=0):(l=v>>>24,g+=2)}if(u>=0)for(n[u--]=l;u>=0;)n[u--]=0},Math.clz32?i.prototype._countBits=function(n){return 32-Math.clz32(n)}:i.prototype._countBits=function(n){var a=n,u=0;return a>=4096&&(u+=13,a>>>=13),a>=64&&(u+=7,a>>>=7),a>=8&&(u+=4,a>>>=4),a>=2&&(u+=2,a>>>=2),u+a},i.prototype._zeroBits=function(n){if(n===0)return 26;var a=n,u=0;return a&8191||(u+=13,a>>>=13),a&127||(u+=7,a>>>=7),a&15||(u+=4,a>>>=4),a&3||(u+=2,a>>>=2),a&1||u++,u},i.prototype.bitLength=function(){var n=this.words[this.length-1],a=this._countBits(n);return(this.length-1)*26+a};function M(m){for(var n=new Array(m.bitLength()),a=0;a<n.length;a++){var u=a/26|0,l=a%26;n[a]=m.words[u]>>>l&1}return n}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var n=0,a=0;a<this.length;a++){var u=this._zeroBits(this.words[a]);if(n+=u,u!==26)break}return n},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(n){return this.negative!==0?this.abs().inotn(n).iaddn(1):this.clone()},i.prototype.fromTwos=function(n){return this.testn(n-1)?this.notn(n).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(n){for(;this.length<n.length;)this.words[this.length++]=0;for(var a=0;a<n.length;a++)this.words[a]=this.words[a]|n.words[a];return this._strip()},i.prototype.ior=function(n){return r((this.negative|n.negative)===0),this.iuor(n)},i.prototype.or=function(n){return this.length>n.length?this.clone().ior(n):n.clone().ior(this)},i.prototype.uor=function(n){return this.length>n.length?this.clone().iuor(n):n.clone().iuor(this)},i.prototype.iuand=function(n){var a;this.length>n.length?a=n:a=this;for(var u=0;u<a.length;u++)this.words[u]=this.words[u]&n.words[u];return this.length=a.length,this._strip()},i.prototype.iand=function(n){return r((this.negative|n.negative)===0),this.iuand(n)},i.prototype.and=function(n){return this.length>n.length?this.clone().iand(n):n.clone().iand(this)},i.prototype.uand=function(n){return this.length>n.length?this.clone().iuand(n):n.clone().iuand(this)},i.prototype.iuxor=function(n){var a,u;this.length>n.length?(a=this,u=n):(a=n,u=this);for(var l=0;l<u.length;l++)this.words[l]=a.words[l]^u.words[l];if(this!==a)for(;l<a.length;l++)this.words[l]=a.words[l];return this.length=a.length,this._strip()},i.prototype.ixor=function(n){return r((this.negative|n.negative)===0),this.iuxor(n)},i.prototype.xor=function(n){return this.length>n.length?this.clone().ixor(n):n.clone().ixor(this)},i.prototype.uxor=function(n){return this.length>n.length?this.clone().iuxor(n):n.clone().iuxor(this)},i.prototype.inotn=function(n){r(typeof n=="number"&&n>=0);var a=Math.ceil(n/26)|0,u=n%26;this._expand(a),u>0&&a--;for(var l=0;l<a;l++)this.words[l]=~this.words[l]&67108863;return u>0&&(this.words[l]=~this.words[l]&67108863>>26-u),this._strip()},i.prototype.notn=function(n){return this.clone().inotn(n)},i.prototype.setn=function(n,a){r(typeof n=="number"&&n>=0);var u=n/26|0,l=n%26;return this._expand(u+1),a?this.words[u]=this.words[u]|1<<l:this.words[u]=this.words[u]&~(1<<l),this._strip()},i.prototype.iadd=function(n){var a;if(this.negative!==0&&n.negative===0)return this.negative=0,a=this.isub(n),this.negative^=1,this._normSign();if(this.negative===0&&n.negative!==0)return n.negative=0,a=this.isub(n),n.negative=1,a._normSign();var u,l;this.length>n.length?(u=this,l=n):(u=n,l=this);for(var d=0,g=0;g<l.length;g++)a=(u.words[g]|0)+(l.words[g]|0)+d,this.words[g]=a&67108863,d=a>>>26;for(;d!==0&&g<u.length;g++)a=(u.words[g]|0)+d,this.words[g]=a&67108863,d=a>>>26;if(this.length=u.length,d!==0)this.words[this.length]=d,this.length++;else if(u!==this)for(;g<u.length;g++)this.words[g]=u.words[g];return this},i.prototype.add=function(n){var a;return n.negative!==0&&this.negative===0?(n.negative=0,a=this.sub(n),n.negative^=1,a):n.negative===0&&this.negative!==0?(this.negative=0,a=n.sub(this),this.negative=1,a):this.length>n.length?this.clone().iadd(n):n.clone().iadd(this)},i.prototype.isub=function(n){if(n.negative!==0){n.negative=0;var a=this.iadd(n);return n.negative=1,a._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(n),this.negative=1,this._normSign();var u=this.cmp(n);if(u===0)return this.negative=0,this.length=1,this.words[0]=0,this;var l,d;u>0?(l=this,d=n):(l=n,d=this);for(var g=0,v=0;v<d.length;v++)a=(l.words[v]|0)-(d.words[v]|0)+g,g=a>>26,this.words[v]=a&67108863;for(;g!==0&&v<l.length;v++)a=(l.words[v]|0)+g,g=a>>26,this.words[v]=a&67108863;if(g===0&&v<l.length&&l!==this)for(;v<l.length;v++)this.words[v]=l.words[v];return this.length=Math.max(this.length,v),l!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(n){return this.clone().isub(n)};function T(m,n,a){a.negative=n.negative^m.negative;var u=m.length+n.length|0;a.length=u,u=u-1|0;var l=m.words[0]|0,d=n.words[0]|0,g=l*d,v=g&67108863,f=g/67108864|0;a.words[0]=v;for(var s=1;s<u;s++){for(var p=f>>>26,C=f&67108863,P=Math.min(s,n.length-1),O=Math.max(0,s-m.length+1);O<=P;O++){var Y=s-O|0;l=m.words[Y]|0,d=n.words[O]|0,g=l*d+C,p+=g/67108864|0,C=g&67108863}a.words[s]=C|0,f=p|0}return f!==0?a.words[s]=f|0:a.length--,a._strip()}var q=function(n,a,u){var l=n.words,d=a.words,g=u.words,v=0,f,s,p,C=l[0]|0,P=C&8191,O=C>>>13,Y=l[1]|0,j=Y&8191,Z=Y>>>13,Xt=l[2]|0,J=Xt&8191,tt=Xt>>>13,Vt=l[3]|0,rt=Vt&8191,st=Vt>>>13,_e=l[4]|0,ct=_e&8191,dt=_e>>>13,Ye=l[5]|0,pt=Ye&8191,gt=Ye>>>13,qe=l[6]|0,ut=qe&8191,at=qe>>>13,Ue=l[7]|0,ht=Ue&8191,ft=Ue>>>13,Fe=l[8]|0,lt=Fe&8191,mt=Fe>>>13,Je=l[9]|0,wt=Je&8191,yt=Je>>>13,jr=d[0]|0,vt=jr&8191,bt=jr>>>13,Gr=d[1]|0,xt=Gr&8191,Mt=Gr>>>13,Zr=d[2]|0,_t=Zr&8191,St=Zr>>>13,Vr=d[3]|0,Et=Vr&8191,kt=Vr>>>13,Yr=d[4]|0,Bt=Yr&8191,At=Yr>>>13,Jr=d[5]|0,It=Jr&8191,Rt=Jr>>>13,Xr=d[6]|0,Tt=Xr&8191,Lt=Xr>>>13,Qr=d[7]|0,Ct=Qr&8191,Pt=Qr>>>13,tn=d[8]|0,Ot=tn&8191,Nt=tn>>>13,en=d[9]|0,qt=en&8191,Ut=en>>>13;u.negative=n.negative^a.negative,u.length=19,f=Math.imul(P,vt),s=Math.imul(P,bt),s=s+Math.imul(O,vt)|0,p=Math.imul(O,bt);var Xe=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,f=Math.imul(j,vt),s=Math.imul(j,bt),s=s+Math.imul(Z,vt)|0,p=Math.imul(Z,bt),f=f+Math.imul(P,xt)|0,s=s+Math.imul(P,Mt)|0,s=s+Math.imul(O,xt)|0,p=p+Math.imul(O,Mt)|0;var Qe=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,f=Math.imul(J,vt),s=Math.imul(J,bt),s=s+Math.imul(tt,vt)|0,p=Math.imul(tt,bt),f=f+Math.imul(j,xt)|0,s=s+Math.imul(j,Mt)|0,s=s+Math.imul(Z,xt)|0,p=p+Math.imul(Z,Mt)|0,f=f+Math.imul(P,_t)|0,s=s+Math.imul(P,St)|0,s=s+Math.imul(O,_t)|0,p=p+Math.imul(O,St)|0;var tr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(tr>>>26)|0,tr&=67108863,f=Math.imul(rt,vt),s=Math.imul(rt,bt),s=s+Math.imul(st,vt)|0,p=Math.imul(st,bt),f=f+Math.imul(J,xt)|0,s=s+Math.imul(J,Mt)|0,s=s+Math.imul(tt,xt)|0,p=p+Math.imul(tt,Mt)|0,f=f+Math.imul(j,_t)|0,s=s+Math.imul(j,St)|0,s=s+Math.imul(Z,_t)|0,p=p+Math.imul(Z,St)|0,f=f+Math.imul(P,Et)|0,s=s+Math.imul(P,kt)|0,s=s+Math.imul(O,Et)|0,p=p+Math.imul(O,kt)|0;var er=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(er>>>26)|0,er&=67108863,f=Math.imul(ct,vt),s=Math.imul(ct,bt),s=s+Math.imul(dt,vt)|0,p=Math.imul(dt,bt),f=f+Math.imul(rt,xt)|0,s=s+Math.imul(rt,Mt)|0,s=s+Math.imul(st,xt)|0,p=p+Math.imul(st,Mt)|0,f=f+Math.imul(J,_t)|0,s=s+Math.imul(J,St)|0,s=s+Math.imul(tt,_t)|0,p=p+Math.imul(tt,St)|0,f=f+Math.imul(j,Et)|0,s=s+Math.imul(j,kt)|0,s=s+Math.imul(Z,Et)|0,p=p+Math.imul(Z,kt)|0,f=f+Math.imul(P,Bt)|0,s=s+Math.imul(P,At)|0,s=s+Math.imul(O,Bt)|0,p=p+Math.imul(O,At)|0;var rr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(rr>>>26)|0,rr&=67108863,f=Math.imul(pt,vt),s=Math.imul(pt,bt),s=s+Math.imul(gt,vt)|0,p=Math.imul(gt,bt),f=f+Math.imul(ct,xt)|0,s=s+Math.imul(ct,Mt)|0,s=s+Math.imul(dt,xt)|0,p=p+Math.imul(dt,Mt)|0,f=f+Math.imul(rt,_t)|0,s=s+Math.imul(rt,St)|0,s=s+Math.imul(st,_t)|0,p=p+Math.imul(st,St)|0,f=f+Math.imul(J,Et)|0,s=s+Math.imul(J,kt)|0,s=s+Math.imul(tt,Et)|0,p=p+Math.imul(tt,kt)|0,f=f+Math.imul(j,Bt)|0,s=s+Math.imul(j,At)|0,s=s+Math.imul(Z,Bt)|0,p=p+Math.imul(Z,At)|0,f=f+Math.imul(P,It)|0,s=s+Math.imul(P,Rt)|0,s=s+Math.imul(O,It)|0,p=p+Math.imul(O,Rt)|0;var nr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(nr>>>26)|0,nr&=67108863,f=Math.imul(ut,vt),s=Math.imul(ut,bt),s=s+Math.imul(at,vt)|0,p=Math.imul(at,bt),f=f+Math.imul(pt,xt)|0,s=s+Math.imul(pt,Mt)|0,s=s+Math.imul(gt,xt)|0,p=p+Math.imul(gt,Mt)|0,f=f+Math.imul(ct,_t)|0,s=s+Math.imul(ct,St)|0,s=s+Math.imul(dt,_t)|0,p=p+Math.imul(dt,St)|0,f=f+Math.imul(rt,Et)|0,s=s+Math.imul(rt,kt)|0,s=s+Math.imul(st,Et)|0,p=p+Math.imul(st,kt)|0,f=f+Math.imul(J,Bt)|0,s=s+Math.imul(J,At)|0,s=s+Math.imul(tt,Bt)|0,p=p+Math.imul(tt,At)|0,f=f+Math.imul(j,It)|0,s=s+Math.imul(j,Rt)|0,s=s+Math.imul(Z,It)|0,p=p+Math.imul(Z,Rt)|0,f=f+Math.imul(P,Tt)|0,s=s+Math.imul(P,Lt)|0,s=s+Math.imul(O,Tt)|0,p=p+Math.imul(O,Lt)|0;var ir=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(ir>>>26)|0,ir&=67108863,f=Math.imul(ht,vt),s=Math.imul(ht,bt),s=s+Math.imul(ft,vt)|0,p=Math.imul(ft,bt),f=f+Math.imul(ut,xt)|0,s=s+Math.imul(ut,Mt)|0,s=s+Math.imul(at,xt)|0,p=p+Math.imul(at,Mt)|0,f=f+Math.imul(pt,_t)|0,s=s+Math.imul(pt,St)|0,s=s+Math.imul(gt,_t)|0,p=p+Math.imul(gt,St)|0,f=f+Math.imul(ct,Et)|0,s=s+Math.imul(ct,kt)|0,s=s+Math.imul(dt,Et)|0,p=p+Math.imul(dt,kt)|0,f=f+Math.imul(rt,Bt)|0,s=s+Math.imul(rt,At)|0,s=s+Math.imul(st,Bt)|0,p=p+Math.imul(st,At)|0,f=f+Math.imul(J,It)|0,s=s+Math.imul(J,Rt)|0,s=s+Math.imul(tt,It)|0,p=p+Math.imul(tt,Rt)|0,f=f+Math.imul(j,Tt)|0,s=s+Math.imul(j,Lt)|0,s=s+Math.imul(Z,Tt)|0,p=p+Math.imul(Z,Lt)|0,f=f+Math.imul(P,Ct)|0,s=s+Math.imul(P,Pt)|0,s=s+Math.imul(O,Ct)|0,p=p+Math.imul(O,Pt)|0;var sr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(sr>>>26)|0,sr&=67108863,f=Math.imul(lt,vt),s=Math.imul(lt,bt),s=s+Math.imul(mt,vt)|0,p=Math.imul(mt,bt),f=f+Math.imul(ht,xt)|0,s=s+Math.imul(ht,Mt)|0,s=s+Math.imul(ft,xt)|0,p=p+Math.imul(ft,Mt)|0,f=f+Math.imul(ut,_t)|0,s=s+Math.imul(ut,St)|0,s=s+Math.imul(at,_t)|0,p=p+Math.imul(at,St)|0,f=f+Math.imul(pt,Et)|0,s=s+Math.imul(pt,kt)|0,s=s+Math.imul(gt,Et)|0,p=p+Math.imul(gt,kt)|0,f=f+Math.imul(ct,Bt)|0,s=s+Math.imul(ct,At)|0,s=s+Math.imul(dt,Bt)|0,p=p+Math.imul(dt,At)|0,f=f+Math.imul(rt,It)|0,s=s+Math.imul(rt,Rt)|0,s=s+Math.imul(st,It)|0,p=p+Math.imul(st,Rt)|0,f=f+Math.imul(J,Tt)|0,s=s+Math.imul(J,Lt)|0,s=s+Math.imul(tt,Tt)|0,p=p+Math.imul(tt,Lt)|0,f=f+Math.imul(j,Ct)|0,s=s+Math.imul(j,Pt)|0,s=s+Math.imul(Z,Ct)|0,p=p+Math.imul(Z,Pt)|0,f=f+Math.imul(P,Ot)|0,s=s+Math.imul(P,Nt)|0,s=s+Math.imul(O,Ot)|0,p=p+Math.imul(O,Nt)|0;var or=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(or>>>26)|0,or&=67108863,f=Math.imul(wt,vt),s=Math.imul(wt,bt),s=s+Math.imul(yt,vt)|0,p=Math.imul(yt,bt),f=f+Math.imul(lt,xt)|0,s=s+Math.imul(lt,Mt)|0,s=s+Math.imul(mt,xt)|0,p=p+Math.imul(mt,Mt)|0,f=f+Math.imul(ht,_t)|0,s=s+Math.imul(ht,St)|0,s=s+Math.imul(ft,_t)|0,p=p+Math.imul(ft,St)|0,f=f+Math.imul(ut,Et)|0,s=s+Math.imul(ut,kt)|0,s=s+Math.imul(at,Et)|0,p=p+Math.imul(at,kt)|0,f=f+Math.imul(pt,Bt)|0,s=s+Math.imul(pt,At)|0,s=s+Math.imul(gt,Bt)|0,p=p+Math.imul(gt,At)|0,f=f+Math.imul(ct,It)|0,s=s+Math.imul(ct,Rt)|0,s=s+Math.imul(dt,It)|0,p=p+Math.imul(dt,Rt)|0,f=f+Math.imul(rt,Tt)|0,s=s+Math.imul(rt,Lt)|0,s=s+Math.imul(st,Tt)|0,p=p+Math.imul(st,Lt)|0,f=f+Math.imul(J,Ct)|0,s=s+Math.imul(J,Pt)|0,s=s+Math.imul(tt,Ct)|0,p=p+Math.imul(tt,Pt)|0,f=f+Math.imul(j,Ot)|0,s=s+Math.imul(j,Nt)|0,s=s+Math.imul(Z,Ot)|0,p=p+Math.imul(Z,Nt)|0,f=f+Math.imul(P,qt)|0,s=s+Math.imul(P,Ut)|0,s=s+Math.imul(O,qt)|0,p=p+Math.imul(O,Ut)|0;var ar=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(ar>>>26)|0,ar&=67108863,f=Math.imul(wt,xt),s=Math.imul(wt,Mt),s=s+Math.imul(yt,xt)|0,p=Math.imul(yt,Mt),f=f+Math.imul(lt,_t)|0,s=s+Math.imul(lt,St)|0,s=s+Math.imul(mt,_t)|0,p=p+Math.imul(mt,St)|0,f=f+Math.imul(ht,Et)|0,s=s+Math.imul(ht,kt)|0,s=s+Math.imul(ft,Et)|0,p=p+Math.imul(ft,kt)|0,f=f+Math.imul(ut,Bt)|0,s=s+Math.imul(ut,At)|0,s=s+Math.imul(at,Bt)|0,p=p+Math.imul(at,At)|0,f=f+Math.imul(pt,It)|0,s=s+Math.imul(pt,Rt)|0,s=s+Math.imul(gt,It)|0,p=p+Math.imul(gt,Rt)|0,f=f+Math.imul(ct,Tt)|0,s=s+Math.imul(ct,Lt)|0,s=s+Math.imul(dt,Tt)|0,p=p+Math.imul(dt,Lt)|0,f=f+Math.imul(rt,Ct)|0,s=s+Math.imul(rt,Pt)|0,s=s+Math.imul(st,Ct)|0,p=p+Math.imul(st,Pt)|0,f=f+Math.imul(J,Ot)|0,s=s+Math.imul(J,Nt)|0,s=s+Math.imul(tt,Ot)|0,p=p+Math.imul(tt,Nt)|0,f=f+Math.imul(j,qt)|0,s=s+Math.imul(j,Ut)|0,s=s+Math.imul(Z,qt)|0,p=p+Math.imul(Z,Ut)|0;var cr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(cr>>>26)|0,cr&=67108863,f=Math.imul(wt,_t),s=Math.imul(wt,St),s=s+Math.imul(yt,_t)|0,p=Math.imul(yt,St),f=f+Math.imul(lt,Et)|0,s=s+Math.imul(lt,kt)|0,s=s+Math.imul(mt,Et)|0,p=p+Math.imul(mt,kt)|0,f=f+Math.imul(ht,Bt)|0,s=s+Math.imul(ht,At)|0,s=s+Math.imul(ft,Bt)|0,p=p+Math.imul(ft,At)|0,f=f+Math.imul(ut,It)|0,s=s+Math.imul(ut,Rt)|0,s=s+Math.imul(at,It)|0,p=p+Math.imul(at,Rt)|0,f=f+Math.imul(pt,Tt)|0,s=s+Math.imul(pt,Lt)|0,s=s+Math.imul(gt,Tt)|0,p=p+Math.imul(gt,Lt)|0,f=f+Math.imul(ct,Ct)|0,s=s+Math.imul(ct,Pt)|0,s=s+Math.imul(dt,Ct)|0,p=p+Math.imul(dt,Pt)|0,f=f+Math.imul(rt,Ot)|0,s=s+Math.imul(rt,Nt)|0,s=s+Math.imul(st,Ot)|0,p=p+Math.imul(st,Nt)|0,f=f+Math.imul(J,qt)|0,s=s+Math.imul(J,Ut)|0,s=s+Math.imul(tt,qt)|0,p=p+Math.imul(tt,Ut)|0;var ur=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(ur>>>26)|0,ur&=67108863,f=Math.imul(wt,Et),s=Math.imul(wt,kt),s=s+Math.imul(yt,Et)|0,p=Math.imul(yt,kt),f=f+Math.imul(lt,Bt)|0,s=s+Math.imul(lt,At)|0,s=s+Math.imul(mt,Bt)|0,p=p+Math.imul(mt,At)|0,f=f+Math.imul(ht,It)|0,s=s+Math.imul(ht,Rt)|0,s=s+Math.imul(ft,It)|0,p=p+Math.imul(ft,Rt)|0,f=f+Math.imul(ut,Tt)|0,s=s+Math.imul(ut,Lt)|0,s=s+Math.imul(at,Tt)|0,p=p+Math.imul(at,Lt)|0,f=f+Math.imul(pt,Ct)|0,s=s+Math.imul(pt,Pt)|0,s=s+Math.imul(gt,Ct)|0,p=p+Math.imul(gt,Pt)|0,f=f+Math.imul(ct,Ot)|0,s=s+Math.imul(ct,Nt)|0,s=s+Math.imul(dt,Ot)|0,p=p+Math.imul(dt,Nt)|0,f=f+Math.imul(rt,qt)|0,s=s+Math.imul(rt,Ut)|0,s=s+Math.imul(st,qt)|0,p=p+Math.imul(st,Ut)|0;var hr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(hr>>>26)|0,hr&=67108863,f=Math.imul(wt,Bt),s=Math.imul(wt,At),s=s+Math.imul(yt,Bt)|0,p=Math.imul(yt,At),f=f+Math.imul(lt,It)|0,s=s+Math.imul(lt,Rt)|0,s=s+Math.imul(mt,It)|0,p=p+Math.imul(mt,Rt)|0,f=f+Math.imul(ht,Tt)|0,s=s+Math.imul(ht,Lt)|0,s=s+Math.imul(ft,Tt)|0,p=p+Math.imul(ft,Lt)|0,f=f+Math.imul(ut,Ct)|0,s=s+Math.imul(ut,Pt)|0,s=s+Math.imul(at,Ct)|0,p=p+Math.imul(at,Pt)|0,f=f+Math.imul(pt,Ot)|0,s=s+Math.imul(pt,Nt)|0,s=s+Math.imul(gt,Ot)|0,p=p+Math.imul(gt,Nt)|0,f=f+Math.imul(ct,qt)|0,s=s+Math.imul(ct,Ut)|0,s=s+Math.imul(dt,qt)|0,p=p+Math.imul(dt,Ut)|0;var fr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(fr>>>26)|0,fr&=67108863,f=Math.imul(wt,It),s=Math.imul(wt,Rt),s=s+Math.imul(yt,It)|0,p=Math.imul(yt,Rt),f=f+Math.imul(lt,Tt)|0,s=s+Math.imul(lt,Lt)|0,s=s+Math.imul(mt,Tt)|0,p=p+Math.imul(mt,Lt)|0,f=f+Math.imul(ht,Ct)|0,s=s+Math.imul(ht,Pt)|0,s=s+Math.imul(ft,Ct)|0,p=p+Math.imul(ft,Pt)|0,f=f+Math.imul(ut,Ot)|0,s=s+Math.imul(ut,Nt)|0,s=s+Math.imul(at,Ot)|0,p=p+Math.imul(at,Nt)|0,f=f+Math.imul(pt,qt)|0,s=s+Math.imul(pt,Ut)|0,s=s+Math.imul(gt,qt)|0,p=p+Math.imul(gt,Ut)|0;var lr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(lr>>>26)|0,lr&=67108863,f=Math.imul(wt,Tt),s=Math.imul(wt,Lt),s=s+Math.imul(yt,Tt)|0,p=Math.imul(yt,Lt),f=f+Math.imul(lt,Ct)|0,s=s+Math.imul(lt,Pt)|0,s=s+Math.imul(mt,Ct)|0,p=p+Math.imul(mt,Pt)|0,f=f+Math.imul(ht,Ot)|0,s=s+Math.imul(ht,Nt)|0,s=s+Math.imul(ft,Ot)|0,p=p+Math.imul(ft,Nt)|0,f=f+Math.imul(ut,qt)|0,s=s+Math.imul(ut,Ut)|0,s=s+Math.imul(at,qt)|0,p=p+Math.imul(at,Ut)|0;var dr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(dr>>>26)|0,dr&=67108863,f=Math.imul(wt,Ct),s=Math.imul(wt,Pt),s=s+Math.imul(yt,Ct)|0,p=Math.imul(yt,Pt),f=f+Math.imul(lt,Ot)|0,s=s+Math.imul(lt,Nt)|0,s=s+Math.imul(mt,Ot)|0,p=p+Math.imul(mt,Nt)|0,f=f+Math.imul(ht,qt)|0,s=s+Math.imul(ht,Ut)|0,s=s+Math.imul(ft,qt)|0,p=p+Math.imul(ft,Ut)|0;var pr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(pr>>>26)|0,pr&=67108863,f=Math.imul(wt,Ot),s=Math.imul(wt,Nt),s=s+Math.imul(yt,Ot)|0,p=Math.imul(yt,Nt),f=f+Math.imul(lt,qt)|0,s=s+Math.imul(lt,Ut)|0,s=s+Math.imul(mt,qt)|0,p=p+Math.imul(mt,Ut)|0;var gr=(v+f|0)+((s&8191)<<13)|0;v=(p+(s>>>13)|0)+(gr>>>26)|0,gr&=67108863,f=Math.imul(wt,qt),s=Math.imul(wt,Ut),s=s+Math.imul(yt,qt)|0,p=Math.imul(yt,Ut);var mr=(v+f|0)+((s&8191)<<13)|0;return v=(p+(s>>>13)|0)+(mr>>>26)|0,mr&=67108863,g[0]=Xe,g[1]=Qe,g[2]=tr,g[3]=er,g[4]=rr,g[5]=nr,g[6]=ir,g[7]=sr,g[8]=or,g[9]=ar,g[10]=cr,g[11]=ur,g[12]=hr,g[13]=fr,g[14]=lr,g[15]=dr,g[16]=pr,g[17]=gr,g[18]=mr,v!==0&&(g[19]=v,u.length++),u};Math.imul||(q=T);function I(m,n,a){a.negative=n.negative^m.negative,a.length=m.length+n.length;for(var u=0,l=0,d=0;d<a.length-1;d++){var g=l;l=0;for(var v=u&67108863,f=Math.min(d,n.length-1),s=Math.max(0,d-m.length+1);s<=f;s++){var p=d-s,C=m.words[p]|0,P=n.words[s]|0,O=C*P,Y=O&67108863;g=g+(O/67108864|0)|0,Y=Y+v|0,v=Y&67108863,g=g+(Y>>>26)|0,l+=g>>>26,g&=67108863}a.words[d]=v,u=g,g=l}return u!==0?a.words[d]=u:a.length--,a._strip()}function N(m,n,a){return I(m,n,a)}i.prototype.mulTo=function(n,a){var u,l=this.length+n.length;return this.length===10&&n.length===10?u=q(this,n,a):l<63?u=T(this,n,a):l<1024?u=I(this,n,a):u=N(this,n,a),u},i.prototype.mul=function(n){var a=new i(null);return a.words=new Array(this.length+n.length),this.mulTo(n,a)},i.prototype.mulf=function(n){var a=new i(null);return a.words=new Array(this.length+n.length),N(this,n,a)},i.prototype.imul=function(n){return this.clone().mulTo(n,this)},i.prototype.imuln=function(n){var a=n<0;a&&(n=-n),r(typeof n=="number"),r(n<67108864);for(var u=0,l=0;l<this.length;l++){var d=(this.words[l]|0)*n,g=(d&67108863)+(u&67108863);u>>=26,u+=d/67108864|0,u+=g>>>26,this.words[l]=g&67108863}return u!==0&&(this.words[l]=u,this.length++),a?this.ineg():this},i.prototype.muln=function(n){return this.clone().imuln(n)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(n){var a=M(n);if(a.length===0)return new i(1);for(var u=this,l=0;l<a.length&&a[l]===0;l++,u=u.sqr());if(++l<a.length)for(var d=u.sqr();l<a.length;l++,d=d.sqr())a[l]!==0&&(u=u.mul(d));return u},i.prototype.iushln=function(n){r(typeof n=="number"&&n>=0);var a=n%26,u=(n-a)/26,l=67108863>>>26-a<<26-a,d;if(a!==0){var g=0;for(d=0;d<this.length;d++){var v=this.words[d]&l,f=(this.words[d]|0)-v<<a;this.words[d]=f|g,g=v>>>26-a}g&&(this.words[d]=g,this.length++)}if(u!==0){for(d=this.length-1;d>=0;d--)this.words[d+u]=this.words[d];for(d=0;d<u;d++)this.words[d]=0;this.length+=u}return this._strip()},i.prototype.ishln=function(n){return r(this.negative===0),this.iushln(n)},i.prototype.iushrn=function(n,a,u){r(typeof n=="number"&&n>=0);var l;a?l=(a-a%26)/26:l=0;var d=n%26,g=Math.min((n-d)/26,this.length),v=67108863^67108863>>>d<<d,f=u;if(l-=g,l=Math.max(0,l),f){for(var s=0;s<g;s++)f.words[s]=this.words[s];f.length=g}if(g!==0)if(this.length>g)for(this.length-=g,s=0;s<this.length;s++)this.words[s]=this.words[s+g];else this.words[0]=0,this.length=1;var p=0;for(s=this.length-1;s>=0&&(p!==0||s>=l);s--){var C=this.words[s]|0;this.words[s]=p<<26-d|C>>>d,p=C&v}return f&&p!==0&&(f.words[f.length++]=p),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(n,a,u){return r(this.negative===0),this.iushrn(n,a,u)},i.prototype.shln=function(n){return this.clone().ishln(n)},i.prototype.ushln=function(n){return this.clone().iushln(n)},i.prototype.shrn=function(n){return this.clone().ishrn(n)},i.prototype.ushrn=function(n){return this.clone().iushrn(n)},i.prototype.testn=function(n){r(typeof n=="number"&&n>=0);var a=n%26,u=(n-a)/26,l=1<<a;if(this.length<=u)return!1;var d=this.words[u];return!!(d&l)},i.prototype.imaskn=function(n){r(typeof n=="number"&&n>=0);var a=n%26,u=(n-a)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=u)return this;if(a!==0&&u++,this.length=Math.min(u,this.length),a!==0){var l=67108863^67108863>>>a<<a;this.words[this.length-1]&=l}return this._strip()},i.prototype.maskn=function(n){return this.clone().imaskn(n)},i.prototype.iaddn=function(n){return r(typeof n=="number"),r(n<67108864),n<0?this.isubn(-n):this.negative!==0?this.length===1&&(this.words[0]|0)<=n?(this.words[0]=n-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(n),this.negative=1,this):this._iaddn(n)},i.prototype._iaddn=function(n){this.words[0]+=n;for(var a=0;a<this.length&&this.words[a]>=67108864;a++)this.words[a]-=67108864,a===this.length-1?this.words[a+1]=1:this.words[a+1]++;return this.length=Math.max(this.length,a+1),this},i.prototype.isubn=function(n){if(r(typeof n=="number"),r(n<67108864),n<0)return this.iaddn(-n);if(this.negative!==0)return this.negative=0,this.iaddn(n),this.negative=1,this;if(this.words[0]-=n,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var a=0;a<this.length&&this.words[a]<0;a++)this.words[a]+=67108864,this.words[a+1]-=1;return this._strip()},i.prototype.addn=function(n){return this.clone().iaddn(n)},i.prototype.subn=function(n){return this.clone().isubn(n)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(n,a,u){var l=n.length+u,d;this._expand(l);var g,v=0;for(d=0;d<n.length;d++){g=(this.words[d+u]|0)+v;var f=(n.words[d]|0)*a;g-=f&67108863,v=(g>>26)-(f/67108864|0),this.words[d+u]=g&67108863}for(;d<this.length-u;d++)g=(this.words[d+u]|0)+v,v=g>>26,this.words[d+u]=g&67108863;if(v===0)return this._strip();for(r(v===-1),v=0,d=0;d<this.length;d++)g=-(this.words[d]|0)+v,v=g>>26,this.words[d]=g&67108863;return this.negative=1,this._strip()},i.prototype._wordDiv=function(n,a){var u=this.length-n.length,l=this.clone(),d=n,g=d.words[d.length-1]|0,v=this._countBits(g);u=26-v,u!==0&&(d=d.ushln(u),l.iushln(u),g=d.words[d.length-1]|0);var f=l.length-d.length,s;if(a!=="mod"){s=new i(null),s.length=f+1,s.words=new Array(s.length);for(var p=0;p<s.length;p++)s.words[p]=0}var C=l.clone()._ishlnsubmul(d,1,f);C.negative===0&&(l=C,s&&(s.words[f]=1));for(var P=f-1;P>=0;P--){var O=(l.words[d.length+P]|0)*67108864+(l.words[d.length+P-1]|0);for(O=Math.min(O/g|0,67108863),l._ishlnsubmul(d,O,P);l.negative!==0;)O--,l.negative=0,l._ishlnsubmul(d,1,P),l.isZero()||(l.negative^=1);s&&(s.words[P]=O)}return s&&s._strip(),l._strip(),a!=="div"&&u!==0&&l.iushrn(u),{div:s||null,mod:l}},i.prototype.divmod=function(n,a,u){if(r(!n.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var l,d,g;return this.negative!==0&&n.negative===0?(g=this.neg().divmod(n,a),a!=="mod"&&(l=g.div.neg()),a!=="div"&&(d=g.mod.neg(),u&&d.negative!==0&&d.iadd(n)),{div:l,mod:d}):this.negative===0&&n.negative!==0?(g=this.divmod(n.neg(),a),a!=="mod"&&(l=g.div.neg()),{div:l,mod:g.mod}):this.negative&n.negative?(g=this.neg().divmod(n.neg(),a),a!=="div"&&(d=g.mod.neg(),u&&d.negative!==0&&d.isub(n)),{div:g.div,mod:d}):n.length>this.length||this.cmp(n)<0?{div:new i(0),mod:this}:n.length===1?a==="div"?{div:this.divn(n.words[0]),mod:null}:a==="mod"?{div:null,mod:new i(this.modrn(n.words[0]))}:{div:this.divn(n.words[0]),mod:new i(this.modrn(n.words[0]))}:this._wordDiv(n,a)},i.prototype.div=function(n){return this.divmod(n,"div",!1).div},i.prototype.mod=function(n){return this.divmod(n,"mod",!1).mod},i.prototype.umod=function(n){return this.divmod(n,"mod",!0).mod},i.prototype.divRound=function(n){var a=this.divmod(n);if(a.mod.isZero())return a.div;var u=a.div.negative!==0?a.mod.isub(n):a.mod,l=n.ushrn(1),d=n.andln(1),g=u.cmp(l);return g<0||d===1&&g===0?a.div:a.div.negative!==0?a.div.isubn(1):a.div.iaddn(1)},i.prototype.modrn=function(n){var a=n<0;a&&(n=-n),r(n<=67108863);for(var u=(1<<26)%n,l=0,d=this.length-1;d>=0;d--)l=(u*l+(this.words[d]|0))%n;return a?-l:l},i.prototype.modn=function(n){return this.modrn(n)},i.prototype.idivn=function(n){var a=n<0;a&&(n=-n),r(n<=67108863);for(var u=0,l=this.length-1;l>=0;l--){var d=(this.words[l]|0)+u*67108864;this.words[l]=d/n|0,u=d%n}return this._strip(),a?this.ineg():this},i.prototype.divn=function(n){return this.clone().idivn(n)},i.prototype.egcd=function(n){r(n.negative===0),r(!n.isZero());var a=this,u=n.clone();a.negative!==0?a=a.umod(n):a=a.clone();for(var l=new i(1),d=new i(0),g=new i(0),v=new i(1),f=0;a.isEven()&&u.isEven();)a.iushrn(1),u.iushrn(1),++f;for(var s=u.clone(),p=a.clone();!a.isZero();){for(var C=0,P=1;!(a.words[0]&P)&&C<26;++C,P<<=1);if(C>0)for(a.iushrn(C);C-- >0;)(l.isOdd()||d.isOdd())&&(l.iadd(s),d.isub(p)),l.iushrn(1),d.iushrn(1);for(var O=0,Y=1;!(u.words[0]&Y)&&O<26;++O,Y<<=1);if(O>0)for(u.iushrn(O);O-- >0;)(g.isOdd()||v.isOdd())&&(g.iadd(s),v.isub(p)),g.iushrn(1),v.iushrn(1);a.cmp(u)>=0?(a.isub(u),l.isub(g),d.isub(v)):(u.isub(a),g.isub(l),v.isub(d))}return{a:g,b:v,gcd:u.iushln(f)}},i.prototype._invmp=function(n){r(n.negative===0),r(!n.isZero());var a=this,u=n.clone();a.negative!==0?a=a.umod(n):a=a.clone();for(var l=new i(1),d=new i(0),g=u.clone();a.cmpn(1)>0&&u.cmpn(1)>0;){for(var v=0,f=1;!(a.words[0]&f)&&v<26;++v,f<<=1);if(v>0)for(a.iushrn(v);v-- >0;)l.isOdd()&&l.iadd(g),l.iushrn(1);for(var s=0,p=1;!(u.words[0]&p)&&s<26;++s,p<<=1);if(s>0)for(u.iushrn(s);s-- >0;)d.isOdd()&&d.iadd(g),d.iushrn(1);a.cmp(u)>=0?(a.isub(u),l.isub(d)):(u.isub(a),d.isub(l))}var C;return a.cmpn(1)===0?C=l:C=d,C.cmpn(0)<0&&C.iadd(n),C},i.prototype.gcd=function(n){if(this.isZero())return n.abs();if(n.isZero())return this.abs();var a=this.clone(),u=n.clone();a.negative=0,u.negative=0;for(var l=0;a.isEven()&&u.isEven();l++)a.iushrn(1),u.iushrn(1);do{for(;a.isEven();)a.iushrn(1);for(;u.isEven();)u.iushrn(1);var d=a.cmp(u);if(d<0){var g=a;a=u,u=g}else if(d===0||u.cmpn(1)===0)break;a.isub(u)}while(!0);return u.iushln(l)},i.prototype.invm=function(n){return this.egcd(n).a.umod(n)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(n){return this.words[0]&n},i.prototype.bincn=function(n){r(typeof n=="number");var a=n%26,u=(n-a)/26,l=1<<a;if(this.length<=u)return this._expand(u+1),this.words[u]|=l,this;for(var d=l,g=u;d!==0&&g<this.length;g++){var v=this.words[g]|0;v+=d,d=v>>>26,v&=67108863,this.words[g]=v}return d!==0&&(this.words[g]=d,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(n){var a=n<0;if(this.negative!==0&&!a)return-1;if(this.negative===0&&a)return 1;this._strip();var u;if(this.length>1)u=1;else{a&&(n=-n),r(n<=67108863,"Number is too big");var l=this.words[0]|0;u=l===n?0:l<n?-1:1}return this.negative!==0?-u|0:u},i.prototype.cmp=function(n){if(this.negative!==0&&n.negative===0)return-1;if(this.negative===0&&n.negative!==0)return 1;var a=this.ucmp(n);return this.negative!==0?-a|0:a},i.prototype.ucmp=function(n){if(this.length>n.length)return 1;if(this.length<n.length)return-1;for(var a=0,u=this.length-1;u>=0;u--){var l=this.words[u]|0,d=n.words[u]|0;if(l!==d){l<d?a=-1:l>d&&(a=1);break}}return a},i.prototype.gtn=function(n){return this.cmpn(n)===1},i.prototype.gt=function(n){return this.cmp(n)===1},i.prototype.gten=function(n){return this.cmpn(n)>=0},i.prototype.gte=function(n){return this.cmp(n)>=0},i.prototype.ltn=function(n){return this.cmpn(n)===-1},i.prototype.lt=function(n){return this.cmp(n)===-1},i.prototype.lten=function(n){return this.cmpn(n)<=0},i.prototype.lte=function(n){return this.cmp(n)<=0},i.prototype.eqn=function(n){return this.cmpn(n)===0},i.prototype.eq=function(n){return this.cmp(n)===0},i.red=function(n){return new D(n)},i.prototype.toRed=function(n){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),n.convertTo(this)._forceRed(n)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(n){return this.red=n,this},i.prototype.forceRed=function(n){return r(!this.red,"Already a number in reduction context"),this._forceRed(n)},i.prototype.redAdd=function(n){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,n)},i.prototype.redIAdd=function(n){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,n)},i.prototype.redSub=function(n){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,n)},i.prototype.redISub=function(n){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,n)},i.prototype.redShl=function(n){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,n)},i.prototype.redMul=function(n){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,n),this.red.mul(this,n)},i.prototype.redIMul=function(n){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,n),this.red.imul(this,n)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(n){return r(this.red&&!n.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,n)};var U={k256:null,p224:null,p192:null,p25519:null};function B(m,n){this.name=m,this.p=new i(n,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}B.prototype._tmp=function(){var n=new i(null);return n.words=new Array(Math.ceil(this.n/13)),n},B.prototype.ireduce=function(n){var a=n,u;do this.split(a,this.tmp),a=this.imulK(a),a=a.iadd(this.tmp),u=a.bitLength();while(u>this.n);var l=u<this.n?-1:a.ucmp(this.p);return l===0?(a.words[0]=0,a.length=1):l>0?a.isub(this.p):a.strip!==void 0?a.strip():a._strip(),a},B.prototype.split=function(n,a){n.iushrn(this.n,0,a)},B.prototype.imulK=function(n){return n.imul(this.k)};function K(){B.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}c(K,B),K.prototype.split=function(n,a){for(var u=4194303,l=Math.min(n.length,9),d=0;d<l;d++)a.words[d]=n.words[d];if(a.length=l,n.length<=9){n.words[0]=0,n.length=1;return}var g=n.words[9];for(a.words[a.length++]=g&u,d=10;d<n.length;d++){var v=n.words[d]|0;n.words[d-10]=(v&u)<<4|g>>>22,g=v}g>>>=22,n.words[d-10]=g,g===0&&n.length>10?n.length-=10:n.length-=9},K.prototype.imulK=function(n){n.words[n.length]=0,n.words[n.length+1]=0,n.length+=2;for(var a=0,u=0;u<n.length;u++){var l=n.words[u]|0;a+=l*977,n.words[u]=a&67108863,a=l*64+(a/67108864|0)}return n.words[n.length-1]===0&&(n.length--,n.words[n.length-1]===0&&n.length--),n};function F(){B.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}c(F,B);function V(){B.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}c(V,B);function et(){B.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}c(et,B),et.prototype.imulK=function(n){for(var a=0,u=0;u<n.length;u++){var l=(n.words[u]|0)*19+a,d=l&67108863;l>>>=26,n.words[u]=d,a=l}return a!==0&&(n.words[n.length++]=a),n},i._prime=function(n){if(U[n])return U[n];var a;if(n==="k256")a=new K;else if(n==="p224")a=new F;else if(n==="p192")a=new V;else if(n==="p25519")a=new et;else throw new Error("Unknown prime "+n);return U[n]=a,a};function D(m){if(typeof m=="string"){var n=i._prime(m);this.m=n.p,this.prime=n}else r(m.gtn(1),"modulus must be greater than 1"),this.m=m,this.prime=null}D.prototype._verify1=function(n){r(n.negative===0,"red works only with positives"),r(n.red,"red works only with red numbers")},D.prototype._verify2=function(n,a){r((n.negative|a.negative)===0,"red works only with positives"),r(n.red&&n.red===a.red,"red works only with red numbers")},D.prototype.imod=function(n){return this.prime?this.prime.ireduce(n)._forceRed(this):(x(n,n.umod(this.m)._forceRed(this)),n)},D.prototype.neg=function(n){return n.isZero()?n.clone():this.m.sub(n)._forceRed(this)},D.prototype.add=function(n,a){this._verify2(n,a);var u=n.add(a);return u.cmp(this.m)>=0&&u.isub(this.m),u._forceRed(this)},D.prototype.iadd=function(n,a){this._verify2(n,a);var u=n.iadd(a);return u.cmp(this.m)>=0&&u.isub(this.m),u},D.prototype.sub=function(n,a){this._verify2(n,a);var u=n.sub(a);return u.cmpn(0)<0&&u.iadd(this.m),u._forceRed(this)},D.prototype.isub=function(n,a){this._verify2(n,a);var u=n.isub(a);return u.cmpn(0)<0&&u.iadd(this.m),u},D.prototype.shl=function(n,a){return this._verify1(n),this.imod(n.ushln(a))},D.prototype.imul=function(n,a){return this._verify2(n,a),this.imod(n.imul(a))},D.prototype.mul=function(n,a){return this._verify2(n,a),this.imod(n.mul(a))},D.prototype.isqr=function(n){return this.imul(n,n.clone())},D.prototype.sqr=function(n){return this.mul(n,n)},D.prototype.sqrt=function(n){if(n.isZero())return n.clone();var a=this.m.andln(3);if(r(a%2===1),a===3){var u=this.m.add(new i(1)).iushrn(2);return this.pow(n,u)}for(var l=this.m.subn(1),d=0;!l.isZero()&&l.andln(1)===0;)d++,l.iushrn(1);r(!l.isZero());var g=new i(1).toRed(this),v=g.redNeg(),f=this.m.subn(1).iushrn(1),s=this.m.bitLength();for(s=new i(2*s*s).toRed(this);this.pow(s,f).cmp(v)!==0;)s.redIAdd(v);for(var p=this.pow(s,l),C=this.pow(n,l.addn(1).iushrn(1)),P=this.pow(n,l),O=d;P.cmp(g)!==0;){for(var Y=P,j=0;Y.cmp(g)!==0;j++)Y=Y.redSqr();r(j<O);var Z=this.pow(p,new i(1).iushln(O-j-1));C=C.redMul(Z),p=Z.redSqr(),P=P.redMul(p),O=j}return C},D.prototype.invm=function(n){var a=n._invmp(this.m);return a.negative!==0?(a.negative=0,this.imod(a).redNeg()):this.imod(a)},D.prototype.pow=function(n,a){if(a.isZero())return new i(1).toRed(this);if(a.cmpn(1)===0)return n.clone();var u=4,l=new Array(1<<u);l[0]=new i(1).toRed(this),l[1]=n;for(var d=2;d<l.length;d++)l[d]=this.mul(l[d-1],n);var g=l[0],v=0,f=0,s=a.bitLength()%26;for(s===0&&(s=26),d=a.length-1;d>=0;d--){for(var p=a.words[d],C=s-1;C>=0;C--){var P=p>>C&1;if(g!==l[0]&&(g=this.sqr(g)),P===0&&v===0){f=0;continue}v<<=1,v|=P,f++,!(f!==u&&(d!==0||C!==0))&&(g=this.mul(g,l[v]),f=0,v=0)}s=26}return g},D.prototype.convertTo=function(n){var a=n.umod(this.m);return a===n?a.clone():a},D.prototype.convertFrom=function(n){var a=n.clone();return a.red=null,a},i.mont=function(n){return new Ft(n)};function Ft(m){D.call(this,m),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}c(Ft,D),Ft.prototype.convertTo=function(n){return this.imod(n.ushln(this.shift))},Ft.prototype.convertFrom=function(n){var a=this.imod(n.mul(this.rinv));return a.red=null,a},Ft.prototype.imul=function(n,a){if(n.isZero()||a.isZero())return n.words[0]=0,n.length=1,n;var u=n.imul(a),l=u.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=u.isub(l).iushrn(this.shift),g=d;return d.cmp(this.m)>=0?g=d.isub(this.m):d.cmpn(0)<0&&(g=d.iadd(this.m)),g._forceRed(this)},Ft.prototype.mul=function(n,a){if(n.isZero()||a.isZero())return new i(0)._forceRed(this);var u=n.mul(a),l=u.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=u.isub(l).iushrn(this.shift),g=d;return d.cmp(this.m)>=0?g=d.isub(this.m):d.cmpn(0)<0&&(g=d.iadd(this.m)),g._forceRed(this)},Ft.prototype.invm=function(n){var a=this.imod(n._invmp(this.m).mul(this.r2));return a._forceRed(this)}})(o,Me)})(Si);var kc=Si.exports;function Pe(o,t,e){return t<=o&&o<=e}function On(o){if(o===void 0)return{};if(o===Object(o))return o;throw TypeError("Could not convert argument to dictionary")}function Bc(o){for(var t=String(o),e=t.length,r=0,c=[];r<e;){var i=t.charCodeAt(r);if(i<55296||i>57343)c.push(i);else if(56320<=i&&i<=57343)c.push(65533);else if(55296<=i&&i<=56319)if(r===e-1)c.push(65533);else{var h=o.charCodeAt(r+1);if(56320<=h&&h<=57343){var w=i&1023,y=h&1023;c.push(65536+(w<<10)+y),r+=1}else c.push(65533)}r+=1}return c}function Ac(o){for(var t="",e=0;e<o.length;++e){var r=o[e];r<=65535?t+=String.fromCharCode(r):(r-=65536,t+=String.fromCharCode((r>>10)+55296,(r&1023)+56320))}return t}var Sn=-1;function Ei(o){this.tokens=[].slice.call(o)}Ei.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():Sn},prepend:function(o){if(Array.isArray(o))for(var t=o;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(o)},push:function(o){if(Array.isArray(o))for(var t=o;t.length;)this.tokens.push(t.shift());else this.tokens.push(o)}};var qr=-1;function jn(o,t){if(o)throw TypeError("Decoder error");return t||65533}var En="utf-8";function kn(o,t){if(!(this instanceof kn))return new kn(o,t);if(o=o!==void 0?String(o).toLowerCase():En,o!==En)throw new Error("Encoding not supported. Only utf-8 is supported");t=On(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!t.fatal,this._ignoreBOM=!!t.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}kn.prototype={decode:function(t,e){var r;typeof t=="object"&&t instanceof ArrayBuffer?r=new Uint8Array(t):typeof t=="object"&&"buffer"in t&&t.buffer instanceof ArrayBuffer?r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):r=new Uint8Array(0),e=On(e),this._streaming||(this._decoder=new Ic({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!e.stream;for(var c=new Ei(r),i=[],h;!c.endOfStream()&&(h=this._decoder.handler(c,c.read()),h!==qr);)h!==null&&(Array.isArray(h)?i.push.apply(i,h):i.push(h));if(!this._streaming){do{if(h=this._decoder.handler(c,c.read()),h===qr)break;h!==null&&(Array.isArray(h)?i.push.apply(i,h):i.push(h))}while(!c.endOfStream());this._decoder=null}return i.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(i[0]===65279?(this._BOMseen=!0,i.shift()):this._BOMseen=!0),Ac(i)}};function Bn(o,t){if(!(this instanceof Bn))return new Bn(o,t);if(o=o!==void 0?String(o).toLowerCase():En,o!==En)throw new Error("Encoding not supported. Only utf-8 is supported");t=On(t),this._streaming=!1,this._encoder=null,this._options={fatal:!!t.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}Bn.prototype={encode:function(t,e){t=t?String(t):"",e=On(e),this._streaming||(this._encoder=new Rc(this._options)),this._streaming=!!e.stream;for(var r=[],c=new Ei(Bc(t)),i;!c.endOfStream()&&(i=this._encoder.handler(c,c.read()),i!==qr);)Array.isArray(i)?r.push.apply(r,i):r.push(i);if(!this._streaming){for(;i=this._encoder.handler(c,c.read()),i!==qr;)Array.isArray(i)?r.push.apply(r,i):r.push(i);this._encoder=null}return new Uint8Array(r)}};function Ic(o){var t=o.fatal,e=0,r=0,c=0,i=128,h=191;this.handler=function(w,y){if(y===Sn&&c!==0)return c=0,jn(t);if(y===Sn)return qr;if(c===0){if(Pe(y,0,127))return y;if(Pe(y,194,223))c=1,e=y-192;else if(Pe(y,224,239))y===224&&(i=160),y===237&&(h=159),c=2,e=y-224;else if(Pe(y,240,244))y===240&&(i=144),y===244&&(h=143),c=3,e=y-240;else return jn(t);return e=e<<6*c,null}if(!Pe(y,i,h))return e=c=r=0,i=128,h=191,w.prepend(y),jn(t);if(i=128,h=191,r+=1,e+=y-128<<6*(c-r),r!==c)return null;var b=e;return e=c=r=0,b}}function Rc(o){o.fatal,this.handler=function(t,e){if(e===Sn)return qr;if(Pe(e,0,127))return e;var r,c;Pe(e,128,2047)?(r=1,c=192):Pe(e,2048,65535)?(r=2,c=224):Pe(e,65536,1114111)&&(r=3,c=240);for(var i=[(e>>6*r)+c];r>0;){var h=e>>6*(r-1);i.push(128|h&63),r-=1}return i}}const Tc=Object.freeze(Object.defineProperty({__proto__:null,TextDecoder:kn,TextEncoder:Bn},Symbol.toStringTag,{value:"Module"})),Lc=Ve(Tc);var Cc=Me&&Me.__createBinding||(Object.create?function(o,t,e,r){r===void 0&&(r=e),Object.defineProperty(o,r,{enumerable:!0,get:function(){return t[e]}})}:function(o,t,e,r){r===void 0&&(r=e),o[r]=t[e]}),Pc=Me&&Me.__setModuleDefault||(Object.create?function(o,t){Object.defineProperty(o,"default",{enumerable:!0,value:t})}:function(o,t){o.default=t}),Re=Me&&Me.__decorate||function(o,t,e,r){var c=arguments.length,i=c<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,e):r,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(o,t,e,r);else for(var w=o.length-1;w>=0;w--)(h=o[w])&&(i=(c<3?h(i):c>3?h(t,e,i):h(t,e))||i);return c>3&&i&&Object.defineProperty(t,e,i),i},Oc=Me&&Me.__importStar||function(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var e in o)e!=="default"&&Object.hasOwnProperty.call(o,e)&&Cc(t,o,e);return Pc(t,o),t},Zs=Me&&Me.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(ue,"__esModule",{value:!0});var Vs=ue.deserializeUnchecked=eo=ue.deserialize=to=ue.serialize=ue.BinaryReader=ue.BinaryWriter=ue.BorshError=ue.baseDecode=ue.baseEncode=void 0;const je=Zs(kc),Ys=Zs(Gs),Nc=Oc(Lc),qc=typeof TextDecoder!="function"?Nc.TextDecoder:TextDecoder,Uc=new qc("utf-8",{fatal:!0});function Fc(o){return typeof o=="string"&&(o=Buffer.from(o,"utf8")),Ys.default.encode(Buffer.from(o))}ue.baseEncode=Fc;function Kc(o){return Buffer.from(Ys.default.decode(o))}ue.baseDecode=Kc;const Gn=1024;class he extends Error{constructor(t){super(t),this.fieldPath=[],this.originalMessage=t}addToFieldPath(t){this.fieldPath.splice(0,0,t),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}ue.BorshError=he;class Js{constructor(){this.buf=Buffer.alloc(Gn),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=Buffer.concat([this.buf,Buffer.alloc(Gn)]))}writeU8(t){this.maybeResize(),this.buf.writeUInt8(t,this.length),this.length+=1}writeU16(t){this.maybeResize(),this.buf.writeUInt16LE(t,this.length),this.length+=2}writeU32(t){this.maybeResize(),this.buf.writeUInt32LE(t,this.length),this.length+=4}writeU64(t){this.maybeResize(),this.writeBuffer(Buffer.from(new je.default(t).toArray("le",8)))}writeU128(t){this.maybeResize(),this.writeBuffer(Buffer.from(new je.default(t).toArray("le",16)))}writeU256(t){this.maybeResize(),this.writeBuffer(Buffer.from(new je.default(t).toArray("le",32)))}writeU512(t){this.maybeResize(),this.writeBuffer(Buffer.from(new je.default(t).toArray("le",64)))}writeBuffer(t){this.buf=Buffer.concat([Buffer.from(this.buf.subarray(0,this.length)),t,Buffer.alloc(Gn)]),this.length+=t.length}writeString(t){this.maybeResize();const e=Buffer.from(t,"utf8");this.writeU32(e.length),this.writeBuffer(e)}writeFixedArray(t){this.writeBuffer(Buffer.from(t))}writeArray(t,e){this.maybeResize(),this.writeU32(t.length);for(const r of t)this.maybeResize(),e(r)}toArray(){return this.buf.subarray(0,this.length)}}ue.BinaryWriter=Js;function Te(o,t,e){const r=e.value;e.value=function(...c){try{return r.apply(this,c)}catch(i){if(i instanceof RangeError){const h=i.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(h)>=0)throw new he("Reached the end of buffer when deserializing")}throw i}}}class me{constructor(t){this.buf=t,this.offset=0}readU8(){const t=this.buf.readUInt8(this.offset);return this.offset+=1,t}readU16(){const t=this.buf.readUInt16LE(this.offset);return this.offset+=2,t}readU32(){const t=this.buf.readUInt32LE(this.offset);return this.offset+=4,t}readU64(){const t=this.readBuffer(8);return new je.default(t,"le")}readU128(){const t=this.readBuffer(16);return new je.default(t,"le")}readU256(){const t=this.readBuffer(32);return new je.default(t,"le")}readU512(){const t=this.readBuffer(64);return new je.default(t,"le")}readBuffer(t){if(this.offset+t>this.buf.length)throw new he(`Expected buffer length ${t} isn't within bounds`);const e=this.buf.slice(this.offset,this.offset+t);return this.offset+=t,e}readString(){const t=this.readU32(),e=this.readBuffer(t);try{return Uc.decode(e)}catch(r){throw new he(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(t){return new Uint8Array(this.readBuffer(t))}readArray(t){const e=this.readU32(),r=Array();for(let c=0;c<e;++c)r.push(t());return r}}Re([Te],me.prototype,"readU8",null);Re([Te],me.prototype,"readU16",null);Re([Te],me.prototype,"readU32",null);Re([Te],me.prototype,"readU64",null);Re([Te],me.prototype,"readU128",null);Re([Te],me.prototype,"readU256",null);Re([Te],me.prototype,"readU512",null);Re([Te],me.prototype,"readString",null);Re([Te],me.prototype,"readFixedArray",null);Re([Te],me.prototype,"readArray",null);ue.BinaryReader=me;function Xs(o){return o.charAt(0).toUpperCase()+o.slice(1)}function yr(o,t,e,r,c){try{if(typeof r=="string")c[`write${Xs(r)}`](e);else if(r instanceof Array)if(typeof r[0]=="number"){if(e.length!==r[0])throw new he(`Expecting byte array of length ${r[0]}, but got ${e.length} bytes`);c.writeFixedArray(e)}else if(r.length===2&&typeof r[1]=="number"){if(e.length!==r[1])throw new he(`Expecting byte array of length ${r[1]}, but got ${e.length} bytes`);for(let i=0;i<r[1];i++)yr(o,null,e[i],r[0],c)}else c.writeArray(e,i=>{yr(o,t,i,r[0],c)});else if(r.kind!==void 0)switch(r.kind){case"option":{e==null?c.writeU8(0):(c.writeU8(1),yr(o,t,e,r.type,c));break}case"map":{c.writeU32(e.size),e.forEach((i,h)=>{yr(o,t,h,r.key,c),yr(o,t,i,r.value,c)});break}default:throw new he(`FieldType ${r} unrecognized`)}else Qs(o,e,c)}catch(i){throw i instanceof he&&i.addToFieldPath(t),i}}function Qs(o,t,e){if(typeof t.borshSerialize=="function"){t.borshSerialize(e);return}const r=o.get(t.constructor);if(!r)throw new he(`Class ${t.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([c,i])=>{yr(o,c,t[c],i,e)});else if(r.kind==="enum"){const c=t[r.field];for(let i=0;i<r.values.length;++i){const[h,w]=r.values[i];if(h===c){e.writeU8(i),yr(o,h,t[h],w,e);break}}}else throw new he(`Unexpected schema kind: ${r.kind} for ${t.constructor.name}`)}function zc(o,t,e=Js){const r=new e;return Qs(o,t,r),r.toArray()}var to=ue.serialize=zc;function vr(o,t,e,r){try{if(typeof e=="string")return r[`read${Xs(e)}`]();if(e instanceof Array){if(typeof e[0]=="number")return r.readFixedArray(e[0]);if(typeof e[1]=="number"){const c=[];for(let i=0;i<e[1];i++)c.push(vr(o,null,e[0],r));return c}else return r.readArray(()=>vr(o,t,e[0],r))}if(e.kind==="option")return r.readU8()?vr(o,t,e.type,r):void 0;if(e.kind==="map"){let c=new Map;const i=r.readU32();for(let h=0;h<i;h++){const w=vr(o,t,e.key,r),y=vr(o,t,e.value,r);c.set(w,y)}return c}return ki(o,e,r)}catch(c){throw c instanceof he&&c.addToFieldPath(t),c}}function ki(o,t,e){if(typeof t.borshDeserialize=="function")return t.borshDeserialize(e);const r=o.get(t);if(!r)throw new he(`Class ${t.name} is missing in schema`);if(r.kind==="struct"){const c={};for(const[i,h]of o.get(t).fields)c[i]=vr(o,i,h,e);return new t(c)}if(r.kind==="enum"){const c=e.readU8();if(c>=r.values.length)throw new he(`Enum index: ${c} is out of range`);const[i,h]=r.values[c],w=vr(o,i,h,e);return new t({[i]:w})}throw new he(`Unexpected schema kind: ${r.kind} for ${t.constructor.name}`)}function Dc(o,t,e,r=me){const c=new r(e),i=ki(o,t,c);if(c.offset<e.length)throw new he(`Unexpected ${e.length-c.offset} bytes after deserialized data`);return i}var eo=ue.deserialize=Dc;function Hc(o,t,e,r=me){const c=new r(e);return ki(o,t,c)}Vs=ue.deserializeUnchecked=Hc;var R={};Object.defineProperty(R,"__esModule",{value:!0});R.s16=R.s8=R.nu64be=R.u48be=R.u40be=R.u32be=R.u24be=R.u16be=ce=R.nu64=R.u48=R.u40=nt=R.u32=R.u24=ye=R.u16=jt=R.u8=Mr=R.offset=R.greedy=R.Constant=R.UTF8=R.CString=R.Blob=R.Boolean=R.BitField=R.BitStructure=R.VariantLayout=R.Union=R.UnionLayoutDiscriminator=R.UnionDiscriminator=R.Structure=R.Sequence=R.DoubleBE=R.Double=R.FloatBE=R.Float=R.NearInt64BE=R.NearInt64=R.NearUInt64BE=R.NearUInt64=R.IntBE=R.Int=R.UIntBE=R.UInt=R.OffsetLayout=R.GreedyCount=R.ExternalLayout=R.bindConstructorLayout=R.nameWithProperty=R.Layout=R.uint8ArrayToBuffer=R.checkUint8Array=void 0;R.constant=R.utf8=R.cstr=re=R.blob=R.unionLayoutDiscriminator=R.union=fe=R.seq=R.bits=Q=R.struct=R.f64be=R.f64=R.f32be=R.f32=R.ns64be=R.s48be=R.s40be=R.s32be=R.s24be=R.s16be=ge=R.ns64=R.s48=R.s40=R.s32=R.s24=void 0;const Bi=Dt;function Hr(o){if(!(o instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}R.checkUint8Array=Hr;function Wt(o){return Hr(o),Bi.Buffer.from(o.buffer,o.byteOffset,o.length)}R.uint8ArrayToBuffer=Wt;class Gt{constructor(t,e){if(!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=e}makeDestinationObject(){return{}}getSpan(t,e){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(t){const e=Object.create(this.constructor.prototype);return Object.assign(e,this),e.property=t,e}fromArray(t){}}R.Layout=Gt;function Ai(o,t){return t.property?o+"["+t.property+"]":o}R.nameWithProperty=Ai;function $c(o,t){if(typeof o!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(o,"layout_"))throw new Error("Class is already bound to a layout");if(!(t&&t instanceof Gt))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(t,"boundConstructor_"))throw new Error("layout is already bound to a constructor");o.layout_=t,t.boundConstructor_=o,t.makeDestinationObject=()=>new o,Object.defineProperty(o.prototype,"encode",{value(e,r){return t.encode(this,e,r)},writable:!0}),Object.defineProperty(o,"decode",{value(e,r){return t.decode(e,r)},writable:!0})}R.bindConstructorLayout=$c;class le extends Gt{isCount(){throw new Error("ExternalLayout is abstract")}}R.ExternalLayout=le;class ro extends le{constructor(t=1,e){if(!Number.isInteger(t)||0>=t)throw new TypeError("elementSpan must be a (positive) integer");super(-1,e),this.elementSpan=t}isCount(){return!0}decode(t,e=0){Hr(t);const r=t.length-e;return Math.floor(r/this.elementSpan)}encode(t,e,r){return 0}}R.GreedyCount=ro;class Ii extends le{constructor(t,e=0,r){if(!(t instanceof Gt))throw new TypeError("layout must be a Layout");if(!Number.isInteger(e))throw new TypeError("offset must be integer or undefined");super(t.span,r||t.property),this.layout=t,this.offset=e}isCount(){return this.layout instanceof xe||this.layout instanceof Ee}decode(t,e=0){return this.layout.decode(t,e+this.offset)}encode(t,e,r=0){return this.layout.encode(t,e,r+this.offset)}}R.OffsetLayout=Ii;class xe extends Gt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readUIntLE(e,this.span)}encode(t,e,r=0){return Wt(e).writeUIntLE(t,r,this.span),this.span}}R.UInt=xe;class Ee extends Gt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readUIntBE(e,this.span)}encode(t,e,r=0){return Wt(e).writeUIntBE(t,r,this.span),this.span}}R.UIntBE=Ee;class Er extends Gt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readIntLE(e,this.span)}encode(t,e,r=0){return Wt(e).writeIntLE(t,r,this.span),this.span}}R.Int=Er;class $r extends Gt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readIntBE(e,this.span)}encode(t,e,r=0){return Wt(e).writeIntBE(t,r,this.span),this.span}}R.IntBE=$r;const ni=Math.pow(2,32);function Nn(o){const t=Math.floor(o/ni),e=o-t*ni;return{hi32:t,lo32:e}}function qn(o,t){return o*ni+t}class no extends Gt{constructor(t){super(8,t)}decode(t,e=0){const r=Wt(t),c=r.readUInt32LE(e),i=r.readUInt32LE(e+4);return qn(i,c)}encode(t,e,r=0){const c=Nn(t),i=Wt(e);return i.writeUInt32LE(c.lo32,r),i.writeUInt32LE(c.hi32,r+4),8}}R.NearUInt64=no;class io extends Gt{constructor(t){super(8,t)}decode(t,e=0){const r=Wt(t),c=r.readUInt32BE(e),i=r.readUInt32BE(e+4);return qn(c,i)}encode(t,e,r=0){const c=Nn(t),i=Wt(e);return i.writeUInt32BE(c.hi32,r),i.writeUInt32BE(c.lo32,r+4),8}}R.NearUInt64BE=io;class so extends Gt{constructor(t){super(8,t)}decode(t,e=0){const r=Wt(t),c=r.readUInt32LE(e),i=r.readInt32LE(e+4);return qn(i,c)}encode(t,e,r=0){const c=Nn(t),i=Wt(e);return i.writeUInt32LE(c.lo32,r),i.writeInt32LE(c.hi32,r+4),8}}R.NearInt64=so;class oo extends Gt{constructor(t){super(8,t)}decode(t,e=0){const r=Wt(t),c=r.readInt32BE(e),i=r.readUInt32BE(e+4);return qn(c,i)}encode(t,e,r=0){const c=Nn(t),i=Wt(e);return i.writeInt32BE(c.hi32,r),i.writeUInt32BE(c.lo32,r+4),8}}R.NearInt64BE=oo;class ao extends Gt{constructor(t){super(4,t)}decode(t,e=0){return Wt(t).readFloatLE(e)}encode(t,e,r=0){return Wt(e).writeFloatLE(t,r),4}}R.Float=ao;class co extends Gt{constructor(t){super(4,t)}decode(t,e=0){return Wt(t).readFloatBE(e)}encode(t,e,r=0){return Wt(e).writeFloatBE(t,r),4}}R.FloatBE=co;class uo extends Gt{constructor(t){super(8,t)}decode(t,e=0){return Wt(t).readDoubleLE(e)}encode(t,e,r=0){return Wt(e).writeDoubleLE(t,r),8}}R.Double=uo;class ho extends Gt{constructor(t){super(8,t)}decode(t,e=0){return Wt(t).readDoubleBE(e)}encode(t,e,r=0){return Wt(e).writeDoubleBE(t,r),8}}R.DoubleBE=ho;class fo extends Gt{constructor(t,e,r){if(!(t instanceof Gt))throw new TypeError("elementLayout must be a Layout");if(!(e instanceof le&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let c=-1;!(e instanceof le)&&0<t.span&&(c=e*t.span),super(c,r),this.elementLayout=t,this.count=e}getSpan(t,e=0){if(0<=this.span)return this.span;let r=0,c=this.count;if(c instanceof le&&(c=c.decode(t,e)),0<this.elementLayout.span)r=c*this.elementLayout.span;else{let i=0;for(;i<c;)r+=this.elementLayout.getSpan(t,e+r),++i}return r}decode(t,e=0){const r=[];let c=0,i=this.count;for(i instanceof le&&(i=i.decode(t,e));c<i;)r.push(this.elementLayout.decode(t,e)),e+=this.elementLayout.getSpan(t,e),c+=1;return r}encode(t,e,r=0){const c=this.elementLayout,i=t.reduce((h,w)=>h+c.encode(w,e,r+h),0);return this.count instanceof le&&this.count.encode(t.length,e,r),i}}R.Sequence=fo;class lo extends Gt{constructor(t,e,r){if(!(Array.isArray(t)&&t.reduce((i,h)=>i&&h instanceof Gt,!0)))throw new TypeError("fields must be array of Layout instances");typeof e=="boolean"&&r===void 0&&(r=e,e=void 0);for(const i of t)if(0>i.span&&i.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let c=-1;try{c=t.reduce((i,h)=>i+h.getSpan(),0)}catch{}super(c,e),this.fields=t,this.decodePrefixes=!!r}getSpan(t,e=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce((c,i)=>{const h=i.getSpan(t,e);return e+=h,c+h},0)}catch{throw new RangeError("indeterminate span")}return r}decode(t,e=0){Hr(t);const r=this.makeDestinationObject();for(const c of this.fields)if(c.property!==void 0&&(r[c.property]=c.decode(t,e)),e+=c.getSpan(t,e),this.decodePrefixes&&t.length===e)break;return r}encode(t,e,r=0){const c=r;let i=0,h=0;for(const w of this.fields){let y=w.span;if(h=0<y?y:0,w.property!==void 0){const b=t[w.property];b!==void 0&&(h=w.encode(b,e,r),0>y&&(y=w.getSpan(e,r)))}i=r,r+=y}return i+h-c}fromArray(t){const e=this.makeDestinationObject();for(const r of this.fields)r.property!==void 0&&0<t.length&&(e[r.property]=t.shift());return e}layoutFor(t){if(typeof t!="string")throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}offsetOf(t){if(typeof t!="string")throw new TypeError("property must be string");let e=0;for(const r of this.fields){if(r.property===t)return e;0>r.span?e=-1:0<=e&&(e+=r.span)}}}R.Structure=lo;class Ri{constructor(t){this.property=t}decode(t,e){throw new Error("UnionDiscriminator is abstract")}encode(t,e,r){throw new Error("UnionDiscriminator is abstract")}}R.UnionDiscriminator=Ri;class An extends Ri{constructor(t,e){if(!(t instanceof le&&t.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(e||t.property||"variant"),this.layout=t}decode(t,e){return this.layout.decode(t,e)}encode(t,e,r){return this.layout.encode(t,e,r)}}R.UnionLayoutDiscriminator=An;class Ti extends Gt{constructor(t,e,r){let c;if(t instanceof xe||t instanceof Ee)c=new An(new Ii(t));else if(t instanceof le&&t.isCount())c=new An(t);else if(t instanceof Ri)c=t;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(e===void 0&&(e=null),!(e===null||e instanceof Gt))throw new TypeError("defaultLayout must be null or a Layout");if(e!==null){if(0>e.span)throw new Error("defaultLayout must have constant span");e.property===void 0&&(e=e.replicate("content"))}let i=-1;e&&(i=e.span,0<=i&&(t instanceof xe||t instanceof Ee)&&(i+=c.layout.span)),super(i,r),this.discriminator=c,this.usesPrefixDiscriminator=t instanceof xe||t instanceof Ee,this.defaultLayout=e,this.registry={};let h=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(w){return h(w)},this.configGetSourceVariant=function(w){h=w.bind(this)}}getSpan(t,e=0){if(0<=this.span)return this.span;const r=this.getVariant(t,e);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(t,e)}defaultGetSourceVariant(t){if(Object.prototype.hasOwnProperty.call(t,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(t,this.defaultLayout.property))return;const e=this.registry[t[this.discriminator.property]];if(e&&(!e.layout||e.property&&Object.prototype.hasOwnProperty.call(t,e.property)))return e}else for(const e in this.registry){const r=this.registry[e];if(r.property&&Object.prototype.hasOwnProperty.call(t,r.property))return r}throw new Error("unable to infer src variant")}decode(t,e=0){let r;const c=this.discriminator,i=c.decode(t,e),h=this.registry[i];if(h===void 0){const w=this.defaultLayout;let y=0;this.usesPrefixDiscriminator&&(y=c.layout.span),r=this.makeDestinationObject(),r[c.property]=i,r[w.property]=w.decode(t,e+y)}else r=h.decode(t,e);return r}encode(t,e,r=0){const c=this.getSourceVariant(t);if(c===void 0){const i=this.discriminator,h=this.defaultLayout;let w=0;return this.usesPrefixDiscriminator&&(w=i.layout.span),i.encode(t[i.property],e,r),w+h.encode(t[h.property],e,r+w)}return c.encode(t,e,r)}addVariant(t,e,r){const c=new po(this,t,e,r);return this.registry[t]=c,c}getVariant(t,e=0){let r;return t instanceof Uint8Array?r=this.discriminator.decode(t,e):r=t,this.registry[r]}}R.Union=Ti;class po extends Gt{constructor(t,e,r,c){if(!(t instanceof Ti))throw new TypeError("union must be a Union");if(!Number.isInteger(e)||0>e)throw new TypeError("variant must be a (non-negative) integer");if(typeof r=="string"&&c===void 0&&(c=r,r=null),r){if(!(r instanceof Gt))throw new TypeError("layout must be a Layout");if(t.defaultLayout!==null&&0<=r.span&&r.span>t.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof c!="string")throw new TypeError("variant must have a String property")}let i=t.span;0>t.span&&(i=r?r.span:0,0<=i&&t.usesPrefixDiscriminator&&(i+=t.discriminator.layout.span)),super(i,c),this.union=t,this.variant=e,this.layout=r||null}getSpan(t,e=0){if(0<=this.span)return this.span;let r=0;this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span);let c=0;return this.layout&&(c=this.layout.getSpan(t,e+r)),r+c}decode(t,e=0){const r=this.makeDestinationObject();if(this!==this.union.getVariant(t,e))throw new Error("variant mismatch");let c=0;return this.union.usesPrefixDiscriminator&&(c=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(t,e+c):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(t,e,r=0){let c=0;if(this.union.usesPrefixDiscriminator&&(c=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(t,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,e,r);let i=c;if(this.layout&&(this.layout.encode(t[this.property],e,r+c),i+=this.layout.getSpan(e,r+c),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}fromArray(t){if(this.layout)return this.layout.fromArray(t)}}R.VariantLayout=po;function Rr(o){return 0>o&&(o+=4294967296),o}class Li extends Gt{constructor(t,e,r){if(!(t instanceof xe||t instanceof Ee))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof e=="string"&&r===void 0&&(r=e,e=!1),4<t.span)throw new RangeError("word cannot exceed 32 bits");super(t.span,r),this.word=t,this.msb=!!e,this.fields=[];let c=0;this._packedSetValue=function(i){return c=Rr(i),this},this._packedGetValue=function(){return c}}decode(t,e=0){const r=this.makeDestinationObject(),c=this.word.decode(t,e);this._packedSetValue(c);for(const i of this.fields)i.property!==void 0&&(r[i.property]=i.decode(t));return r}encode(t,e,r=0){const c=this.word.decode(e,r);this._packedSetValue(c);for(const i of this.fields)if(i.property!==void 0){const h=t[i.property];h!==void 0&&i.encode(h)}return this.word.encode(this._packedGetValue(),e,r)}addField(t,e){const r=new Ci(this,t,e);return this.fields.push(r),r}addBoolean(t){const e=new go(this,t);return this.fields.push(e),e}fieldFor(t){if(typeof t!="string")throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}}R.BitStructure=Li;class Ci{constructor(t,e,r){if(!(t instanceof Li))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(e)||0>=e)throw new TypeError("bits must be positive integer");const c=8*t.span,i=t.fields.reduce((h,w)=>h+w.bits,0);if(e+i>c)throw new Error("bits too long for span remainder ("+(c-i)+" of "+c+" remain)");this.container=t,this.bits=e,this.valueMask=(1<<e)-1,e===32&&(this.valueMask=4294967295),this.start=i,this.container.msb&&(this.start=c-i-e),this.wordMask=Rr(this.valueMask<<this.start),this.property=r}decode(t,e){const r=this.container._packedGetValue();return Rr(r&this.wordMask)>>>this.start}encode(t){if(typeof t!="number"||!Number.isInteger(t)||t!==Rr(t&this.valueMask))throw new TypeError(Ai("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const e=this.container._packedGetValue(),r=Rr(t<<this.start);this.container._packedSetValue(Rr(e&~this.wordMask)|r)}}R.BitField=Ci;let go=class extends Ci{constructor(t,e){super(t,1,e)}decode(t,e){return!!super.decode(t,e)}encode(t){typeof t=="boolean"&&(t=+t),super.encode(t)}};R.Boolean=go;class mo extends Gt{constructor(t,e){if(!(t instanceof le&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;t instanceof le||(r=t),super(r,e),this.length=t}getSpan(t,e){let r=this.span;return 0>r&&(r=this.length.decode(t,e)),r}decode(t,e=0){let r=this.span;return 0>r&&(r=this.length.decode(t,e)),Wt(t).slice(e,e+r)}encode(t,e,r){let c=this.length;if(this.length instanceof le&&(c=t.length),!(t instanceof Uint8Array&&c===t.length))throw new TypeError(Ai("Blob.encode",this)+" requires (length "+c+") Uint8Array as src");if(r+c>e.length)throw new RangeError("encoding overruns Uint8Array");const i=Wt(t);return Wt(e).write(i.toString("hex"),r,c,"hex"),this.length instanceof le&&this.length.encode(c,e,r),c}}R.Blob=mo;class wo extends Gt{constructor(t){super(-1,t)}getSpan(t,e=0){Hr(t);let r=e;for(;r<t.length&&t[r]!==0;)r+=1;return 1+r-e}decode(t,e=0){const r=this.getSpan(t,e);return Wt(t).slice(e,e+r-1).toString("utf-8")}encode(t,e,r=0){typeof t!="string"&&(t=String(t));const c=Bi.Buffer.from(t,"utf8"),i=c.length;if(r+i>e.length)throw new RangeError("encoding overruns Buffer");const h=Wt(e);return c.copy(h,r),h[r+i]=0,i+1}}R.CString=wo;class yo extends Gt{constructor(t,e){if(typeof t=="string"&&e===void 0&&(e=t,t=void 0),t===void 0)t=-1;else if(!Number.isInteger(t))throw new TypeError("maxSpan must be an integer");super(-1,e),this.maxSpan=t}getSpan(t,e=0){return Hr(t),t.length-e}decode(t,e=0){const r=this.getSpan(t,e);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return Wt(t).slice(e,e+r).toString("utf-8")}encode(t,e,r=0){typeof t!="string"&&(t=String(t));const c=Bi.Buffer.from(t,"utf8"),i=c.length;if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");if(r+i>e.length)throw new RangeError("encoding overruns Buffer");return c.copy(Wt(e),r),i}}R.UTF8=yo;class vo extends Gt{constructor(t,e){super(0,e),this.value=t}decode(t,e){return this.value}encode(t,e,r){return 0}}R.Constant=vo;R.greedy=(o,t)=>new ro(o,t);var Mr=R.offset=(o,t,e)=>new Ii(o,t,e),jt=R.u8=o=>new xe(1,o),ye=R.u16=o=>new xe(2,o);R.u24=o=>new xe(3,o);var nt=R.u32=o=>new xe(4,o);R.u40=o=>new xe(5,o);R.u48=o=>new xe(6,o);var ce=R.nu64=o=>new no(o);R.u16be=o=>new Ee(2,o);R.u24be=o=>new Ee(3,o);R.u32be=o=>new Ee(4,o);R.u40be=o=>new Ee(5,o);R.u48be=o=>new Ee(6,o);R.nu64be=o=>new io(o);R.s8=o=>new Er(1,o);R.s16=o=>new Er(2,o);R.s24=o=>new Er(3,o);R.s32=o=>new Er(4,o);R.s40=o=>new Er(5,o);R.s48=o=>new Er(6,o);var ge=R.ns64=o=>new so(o);R.s16be=o=>new $r(2,o);R.s24be=o=>new $r(3,o);R.s32be=o=>new $r(4,o);R.s40be=o=>new $r(5,o);R.s48be=o=>new $r(6,o);R.ns64be=o=>new oo(o);R.f32=o=>new ao(o);R.f32be=o=>new co(o);R.f64=o=>new uo(o);R.f64be=o=>new ho(o);var Q=R.struct=(o,t,e)=>new lo(o,t,e);R.bits=(o,t,e)=>new Li(o,t,e);var fe=R.seq=(o,t,e)=>new fo(o,t,e);R.union=(o,t,e)=>new Ti(o,t,e);R.unionLayoutDiscriminator=(o,t)=>new An(o,t);var re=R.blob=(o,t)=>new mo(o,t);R.cstr=o=>new wo(o);R.utf8=(o,t)=>new yo(o,t);R.constant=(o,t)=>new vo(o,t);var ln={};Object.defineProperty(ln,"__esModule",{value:!0});function Wc(o){{const t=Buffer.from(o);t.reverse();const e=t.toString("hex");return e.length===0?BigInt(0):BigInt(`0x${e}`)}}var jc=ln.toBigIntLE=Wc;function Gc(o){{const t=o.toString("hex");return t.length===0?BigInt(0):BigInt(`0x${t}`)}}ln.toBigIntBE=Gc;function Zc(o,t){{const e=o.toString(16),r=Buffer.from(e.padStart(t*2,"0").slice(0,t*2),"hex");return r.reverse(),r}}var Vc=ln.toBufferLE=Zc;function Yc(o,t){{const e=o.toString(16);return Buffer.from(e.padStart(t*2,"0").slice(0,t*2),"hex")}}ln.toBufferBE=Yc;class Jc extends TypeError{constructor(t,e){let r;const{message:c,...i}=t,{path:h}=t,w=h.length===0?c:"At path: "+h.join(".")+" -- "+c;super(w),Object.assign(this,i),this.name=this.constructor.name,this.failures=()=>{var y;return(y=r)!=null?y:r=[t,...e()]}}}function Xc(o){return Ge(o)&&typeof o[Symbol.iterator]=="function"}function Ge(o){return typeof o=="object"&&o!=null}function ke(o){return typeof o=="string"?JSON.stringify(o):""+o}function Qc(o){const{done:t,value:e}=o.next();return t?void 0:e}function tu(o,t,e,r){if(o===!0)return;o===!1?o={}:typeof o=="string"&&(o={message:o});const{path:c,branch:i}=t,{type:h}=e,{refinement:w,message:y="Expected a value of type `"+h+"`"+(w?" with refinement `"+w+"`":"")+", but received: `"+ke(r)+"`"}=o;return{value:r,type:h,refinement:w,key:c[c.length-1],path:c,branch:i,...o,message:y}}function*ns(o,t,e,r){Xc(o)||(o=[o]);for(const c of o){const i=tu(c,t,e,r);i&&(yield i)}}function*Pi(o,t,e={}){const{path:r=[],branch:c=[o],coerce:i=!1,mask:h=!1}=e,w={path:r,branch:c};if(i&&(o=t.coercer(o,w),h&&t.type!=="type"&&Ge(t.schema)&&Ge(o)&&!Array.isArray(o)))for(const b in o)t.schema[b]===void 0&&delete o[b];let y=!0;for(const b of t.validator(o,w))y=!1,yield[b,void 0];for(let[b,x,_]of t.entries(o,w)){const L=Pi(x,_,{path:b===void 0?r:[...r,b],branch:b===void 0?c:[...c,x],coerce:i,mask:h});for(const k of L)k[0]?(y=!1,yield[k[0],void 0]):i&&(x=k[1],b===void 0?o=x:o instanceof Map?o.set(b,x):o instanceof Set?o.add(x):Ge(o)&&(o[b]=x))}if(y)for(const b of t.refiner(o,w))y=!1,yield[b,void 0];y&&(yield[void 0,o])}let Le=class{constructor(t){const{type:e,schema:r,validator:c,refiner:i,coercer:h=y=>y,entries:w=function*(){}}=t;this.type=e,this.schema=r,this.entries=w,this.coercer=h,c?this.validator=(y,b)=>{const x=c(y,b);return ns(x,b,this,y)}:this.validator=()=>[],i?this.refiner=(y,b)=>{const x=i(y,b);return ns(x,b,this,y)}:this.refiner=()=>[]}assert(t){return eu(t,this)}create(t){return $(t,this)}is(t){return bo(t,this)}mask(t){return ru(t,this)}validate(t,e={}){return dn(t,this,e)}};function eu(o,t){const e=dn(o,t);if(e[0])throw e[0]}function $(o,t){const e=dn(o,t,{coerce:!0});if(e[0])throw e[0];return e[1]}function ru(o,t){const e=dn(o,t,{coerce:!0,mask:!0});if(e[0])throw e[0];return e[1]}function bo(o,t){return!dn(o,t)[0]}function dn(o,t,e={}){const r=Pi(o,t,e),c=Qc(r);return c[0]?[new Jc(c[0],function*(){for(const h of r)h[0]&&(yield h[0])}),void 0]:[void 0,c[1]]}function kr(o,t){return new Le({type:o,schema:null,validator:t})}function nu(){return kr("any",()=>!0)}function G(o){return new Le({type:"array",schema:o,*entries(t){if(o&&Array.isArray(t))for(const[e,r]of t.entries())yield[e,r,o]},coercer(t){return Array.isArray(t)?t.slice():t},validator(t){return Array.isArray(t)||"Expected an array value, but received: "+ke(t)}})}function Ie(){return kr("boolean",o=>typeof o=="boolean")}function Oi(o){return kr("instance",t=>t instanceof o||"Expected a `"+o.name+"` instance, but received: "+ke(t))}function Qt(o){const t=ke(o),e=typeof o;return new Le({type:"literal",schema:e==="string"||e==="number"||e==="boolean"?o:null,validator(r){return r===o||"Expected the literal `"+t+"`, but received: "+ke(r)}})}function iu(){return kr("never",()=>!1)}function W(o){return new Le({...o,validator:(t,e)=>t===null||o.validator(t,e),refiner:(t,e)=>t===null||o.refiner(t,e)})}function A(){return kr("number",o=>typeof o=="number"&&!isNaN(o)||"Expected a number, but received: "+ke(o))}function ot(o){return new Le({...o,validator:(t,e)=>t===void 0||o.validator(t,e),refiner:(t,e)=>t===void 0||o.refiner(t,e)})}function xo(o,t){return new Le({type:"record",schema:null,*entries(e){if(Ge(e))for(const r in e){const c=e[r];yield[r,r,o],yield[r,c,t]}},validator(e){return Ge(e)||"Expected an object, but received: "+ke(e)}})}function H(){return kr("string",o=>typeof o=="string"||"Expected a string, but received: "+ke(o))}function Ni(o){const t=iu();return new Le({type:"tuple",schema:null,*entries(e){if(Array.isArray(e)){const r=Math.max(o.length,e.length);for(let c=0;c<r;c++)yield[c,e[c],o[c]||t]}},validator(e){return Array.isArray(e)||"Expected an array, but received: "+ke(e)}})}function z(o){const t=Object.keys(o);return new Le({type:"type",schema:o,*entries(e){if(Ge(e))for(const r of t)yield[r,e[r],o[r]]},validator(e){return Ge(e)||"Expected an object, but received: "+ke(e)}})}function de(o){const t=o.map(e=>e.type).join(" | ");return new Le({type:"union",schema:null,validator(e,r){const c=[];for(const i of o){const[...h]=Pi(e,i,r),[w]=h;if(w[0])for(const[y]of h)y&&c.push(y);else return[]}return["Expected the value to satisfy a union of `"+t+"`, but received: "+ke(e),...c]}})}function pn(){return kr("unknown",()=>!0)}function gn(o,t,e){return new Le({...o,coercer:(r,c)=>bo(r,t)?o.coercer(e(r,c),c):o.coercer(r,c)})}const su=Bs.v4,ou=function(o,t,e,r){if(typeof o!="string")throw new TypeError(o+" must be a string");r=r||{};const c=typeof r.version=="number"?r.version:2;if(c!==1&&c!==2)throw new TypeError(c+" must be 1 or 2");const i={method:o};if(c===2&&(i.jsonrpc="2.0"),t){if(typeof t!="object"&&!Array.isArray(t))throw new TypeError(t+" must be an object, array or omitted");i.params=t}if(typeof e>"u"){const h=typeof r.generator=="function"?r.generator:function(){return su()};i.id=h(i,r)}else c===2&&e===null?r.notificationIdNull&&(i.id=null):i.id=e;return i};var au=ou;const cu=Bs.v4,uu=au,cn=function(o,t){if(!(this instanceof cn))return new cn(o,t);t||(t={}),this.options={reviver:typeof t.reviver<"u"?t.reviver:null,replacer:typeof t.replacer<"u"?t.replacer:null,generator:typeof t.generator<"u"?t.generator:function(){return cu()},version:typeof t.version<"u"?t.version:2,notificationIdNull:typeof t.notificationIdNull=="boolean"?t.notificationIdNull:!1},this.callServer=o};var hu=cn;cn.prototype.request=function(o,t,e,r){const c=this;let i=null;const h=Array.isArray(o)&&typeof t=="function";if(this.options.version===1&&h)throw new TypeError("JSON-RPC 1.0 does not support batching");if(h||!h&&o&&typeof o=="object"&&typeof t=="function")r=t,i=o;else{typeof e=="function"&&(r=e,e=void 0);const b=typeof r=="function";try{i=uu(o,t,e,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(x){if(b)return r(x);throw x}if(!b)return i}let y;try{y=JSON.stringify(i,this.options.replacer)}catch(b){return r(b)}return this.callServer(y,function(b,x){c._parseResponse(b,x,r)}),i};cn.prototype._parseResponse=function(o,t,e){if(o){e(o);return}if(!t)return e();let r;try{r=JSON.parse(t,this.options.reviver)}catch(c){return e(c)}if(e.length===3)if(Array.isArray(r)){const c=function(h){return typeof h.error<"u"},i=function(h){return!c(h)};return e(null,r.filter(c),r.filter(i))}else return e(null,r.error,r.result);e(null,r)};const fu=hn(hu);var Mo={},_o={exports:{}};(function(o){function t(e){return e&&e.__esModule?e:{default:e}}o.exports=t,o.exports.__esModule=!0,o.exports.default=o.exports})(_o);var qi=_o.exports;const lu=Ve(Qo),du=Ve(ta),Ui=Ve(ea),Fi=Ve(ra),So=Ve(na),Eo=Ve(ia),ko=Ve(sa);var Zn={exports:{}},is;function Bo(){return is||(is=1,function(o){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function c(y,b,x){this.fn=y,this.context=b,this.once=x||!1}function i(y,b,x,_,L){if(typeof x!="function")throw new TypeError("The listener must be a function");var k=new c(x,_||y,L),E=e?e+b:b;return y._events[E]?y._events[E].fn?y._events[E]=[y._events[E],k]:y._events[E].push(k):(y._events[E]=k,y._eventsCount++),y}function h(y,b){--y._eventsCount===0?y._events=new r:delete y._events[b]}function w(){this._events=new r,this._eventsCount=0}w.prototype.eventNames=function(){var b=[],x,_;if(this._eventsCount===0)return b;for(_ in x=this._events)t.call(x,_)&&b.push(e?_.slice(1):_);return Object.getOwnPropertySymbols?b.concat(Object.getOwnPropertySymbols(x)):b},w.prototype.listeners=function(b){var x=e?e+b:b,_=this._events[x];if(!_)return[];if(_.fn)return[_.fn];for(var L=0,k=_.length,E=new Array(k);L<k;L++)E[L]=_[L].fn;return E},w.prototype.listenerCount=function(b){var x=e?e+b:b,_=this._events[x];return _?_.fn?1:_.length:0},w.prototype.emit=function(b,x,_,L,k,E){var S=e?e+b:b;if(!this._events[S])return!1;var M=this._events[S],T=arguments.length,q,I;if(M.fn){switch(M.once&&this.removeListener(b,M.fn,void 0,!0),T){case 1:return M.fn.call(M.context),!0;case 2:return M.fn.call(M.context,x),!0;case 3:return M.fn.call(M.context,x,_),!0;case 4:return M.fn.call(M.context,x,_,L),!0;case 5:return M.fn.call(M.context,x,_,L,k),!0;case 6:return M.fn.call(M.context,x,_,L,k,E),!0}for(I=1,q=new Array(T-1);I<T;I++)q[I-1]=arguments[I];M.fn.apply(M.context,q)}else{var N=M.length,U;for(I=0;I<N;I++)switch(M[I].once&&this.removeListener(b,M[I].fn,void 0,!0),T){case 1:M[I].fn.call(M[I].context);break;case 2:M[I].fn.call(M[I].context,x);break;case 3:M[I].fn.call(M[I].context,x,_);break;case 4:M[I].fn.call(M[I].context,x,_,L);break;default:if(!q)for(U=1,q=new Array(T-1);U<T;U++)q[U-1]=arguments[U];M[I].fn.apply(M[I].context,q)}}return!0},w.prototype.on=function(b,x,_){return i(this,b,x,_,!1)},w.prototype.once=function(b,x,_){return i(this,b,x,_,!0)},w.prototype.removeListener=function(b,x,_,L){var k=e?e+b:b;if(!this._events[k])return this;if(!x)return h(this,k),this;var E=this._events[k];if(E.fn)E.fn===x&&(!L||E.once)&&(!_||E.context===_)&&h(this,k);else{for(var S=0,M=[],T=E.length;S<T;S++)(E[S].fn!==x||L&&!E[S].once||_&&E[S].context!==_)&&M.push(E[S]);M.length?this._events[k]=M.length===1?M[0]:M:h(this,k)}return this},w.prototype.removeAllListeners=function(b){var x;return b?(x=e?e+b:b,this._events[x]&&h(this,x)):(this._events=new r,this._eventsCount=0),this},w.prototype.off=w.prototype.removeListener,w.prototype.addListener=w.prototype.on,w.prefixed=e,w.EventEmitter=w,o.exports=w}(Zn)),Zn.exports}var Ir={},ss;function pu(){if(ss)return Ir;ss=1;var o=qi;Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.DefaultDataPack=void 0,Ir.createError=i;var t=o(Ui),e=o(Fi),r=new Map([[-32e3,"Event not provided"],[-32600,"Invalid Request"],[-32601,"Method not found"],[-32602,"Invalid params"],[-32603,"Internal error"],[-32604,"Params not found"],[-32605,"Method forbidden"],[-32606,"Event forbidden"],[-32700,"Parse error"]]),c=function(){function h(){(0,t.default)(this,h)}return(0,e.default)(h,[{key:"encode",value:function(y){return JSON.stringify(y)}},{key:"decode",value:function(y){return JSON.parse(y)}}]),h}();Ir.DefaultDataPack=c;function i(h,w){var y={code:h,message:r.get(h)||"Internal Server Error"};return w&&(y.data=w),y}return Ir}(function(o){var t=qi;Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var e=t(oa),r=t(lu),c=t(du),i=t(Ui),h=t(Fi),w=t(So),y=t(Eo),b=t(ko),x=Bo(),_=pu();function L(M){var T=k();return function(){var I=(0,b.default)(M),N;if(T){var U=(0,b.default)(this).constructor;N=Reflect.construct(I,arguments,U)}else N=I.apply(this,arguments);return(0,y.default)(this,N)}}function k(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var E=function(M,T){var q={};for(var I in M)Object.prototype.hasOwnProperty.call(M,I)&&T.indexOf(I)<0&&(q[I]=M[I]);if(M!=null&&typeof Object.getOwnPropertySymbols=="function")for(var N=0,I=Object.getOwnPropertySymbols(M);N<I.length;N++)T.indexOf(I[N])<0&&Object.prototype.propertyIsEnumerable.call(M,I[N])&&(q[I[N]]=M[I[N]]);return q},S=function(M){(0,w.default)(q,M);var T=L(q);function q(I){var N,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ws://localhost:8080",B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},K=arguments.length>3?arguments[3]:void 0,F=arguments.length>4?arguments[4]:void 0;(0,i.default)(this,q);var V=B.autoconnect,et=V===void 0?!0:V,D=B.reconnect,Ft=D===void 0?!0:D,m=B.reconnect_interval,n=m===void 0?1e3:m,a=B.max_reconnects,u=a===void 0?5:a,l=E(B,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return N=T.call(this),N.webSocketFactory=I,N.queue={},N.rpc_id=0,N.address=U,N.autoconnect=et,N.ready=!1,N.reconnect=Ft,N.reconnect_timer_id=void 0,N.reconnect_interval=n,N.max_reconnects=u,N.rest_options=l,N.current_reconnects=0,N.generate_request_id=K||function(){return++N.rpc_id},F?N.dataPack=F:N.dataPack=new _.DefaultDataPack,N.autoconnect&&N._connect(N.address,Object.assign({autoconnect:N.autoconnect,reconnect:N.reconnect,reconnect_interval:N.reconnect_interval,max_reconnects:N.max_reconnects},N.rest_options)),N}return(0,h.default)(q,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function(N,U,B,K){var F=this;return!K&&(0,c.default)(B)==="object"&&(K=B,B=null),new Promise(function(V,et){if(!F.ready)return et(new Error("socket not ready"));var D=F.generate_request_id(N,U),Ft={jsonrpc:"2.0",method:N,params:U||void 0,id:D};F.socket.send(F.dataPack.encode(Ft),K,function(m){if(m)return et(m);F.queue[D]={promise:[V,et]},B&&(F.queue[D].timeout=setTimeout(function(){delete F.queue[D],et(new Error("reply timeout"))},B))})})}},{key:"login",value:function(){var I=(0,r.default)(e.default.mark(function U(B){var K;return e.default.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.call("rpc.login",B);case 2:if(K=V.sent,K){V.next=5;break}throw new Error("authentication failed");case 5:return V.abrupt("return",K);case 6:case"end":return V.stop()}},U,this)}));function N(U){return I.apply(this,arguments)}return N}()},{key:"listMethods",value:function(){var I=(0,r.default)(e.default.mark(function U(){return e.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,this.call("__listMethods");case 2:return K.abrupt("return",K.sent);case 3:case"end":return K.stop()}},U,this)}));function N(){return I.apply(this,arguments)}return N}()},{key:"notify",value:function(N,U){var B=this;return new Promise(function(K,F){if(!B.ready)return F(new Error("socket not ready"));var V={jsonrpc:"2.0",method:N,params:U};B.socket.send(B.dataPack.encode(V),function(et){if(et)return F(et);K()})})}},{key:"subscribe",value:function(){var I=(0,r.default)(e.default.mark(function U(B){var K;return e.default.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return typeof B=="string"&&(B=[B]),V.next=3,this.call("rpc.on",B);case 3:if(K=V.sent,!(typeof B=="string"&&K[B]!=="ok")){V.next=6;break}throw new Error("Failed subscribing to an event '"+B+"' with: "+K[B]);case 6:return V.abrupt("return",K);case 7:case"end":return V.stop()}},U,this)}));function N(U){return I.apply(this,arguments)}return N}()},{key:"unsubscribe",value:function(){var I=(0,r.default)(e.default.mark(function U(B){var K;return e.default.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return typeof B=="string"&&(B=[B]),V.next=3,this.call("rpc.off",B);case 3:if(K=V.sent,!(typeof B=="string"&&K[B]!=="ok")){V.next=6;break}throw new Error("Failed unsubscribing from an event with: "+K);case 6:return V.abrupt("return",K);case 7:case"end":return V.stop()}},U,this)}));function N(U){return I.apply(this,arguments)}return N}()},{key:"close",value:function(N,U){this.socket.close(N||1e3,U)}},{key:"_connect",value:function(N,U){var B=this;clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(N,U),this.socket.addEventListener("open",function(){B.ready=!0,B.emit("open"),B.current_reconnects=0}),this.socket.addEventListener("message",function(K){var F=K.data;F instanceof ArrayBuffer&&(F=Buffer.from(F).toString());try{F=B.dataPack.decode(F)}catch{return}if(F.notification&&B.listeners(F.notification).length){if(!Object.keys(F.params).length)return B.emit(F.notification);var V=[F.notification];if(F.params.constructor===Object)V.push(F.params);else for(var et=0;et<F.params.length;et++)V.push(F.params[et]);return Promise.resolve().then(function(){B.emit.apply(B,V)})}if(!B.queue[F.id])return F.method&&F.params?Promise.resolve().then(function(){B.emit(F.method,F.params)}):void 0;"error"in F=="result"in F&&B.queue[F.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),B.queue[F.id].timeout&&clearTimeout(B.queue[F.id].timeout),F.error?B.queue[F.id].promise[1](F.error):B.queue[F.id].promise[0](F.result),delete B.queue[F.id]}),this.socket.addEventListener("error",function(K){return B.emit("error",K)}),this.socket.addEventListener("close",function(K){var F=K.code,V=K.reason;B.ready&&setTimeout(function(){return B.emit("close",F,V)},0),B.ready=!1,B.socket=void 0,F!==1e3&&(B.current_reconnects++,B.reconnect&&(B.max_reconnects>B.current_reconnects||B.max_reconnects===0)&&(B.reconnect_timer_id=setTimeout(function(){return B._connect(N,U)},B.reconnect_interval)))})}}]),q}(x.EventEmitter);o.default=S})(Mo);const gu=hn(Mo);var Ao={};(function(o){var t=qi;Object.defineProperty(o,"__esModule",{value:!0}),o.default=_;var e=t(Ui),r=t(Fi),c=t(So),i=t(Eo),h=t(ko),w=Bo();function y(L){var k=b();return function(){var S=(0,h.default)(L),M;if(k){var T=(0,h.default)(this).constructor;M=Reflect.construct(S,arguments,T)}else M=S.apply(this,arguments);return(0,i.default)(this,M)}}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var x=function(L){(0,c.default)(E,L);var k=y(E);function E(S,M,T){var q;return(0,e.default)(this,E),q=k.call(this),q.socket=new window.WebSocket(S,T),q.socket.onopen=function(){return q.emit("open")},q.socket.onmessage=function(I){return q.emit("message",I.data)},q.socket.onerror=function(I){return q.emit("error",I)},q.socket.onclose=function(I){q.emit("close",I.code,I.reason)},q}return(0,r.default)(E,[{key:"send",value:function(M,T,q){var I=q||T;try{this.socket.send(M),I()}catch(N){I(N)}}},{key:"close",value:function(M,T){this.socket.close(M,T)}},{key:"addEventListener",value:function(M,T,q){this.socket.addEventListener(M,T,q)}}]),E}(w.EventEmitter);function _(L,k){return new x(L,k)}})(Ao);const mu=hn(Ao);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function wu(o){const t=vi(o);zr(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:e,Fp:r,a:c}=t;if(e){if(!r.eql(c,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:yu,hexToBytes:vu}=Ga,br={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(o){const{Err:t}=br;if(o.length<2||o[0]!==2)throw new t("Invalid signature integer tag");const e=o[1],r=o.subarray(2,e+2);if(!e||r.length!==e)throw new t("Invalid signature integer: wrong length");if(r[0]&128)throw new t("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:yu(r),l:o.subarray(e+2)}},toSig(o){const{Err:t}=br,e=typeof o=="string"?vu(o):o;if(!(e instanceof Uint8Array))throw new Error("ui8a expected");let r=e.length;if(r<2||e[0]!=48)throw new t("Invalid signature tag");if(e[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:c,l:i}=br._parseInt(e.subarray(2)),{d:h,l:w}=br._parseInt(i);if(w.length)throw new t("Invalid signature: left bytes after parsing");return{r:c,s:h}},hexFromSig(o){const t=b=>Number.parseInt(b[0],16)&8?"00"+b:b,e=b=>{const x=b.toString(16);return x.length&1?`0${x}`:x},r=t(e(o.s)),c=t(e(o.r)),i=r.length/2,h=c.length/2,w=e(i),y=e(h);return`30${e(h+i+4)}02${y}${c}02${w}${r}`}},Oe=BigInt(0),we=BigInt(1);BigInt(2);const os=BigInt(3);BigInt(4);function bu(o){const t=wu(o),{Fp:e}=t,r=t.toBytes||((E,S,M)=>{const T=S.toAffine();return Sr(Uint8Array.from([4]),e.toBytes(T.x),e.toBytes(T.y))}),c=t.fromBytes||(E=>{const S=E.subarray(1),M=e.fromBytes(S.subarray(0,e.BYTES)),T=e.fromBytes(S.subarray(e.BYTES,2*e.BYTES));return{x:M,y:T}});function i(E){const{a:S,b:M}=t,T=e.sqr(E),q=e.mul(T,E);return e.add(e.add(q,e.mul(E,S)),M)}if(!e.eql(e.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function h(E){return typeof E=="bigint"&&Oe<E&&E<t.n}function w(E){if(!h(E))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function y(E){const{allowedPrivateKeyLengths:S,nByteLength:M,wrapPrivateKey:T,n:q}=t;if(S&&typeof E!="bigint"){if(E instanceof Uint8Array&&(E=_r(E)),typeof E!="string"||!S.includes(E.length))throw new Error("Invalid key");E=E.padStart(M*2,"0")}let I;try{I=typeof E=="bigint"?E:xr(oe("private key",E,M))}catch{throw new Error(`private key must be ${M} bytes, hex or bigint, not ${typeof E}`)}return T&&(I=Jt(I,q)),w(I),I}const b=new Map;function x(E){if(!(E instanceof _))throw new Error("ProjectivePoint expected")}class _{constructor(S,M,T){if(this.px=S,this.py=M,this.pz=T,S==null||!e.isValid(S))throw new Error("x required");if(M==null||!e.isValid(M))throw new Error("y required");if(T==null||!e.isValid(T))throw new Error("z required")}static fromAffine(S){const{x:M,y:T}=S||{};if(!S||!e.isValid(M)||!e.isValid(T))throw new Error("invalid affine point");if(S instanceof _)throw new Error("projective point not allowed");const q=I=>e.eql(I,e.ZERO);return q(M)&&q(T)?_.ZERO:new _(M,T,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(S){const M=e.invertBatch(S.map(T=>T.pz));return S.map((T,q)=>T.toAffine(M[q])).map(_.fromAffine)}static fromHex(S){const M=_.fromAffine(c(oe("pointHex",S)));return M.assertValidity(),M}static fromPrivateKey(S){return _.BASE.multiply(y(S))}_setWindowSize(S){this._WINDOW_SIZE=S,b.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!e.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:S,y:M}=this.toAffine();if(!e.isValid(S)||!e.isValid(M))throw new Error("bad point: x or y not FE");const T=e.sqr(M),q=i(S);if(!e.eql(T,q))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:S}=this.toAffine();if(e.isOdd)return!e.isOdd(S);throw new Error("Field doesn't support isOdd")}equals(S){x(S);const{px:M,py:T,pz:q}=this,{px:I,py:N,pz:U}=S,B=e.eql(e.mul(M,U),e.mul(I,q)),K=e.eql(e.mul(T,U),e.mul(N,q));return B&&K}negate(){return new _(this.px,e.neg(this.py),this.pz)}double(){const{a:S,b:M}=t,T=e.mul(M,os),{px:q,py:I,pz:N}=this;let U=e.ZERO,B=e.ZERO,K=e.ZERO,F=e.mul(q,q),V=e.mul(I,I),et=e.mul(N,N),D=e.mul(q,I);return D=e.add(D,D),K=e.mul(q,N),K=e.add(K,K),U=e.mul(S,K),B=e.mul(T,et),B=e.add(U,B),U=e.sub(V,B),B=e.add(V,B),B=e.mul(U,B),U=e.mul(D,U),K=e.mul(T,K),et=e.mul(S,et),D=e.sub(F,et),D=e.mul(S,D),D=e.add(D,K),K=e.add(F,F),F=e.add(K,F),F=e.add(F,et),F=e.mul(F,D),B=e.add(B,F),et=e.mul(I,N),et=e.add(et,et),F=e.mul(et,D),U=e.sub(U,F),K=e.mul(et,V),K=e.add(K,K),K=e.add(K,K),new _(U,B,K)}add(S){x(S);const{px:M,py:T,pz:q}=this,{px:I,py:N,pz:U}=S;let B=e.ZERO,K=e.ZERO,F=e.ZERO;const V=t.a,et=e.mul(t.b,os);let D=e.mul(M,I),Ft=e.mul(T,N),m=e.mul(q,U),n=e.add(M,T),a=e.add(I,N);n=e.mul(n,a),a=e.add(D,Ft),n=e.sub(n,a),a=e.add(M,q);let u=e.add(I,U);return a=e.mul(a,u),u=e.add(D,m),a=e.sub(a,u),u=e.add(T,q),B=e.add(N,U),u=e.mul(u,B),B=e.add(Ft,m),u=e.sub(u,B),F=e.mul(V,a),B=e.mul(et,m),F=e.add(B,F),B=e.sub(Ft,F),F=e.add(Ft,F),K=e.mul(B,F),Ft=e.add(D,D),Ft=e.add(Ft,D),m=e.mul(V,m),a=e.mul(et,a),Ft=e.add(Ft,m),m=e.sub(D,m),m=e.mul(V,m),a=e.add(a,m),D=e.mul(Ft,a),K=e.add(K,D),D=e.mul(u,a),B=e.mul(n,B),B=e.sub(B,D),D=e.mul(n,Ft),F=e.mul(u,F),F=e.add(F,D),new _(B,K,F)}subtract(S){return this.add(S.negate())}is0(){return this.equals(_.ZERO)}wNAF(S){return k.wNAFCached(this,b,S,M=>{const T=e.invertBatch(M.map(q=>q.pz));return M.map((q,I)=>q.toAffine(T[I])).map(_.fromAffine)})}multiplyUnsafe(S){const M=_.ZERO;if(S===Oe)return M;if(w(S),S===we)return this;const{endo:T}=t;if(!T)return k.unsafeLadder(this,S);let{k1neg:q,k1:I,k2neg:N,k2:U}=T.splitScalar(S),B=M,K=M,F=this;for(;I>Oe||U>Oe;)I&we&&(B=B.add(F)),U&we&&(K=K.add(F)),F=F.double(),I>>=we,U>>=we;return q&&(B=B.negate()),N&&(K=K.negate()),K=new _(e.mul(K.px,T.beta),K.py,K.pz),B.add(K)}multiply(S){w(S);let M=S,T,q;const{endo:I}=t;if(I){const{k1neg:N,k1:U,k2neg:B,k2:K}=I.splitScalar(M);let{p:F,f:V}=this.wNAF(U),{p:et,f:D}=this.wNAF(K);F=k.constTimeNegate(N,F),et=k.constTimeNegate(B,et),et=new _(e.mul(et.px,I.beta),et.py,et.pz),T=F.add(et),q=V.add(D)}else{const{p:N,f:U}=this.wNAF(M);T=N,q=U}return _.normalizeZ([T,q])[0]}multiplyAndAddUnsafe(S,M,T){const q=_.BASE,I=(U,B)=>B===Oe||B===we||!U.equals(q)?U.multiplyUnsafe(B):U.multiply(B),N=I(this,M).add(I(S,T));return N.is0()?void 0:N}toAffine(S){const{px:M,py:T,pz:q}=this,I=this.is0();S==null&&(S=I?e.ONE:e.inv(q));const N=e.mul(M,S),U=e.mul(T,S),B=e.mul(q,S);if(I)return{x:e.ZERO,y:e.ZERO};if(!e.eql(B,e.ONE))throw new Error("invZ was invalid");return{x:N,y:U}}isTorsionFree(){const{h:S,isTorsionFree:M}=t;if(S===we)return!0;if(M)return M(_,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:S,clearCofactor:M}=t;return S===we?this:M?M(_,this):this.multiplyUnsafe(t.h)}toRawBytes(S=!0){return this.assertValidity(),r(_,this,S)}toHex(S=!0){return _r(this.toRawBytes(S))}}_.BASE=new _(t.Gx,t.Gy,e.ONE),_.ZERO=new _(e.ZERO,e.ONE,e.ZERO);const L=t.nBitLength,k=Ws(_,t.endo?Math.ceil(L/2):L);return{CURVE:t,ProjectivePoint:_,normPrivateKeyToScalar:y,weierstrassEquation:i,isWithinCurveOrder:h}}function xu(o){const t=vi(o);return zr(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Mu(o){const t=xu(o),{Fp:e,n:r}=t,c=e.BYTES+1,i=2*e.BYTES+1;function h(a){return Oe<a&&a<e.ORDER}function w(a){return Jt(a,r)}function y(a){return ti(a,r)}const{ProjectivePoint:b,normPrivateKeyToScalar:x,weierstrassEquation:_,isWithinCurveOrder:L}=bu({...t,toBytes(a,u,l){const d=u.toAffine(),g=e.toBytes(d.x),v=Sr;return l?v(Uint8Array.from([u.hasEvenY()?2:3]),g):v(Uint8Array.from([4]),g,e.toBytes(d.y))},fromBytes(a){const u=a.length,l=a[0],d=a.subarray(1);if(u===c&&(l===2||l===3)){const g=xr(d);if(!h(g))throw new Error("Point is not on curve");const v=_(g);let f=e.sqrt(v);const s=(f&we)===we;return(l&1)===1!==s&&(f=e.neg(f)),{x:g,y:f}}else if(u===i&&l===4){const g=e.fromBytes(d.subarray(0,e.BYTES)),v=e.fromBytes(d.subarray(e.BYTES,2*e.BYTES));return{x:g,y:v}}else throw new Error(`Point of length ${u} was invalid. Expected ${c} compressed bytes or ${i} uncompressed bytes`)}}),k=a=>_r(Nr(a,t.nByteLength));function E(a){const u=r>>we;return a>u}function S(a){return E(a)?w(-a):a}const M=(a,u,l)=>xr(a.slice(u,l));class T{constructor(u,l,d){this.r=u,this.s=l,this.recovery=d,this.assertValidity()}static fromCompact(u){const l=t.nByteLength;return u=oe("compactSignature",u,l*2),new T(M(u,0,l),M(u,l,2*l))}static fromDER(u){const{r:l,s:d}=br.toSig(oe("DER",u));return new T(l,d)}assertValidity(){if(!L(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!L(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(u){return new T(this.r,this.s,u)}recoverPublicKey(u){const{r:l,s:d,recovery:g}=this,v=K(oe("msgHash",u));if(g==null||![0,1,2,3].includes(g))throw new Error("recovery id invalid");const f=g===2||g===3?l+t.n:l;if(f>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");const s=g&1?"03":"02",p=b.fromHex(s+k(f)),C=y(f),P=w(-v*C),O=w(d*C),Y=b.BASE.multiplyAndAddUnsafe(p,P,O);if(!Y)throw new Error("point at infinify");return Y.assertValidity(),Y}hasHighS(){return E(this.s)}normalizeS(){return this.hasHighS()?new T(this.r,w(-this.s),this.recovery):this}toDERRawBytes(){return Or(this.toDERHex())}toDERHex(){return br.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Or(this.toCompactHex())}toCompactHex(){return k(this.r)+k(this.s)}}const q={isValidPrivateKey(a){try{return x(a),!0}catch{return!1}},normPrivateKeyToScalar:x,randomPrivateKey:()=>{const a=$s(t.n);return ic(t.randomBytes(a),t.n)},precompute(a=8,u=b.BASE){return u._setWindowSize(a),u.multiply(BigInt(3)),u}};function I(a,u=!0){return b.fromPrivateKey(a).toRawBytes(u)}function N(a){const u=a instanceof Uint8Array,l=typeof a=="string",d=(u||l)&&a.length;return u?d===c||d===i:l?d===2*c||d===2*i:a instanceof b}function U(a,u,l=!0){if(N(a))throw new Error("first arg must be private key");if(!N(u))throw new Error("second arg must be public key");return b.fromHex(u).multiply(x(a)).toRawBytes(l)}const B=t.bits2int||function(a){const u=xr(a),l=a.length*8-t.nBitLength;return l>0?u>>BigInt(l):u},K=t.bits2int_modN||function(a){return w(B(a))},F=yi(t.nBitLength);function V(a){if(typeof a!="bigint")throw new Error("bigint expected");if(!(Oe<=a&&a<F))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Nr(a,t.nByteLength)}function et(a,u,l=D){if(["recovered","canonical"].some(Z=>Z in l))throw new Error("sign() legacy options not supported");const{hash:d,randomBytes:g}=t;let{lowS:v,prehash:f,extraEntropy:s}=l;v==null&&(v=!0),a=oe("msgHash",a),f&&(a=oe("prehashed msgHash",d(a)));const p=K(a),C=x(u),P=[V(C),V(p)];if(s!=null){const Z=s===!0?g(e.BYTES):s;P.push(oe("extraEntropy",Z))}const O=Sr(...P),Y=p;function j(Z){const Xt=B(Z);if(!L(Xt))return;const J=y(Xt),tt=b.BASE.multiply(Xt).toAffine(),Vt=w(tt.x);if(Vt===Oe)return;const rt=w(J*w(Y+Vt*C));if(rt===Oe)return;let st=(tt.x===Vt?0:2)|Number(tt.y&we),_e=rt;return v&&E(rt)&&(_e=S(rt),st^=1),new T(Vt,_e,st)}return{seed:O,k2sig:j}}const D={lowS:t.lowS,prehash:!1},Ft={lowS:t.lowS,prehash:!1};function m(a,u,l=D){const{seed:d,k2sig:g}=et(a,u,l),v=t;return Ks(v.hash.outputLen,v.nByteLength,v.hmac)(d,g)}b.BASE._setWindowSize(8);function n(a,u,l,d=Ft){var tt;const g=a;if(u=oe("msgHash",u),l=oe("publicKey",l),"strict"in d)throw new Error("options.strict was renamed to lowS");const{lowS:v,prehash:f}=d;let s,p;try{if(typeof g=="string"||g instanceof Uint8Array)try{s=T.fromDER(g)}catch(Vt){if(!(Vt instanceof br.Err))throw Vt;s=T.fromCompact(g)}else if(typeof g=="object"&&typeof g.r=="bigint"&&typeof g.s=="bigint"){const{r:Vt,s:rt}=g;s=new T(Vt,rt)}else throw new Error("PARSE");p=b.fromHex(l)}catch(Vt){if(Vt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(v&&s.hasHighS())return!1;f&&(u=t.hash(u));const{r:C,s:P}=s,O=K(u),Y=y(P),j=w(O*Y),Z=w(C*Y),Xt=(tt=b.BASE.multiplyAndAddUnsafe(p,j,Z))==null?void 0:tt.toAffine();return Xt?w(Xt.x)===C:!1}return{CURVE:t,getPublicKey:I,getSharedSecret:U,sign:m,verify:n,ProjectivePoint:b,Signature:T,utils:q}}class Io extends Ls{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,ua(t);const r=mi(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const c=this.blockLen,i=new Uint8Array(c);i.set(r.length>c?t.create().update(r).digest():r);for(let h=0;h<i.length;h++)i[h]^=54;this.iHash.update(i),this.oHash=t.create();for(let h=0;h<i.length;h++)i[h]^=106;this.oHash.update(i),i.fill(0)}update(t){return _n(this),this.iHash.update(t),this}digestInto(t){_n(this),As(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:c,destroyed:i,blockLen:h,outputLen:w}=this;return t=t,t.finished=c,t.destroyed=i,t.blockLen=h,t.outputLen=w,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Ro=(o,t,e)=>new Io(o,t).update(e).digest();Ro.create=(o,t)=>new Io(o,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function _u(o){return{hash:o,hmac:(t,...e)=>Ro(o,t,Ts(...e)),randomBytes:Ps}}function Su(o,t){const e=r=>Mu({...o,..._u(r)});return Object.freeze({...e(t),create:e})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const To=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),as=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Eu=BigInt(1),ii=BigInt(2),cs=(o,t)=>(o+t/ii)/t;function ku(o){const t=To,e=BigInt(3),r=BigInt(6),c=BigInt(11),i=BigInt(22),h=BigInt(23),w=BigInt(44),y=BigInt(88),b=o*o*o%t,x=b*b*o%t,_=ee(x,e,t)*x%t,L=ee(_,e,t)*x%t,k=ee(L,ii,t)*b%t,E=ee(k,c,t)*k%t,S=ee(E,i,t)*E%t,M=ee(S,w,t)*S%t,T=ee(M,y,t)*M%t,q=ee(T,w,t)*S%t,I=ee(q,e,t)*x%t,N=ee(I,h,t)*E%t,U=ee(N,r,t)*b%t,B=ee(U,ii,t);if(!si.eql(si.sqr(B),o))throw new Error("Cannot find square root");return B}const si=Ds(To,void 0,void 0,{sqrt:ku}),Ki=Su({a:BigInt(0),b:BigInt(7),Fp:si,n:as,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:o=>{const t=as,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Eu*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),c=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=e,h=BigInt("0x100000000000000000000000000000000"),w=cs(i*o,t),y=cs(-r*o,t);let b=Jt(o-w*e-y*c,t),x=Jt(-w*r-y*i,t);const _=b>h,L=x>h;if(_&&(b=t-b),L&&(x=t-x),b>h||x>h)throw new Error("splitScalar: Endomorphism failed, k="+o);return{k1neg:_,k1:b,k2neg:L,k2:x}}}},ri);BigInt(0);Ki.ProjectivePoint;Dr.utils.randomPrivateKey;const us=()=>{const o=Dr.utils.randomPrivateKey(),t=oi(o),e=new Uint8Array(64);return e.set(o),e.set(t,32),{publicKey:t,secretKey:e}},oi=Dr.getPublicKey;function hs(o){try{return Dr.ExtendedPoint.fromHex(o),!0}catch{return!1}}const Bu=(o,t)=>Dr.sign(o,t.slice(0,32)),Au=Dr.verify,Ur=o=>Dt.Buffer.isBuffer(o)?o:o instanceof Uint8Array?Dt.Buffer.from(o.buffer,o.byteOffset,o.byteLength):Dt.Buffer.from(o);class Iu{constructor(t){Object.assign(this,t)}encode(){return Dt.Buffer.from(to(xn,this))}static decode(t){return eo(xn,this,t)}static decodeUnchecked(t){return Vs(xn,this,t)}}const xn=new Map;var Lo;let Co;const Ru=32,Ae=32;function Tu(o){return o._bn!==void 0}let fs=1;Co=Symbol.toStringTag;class it extends Iu{constructor(t){if(super({}),this._bn=void 0,Tu(t))this._bn=t._bn;else{if(typeof t=="string"){const e=Zt.decode(t);if(e.length!=Ae)throw new Error("Invalid public key input");this._bn=new rs(e)}else this._bn=new rs(t);if(this._bn.byteLength()>Ae)throw new Error("Invalid public key input")}}static unique(){const t=new it(fs);return fs+=1,new it(t.toBuffer())}equals(t){return this._bn.eq(t._bn)}toBase58(){return Zt.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const t=this.toBuffer();return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}toBuffer(){const t=this._bn.toArrayLike(Dt.Buffer);if(t.length===Ae)return t;const e=Dt.Buffer.alloc(32);return t.copy(e,32-t.length),e}get[Co](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(t,e,r){const c=Dt.Buffer.concat([t.toBuffer(),Dt.Buffer.from(e),r.toBuffer()]),i=ri(c);return new it(i)}static createProgramAddressSync(t,e){let r=Dt.Buffer.alloc(0);t.forEach(function(i){if(i.length>Ru)throw new TypeError("Max seed length exceeded");r=Dt.Buffer.concat([r,Ur(i)])}),r=Dt.Buffer.concat([r,e.toBuffer(),Dt.Buffer.from("ProgramDerivedAddress")]);const c=ri(r);if(hs(c))throw new Error("Invalid seeds, address must fall off the curve");return new it(c)}static async createProgramAddress(t,e){return this.createProgramAddressSync(t,e)}static findProgramAddressSync(t,e){let r=255,c;for(;r!=0;){try{const i=t.concat(Dt.Buffer.from([r]));c=this.createProgramAddressSync(i,e)}catch(i){if(i instanceof TypeError)throw i;r--;continue}return[c,r]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(t,e){return this.findProgramAddressSync(t,e)}static isOnCurve(t){const e=new it(t);return hs(e.toBytes())}}Lo=it;it.default=new Lo("11111111111111111111111111111111");xn.set(it,{kind:"struct",fields:[["_bn","u256"]]});new it("BPFLoader1111111111111111111111111111111111");const Pr=1280-40-8,Po=127,ai=64;class Oo extends Error{constructor(t){super(`Signature ${t} has expired: block height exceeded.`),this.signature=void 0,this.signature=t}}Object.defineProperty(Oo.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class No extends Error{constructor(t,e){super(`Transaction was not confirmed in ${e.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${t} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=t}}Object.defineProperty(No.prototype,"name",{value:"TransactionExpiredTimeoutError"});class nn extends Error{constructor(t){super(`Signature ${t} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=t}}Object.defineProperty(nn.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class In{constructor(t,e){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=t,this.accountKeysFromLookups=e}keySegments(){const t=[this.staticAccountKeys];return this.accountKeysFromLookups&&(t.push(this.accountKeysFromLookups.writable),t.push(this.accountKeysFromLookups.readonly)),t}get(t){for(const e of this.keySegments()){if(t<e.length)return e[t];t-=e.length}}get length(){return this.keySegments().flat().length}compileInstructions(t){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const r=new Map;this.keySegments().flat().forEach((i,h)=>{r.set(i.toBase58(),h)});const c=i=>{const h=r.get(i.toBase58());if(h===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return h};return t.map(i=>({programIdIndex:c(i.programId),accountKeyIndexes:i.keys.map(h=>c(h.pubkey)),data:i.data}))}}const Ht=(o="publicKey")=>re(32,o),Lr=(o="string")=>{const t=Q([nt("length"),nt("lengthPadding"),re(Mr(nt(),-8),"chars")],o),e=t.decode.bind(t),r=t.encode.bind(t),c=t;return c.decode=(i,h)=>e(i,h).chars.toString(),c.encode=(i,h,w)=>{const y={chars:Dt.Buffer.from(i,"utf8")};return r(y,h,w)},c.alloc=i=>nt().span+nt().span+Dt.Buffer.from(i,"utf8").length,c},Lu=(o="authorized")=>Q([Ht("staker"),Ht("withdrawer")],o),Cu=(o="lockup")=>Q([ge("unixTimestamp"),ge("epoch"),Ht("custodian")],o),Pu=(o="voteInit")=>Q([Ht("nodePubkey"),Ht("authorizedVoter"),Ht("authorizedWithdrawer"),jt("commission")],o),Ou=(o="voteAuthorizeWithSeedArgs")=>Q([nt("voteAuthorizationType"),Ht("currentAuthorityDerivedKeyOwnerPubkey"),Lr("currentAuthorityDerivedKeySeed"),Ht("newAuthorized")],o);function ve(o){let t=0,e=0;for(;;){let r=o.shift();if(t|=(r&127)<<e*7,e+=1,!(r&128))break}return t}function be(o,t){let e=t;for(;;){let r=e&127;if(e>>=7,e==0){o.push(r);break}else r|=128,o.push(r)}}function ie(o,t){if(!o)throw new Error(t||"Assertion failed")}class Un{constructor(t,e){this.payer=void 0,this.keyMetaMap=void 0,this.payer=t,this.keyMetaMap=e}static compile(t,e){const r=new Map,c=h=>{const w=h.toBase58();let y=r.get(w);return y===void 0&&(y={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(w,y)),y},i=c(e);i.isSigner=!0,i.isWritable=!0;for(const h of t){c(h.programId).isInvoked=!0;for(const w of h.keys){const y=c(w.pubkey);y.isSigner||(y.isSigner=w.isSigner),y.isWritable||(y.isWritable=w.isWritable)}}return new Un(e,r)}getMessageComponents(){const t=[...this.keyMetaMap.entries()];ie(t.length<=256,"Max static account keys length exceeded");const e=t.filter(([,y])=>y.isSigner&&y.isWritable),r=t.filter(([,y])=>y.isSigner&&!y.isWritable),c=t.filter(([,y])=>!y.isSigner&&y.isWritable),i=t.filter(([,y])=>!y.isSigner&&!y.isWritable),h={numRequiredSignatures:e.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:i.length};{ie(e.length>0,"Expected at least one writable signer key");const[y]=e[0];ie(y===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const w=[...e.map(([y])=>new it(y)),...r.map(([y])=>new it(y)),...c.map(([y])=>new it(y)),...i.map(([y])=>new it(y))];return[h,w]}extractTableLookup(t){const[e,r]=this.drainKeysFoundInLookupTable(t.state.addresses,h=>!h.isSigner&&!h.isInvoked&&h.isWritable),[c,i]=this.drainKeysFoundInLookupTable(t.state.addresses,h=>!h.isSigner&&!h.isInvoked&&!h.isWritable);if(!(e.length===0&&c.length===0))return[{accountKey:t.key,writableIndexes:e,readonlyIndexes:c},{writable:r,readonly:i}]}drainKeysFoundInLookupTable(t,e){const r=new Array,c=new Array;for(const[i,h]of this.keyMetaMap.entries())if(e(h)){const w=new it(i),y=t.findIndex(b=>b.equals(w));y>=0&&(ie(y<256,"Max lookup table index exceeded"),r.push(y),c.push(w),this.keyMetaMap.delete(i))}return[r,c]}}class Ze{constructor(t){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=t.header,this.accountKeys=t.accountKeys.map(e=>new it(e)),this.recentBlockhash=t.recentBlockhash,this.instructions=t.instructions,this.instructions.forEach(e=>this.indexToProgramIds.set(e.programIdIndex,this.accountKeys[e.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:Zt.decode(t.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new In(this.staticAccountKeys)}static compile(t){const e=Un.compile(t.instructions,t.payerKey),[r,c]=e.getMessageComponents(),h=new In(c).compileInstructions(t.instructions).map(w=>({programIdIndex:w.programIdIndex,accounts:w.accountKeyIndexes,data:Zt.encode(w.data)}));return new Ze({header:r,accountKeys:c,recentBlockhash:t.recentBlockhash,instructions:h})}isAccountSigner(t){return t<this.header.numRequiredSignatures}isAccountWritable(t){const e=this.header.numRequiredSignatures;if(t>=this.header.numRequiredSignatures){const r=t-e,i=this.accountKeys.length-e-this.header.numReadonlyUnsignedAccounts;return r<i}else{const r=e-this.header.numReadonlySignedAccounts;return t<r}}isProgramId(t){return this.indexToProgramIds.has(t)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((t,e)=>!this.isProgramId(e))}serialize(){const t=this.accountKeys.length;let e=[];be(e,t);const r=this.instructions.map(_=>{const{accounts:L,programIdIndex:k}=_,E=Array.from(Zt.decode(_.data));let S=[];be(S,L.length);let M=[];return be(M,E.length),{programIdIndex:k,keyIndicesCount:Dt.Buffer.from(S),keyIndices:L,dataLength:Dt.Buffer.from(M),data:E}});let c=[];be(c,r.length);let i=Dt.Buffer.alloc(Pr);Dt.Buffer.from(c).copy(i);let h=c.length;r.forEach(_=>{const k=Q([jt("programIdIndex"),re(_.keyIndicesCount.length,"keyIndicesCount"),fe(jt("keyIndex"),_.keyIndices.length,"keyIndices"),re(_.dataLength.length,"dataLength"),fe(jt("userdatum"),_.data.length,"data")]).encode(_,i,h);h+=k}),i=i.slice(0,h);const w=Q([re(1,"numRequiredSignatures"),re(1,"numReadonlySignedAccounts"),re(1,"numReadonlyUnsignedAccounts"),re(e.length,"keyCount"),fe(Ht("key"),t,"keys"),Ht("recentBlockhash")]),y={numRequiredSignatures:Dt.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:Dt.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:Dt.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:Dt.Buffer.from(e),keys:this.accountKeys.map(_=>Ur(_.toBytes())),recentBlockhash:Zt.decode(this.recentBlockhash)};let b=Dt.Buffer.alloc(2048);const x=w.encode(y,b);return i.copy(b,x),b.slice(0,x+i.length)}static from(t){let e=[...t];const r=e.shift();if(r!==(r&Po))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const c=e.shift(),i=e.shift(),h=ve(e);let w=[];for(let L=0;L<h;L++){const k=e.slice(0,Ae);e=e.slice(Ae),w.push(new it(Dt.Buffer.from(k)))}const y=e.slice(0,Ae);e=e.slice(Ae);const b=ve(e);let x=[];for(let L=0;L<b;L++){const k=e.shift(),E=ve(e),S=e.slice(0,E);e=e.slice(E);const M=ve(e),T=e.slice(0,M),q=Zt.encode(Dt.Buffer.from(T));e=e.slice(M),x.push({programIdIndex:k,accounts:S,data:q})}const _={header:{numRequiredSignatures:r,numReadonlySignedAccounts:c,numReadonlyUnsignedAccounts:i},recentBlockhash:Zt.encode(Dt.Buffer.from(y)),accountKeys:w,instructions:x};return new Ze(_)}}class Rn{constructor(t){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=t.header,this.staticAccountKeys=t.staticAccountKeys,this.recentBlockhash=t.recentBlockhash,this.compiledInstructions=t.compiledInstructions,this.addressTableLookups=t.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let t=0;for(const e of this.addressTableLookups)t+=e.readonlyIndexes.length+e.writableIndexes.length;return t}getAccountKeys(t){let e;if(t&&"accountKeysFromLookups"in t&&t.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=t.accountKeysFromLookups.writable.length+t.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");e=t.accountKeysFromLookups}else if(t&&"addressLookupTableAccounts"in t&&t.addressLookupTableAccounts)e=this.resolveAddressTableLookups(t.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new In(this.staticAccountKeys,e)}isAccountSigner(t){return t<this.header.numRequiredSignatures}isAccountWritable(t){const e=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;if(t>=r){const c=t-r,i=this.addressTableLookups.reduce((h,w)=>h+w.writableIndexes.length,0);return c<i}else if(t>=this.header.numRequiredSignatures){const c=t-e,h=r-e-this.header.numReadonlyUnsignedAccounts;return c<h}else{const c=e-this.header.numReadonlySignedAccounts;return t<c}}resolveAddressTableLookups(t){const e={writable:[],readonly:[]};for(const r of this.addressTableLookups){const c=t.find(i=>i.key.equals(r.accountKey));if(!c)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const i of r.writableIndexes)if(i<c.state.addresses.length)e.writable.push(c.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`);for(const i of r.readonlyIndexes)if(i<c.state.addresses.length)e.readonly.push(c.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`)}return e}static compile(t){const e=Un.compile(t.instructions,t.payerKey),r=new Array,c={writable:new Array,readonly:new Array},i=t.addressLookupTableAccounts||[];for(const x of i){const _=e.extractTableLookup(x);if(_!==void 0){const[L,{writable:k,readonly:E}]=_;r.push(L),c.writable.push(...k),c.readonly.push(...E)}}const[h,w]=e.getMessageComponents(),b=new In(w,c).compileInstructions(t.instructions);return new Rn({header:h,staticAccountKeys:w,recentBlockhash:t.recentBlockhash,compiledInstructions:b,addressTableLookups:r})}serialize(){const t=Array();be(t,this.staticAccountKeys.length);const e=this.serializeInstructions(),r=Array();be(r,this.compiledInstructions.length);const c=this.serializeAddressTableLookups(),i=Array();be(i,this.addressTableLookups.length);const h=Q([jt("prefix"),Q([jt("numRequiredSignatures"),jt("numReadonlySignedAccounts"),jt("numReadonlyUnsignedAccounts")],"header"),re(t.length,"staticAccountKeysLength"),fe(Ht(),this.staticAccountKeys.length,"staticAccountKeys"),Ht("recentBlockhash"),re(r.length,"instructionsLength"),re(e.length,"serializedInstructions"),re(i.length,"addressTableLookupsLength"),re(c.length,"serializedAddressTableLookups")]),w=new Uint8Array(Pr),y=128,b=h.encode({prefix:y,header:this.header,staticAccountKeysLength:new Uint8Array(t),staticAccountKeys:this.staticAccountKeys.map(x=>x.toBytes()),recentBlockhash:Zt.decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:e,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:c},w);return w.slice(0,b)}serializeInstructions(){let t=0;const e=new Uint8Array(Pr);for(const r of this.compiledInstructions){const c=Array();be(c,r.accountKeyIndexes.length);const i=Array();be(i,r.data.length);const h=Q([jt("programIdIndex"),re(c.length,"encodedAccountKeyIndexesLength"),fe(jt(),r.accountKeyIndexes.length,"accountKeyIndexes"),re(i.length,"encodedDataLength"),re(r.data.length,"data")]);t+=h.encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(c),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:r.data},e,t)}return e.slice(0,t)}serializeAddressTableLookups(){let t=0;const e=new Uint8Array(Pr);for(const r of this.addressTableLookups){const c=Array();be(c,r.writableIndexes.length);const i=Array();be(i,r.readonlyIndexes.length);const h=Q([Ht("accountKey"),re(c.length,"encodedWritableIndexesLength"),fe(jt(),r.writableIndexes.length,"writableIndexes"),re(i.length,"encodedReadonlyIndexesLength"),fe(jt(),r.readonlyIndexes.length,"readonlyIndexes")]);t+=h.encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(c),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:r.readonlyIndexes},e,t)}return e.slice(0,t)}static deserialize(t){let e=[...t];const r=e.shift(),c=r&Po;ie(r!==c,"Expected versioned message but received legacy message");const i=c;ie(i===0,`Expected versioned message with version 0 but found version ${i}`);const h={numRequiredSignatures:e.shift(),numReadonlySignedAccounts:e.shift(),numReadonlyUnsignedAccounts:e.shift()},w=[],y=ve(e);for(let E=0;E<y;E++)w.push(new it(e.splice(0,Ae)));const b=Zt.encode(e.splice(0,Ae)),x=ve(e),_=[];for(let E=0;E<x;E++){const S=e.shift(),M=ve(e),T=e.splice(0,M),q=ve(e),I=new Uint8Array(e.splice(0,q));_.push({programIdIndex:S,accountKeyIndexes:T,data:I})}const L=ve(e),k=[];for(let E=0;E<L;E++){const S=new it(e.splice(0,Ae)),M=ve(e),T=e.splice(0,M),q=ve(e),I=e.splice(0,q);k.push({accountKey:S,writableIndexes:T,readonlyIndexes:I})}return new Rn({header:h,staticAccountKeys:w,recentBlockhash:b,compiledInstructions:_,addressTableLookups:k})}}let $e=function(o){return o[o.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",o[o.PROCESSED=1]="PROCESSED",o[o.TIMED_OUT=2]="TIMED_OUT",o[o.NONCE_INVALID=3]="NONCE_INVALID",o}({});const Nu=Dt.Buffer.alloc(ai).fill(0);class ls{constructor(t){this.keys=void 0,this.programId=void 0,this.data=Dt.Buffer.alloc(0),this.programId=t.programId,this.keys=t.keys,t.data&&(this.data=t.data)}toJSON(){return{keys:this.keys.map(({pubkey:t,isSigner:e,isWritable:r})=>({pubkey:t.toJSON(),isSigner:e,isWritable:r})),programId:this.programId.toJSON(),data:[...this.data]}}}class We{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(t){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!t)if(t.feePayer&&(this.feePayer=t.feePayer),t.signatures&&(this.signatures=t.signatures),Object.prototype.hasOwnProperty.call(t,"nonceInfo")){const{minContextSlot:e,nonceInfo:r}=t;this.minNonceContextSlot=e,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")){const{blockhash:e,lastValidBlockHeight:r}=t;this.recentBlockhash=e,this.lastValidBlockHeight=r}else{const{recentBlockhash:e,nonceInfo:r}=t;r&&(this.nonceInfo=r),this.recentBlockhash=e}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(t=>t.toJSON()),signers:this.signatures.map(({publicKey:t})=>t.toJSON())}}add(...t){if(t.length===0)throw new Error("No instructions");return t.forEach(e=>{"instructions"in e?this.instructions=this.instructions.concat(e.instructions):"data"in e&&"programId"in e&&"keys"in e?this.instructions.push(e):this.instructions.push(new ls(e))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let t,e;if(this.nonceInfo?(t=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?e=[this.nonceInfo.nonceInstruction,...this.instructions]:e=this.instructions):(t=this.recentBlockhash,e=this.instructions),!t)throw new Error("Transaction recentBlockhash required");e.length<1&&console.warn("No instructions provided");let r;if(this.feePayer)r=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)r=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let S=0;S<e.length;S++)if(e[S].programId===void 0)throw new Error(`Transaction instruction index ${S} has undefined program id`);const c=[],i=[];e.forEach(S=>{S.keys.forEach(T=>{i.push({...T})});const M=S.programId.toString();c.includes(M)||c.push(M)}),c.forEach(S=>{i.push({pubkey:new it(S),isSigner:!1,isWritable:!1})});const h=[];i.forEach(S=>{const M=S.pubkey.toString(),T=h.findIndex(q=>q.pubkey.toString()===M);T>-1?(h[T].isWritable=h[T].isWritable||S.isWritable,h[T].isSigner=h[T].isSigner||S.isSigner):h.push(S)}),h.sort(function(S,M){if(S.isSigner!==M.isSigner)return S.isSigner?-1:1;if(S.isWritable!==M.isWritable)return S.isWritable?-1:1;const T={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return S.pubkey.toBase58().localeCompare(M.pubkey.toBase58(),"en",T)});const w=h.findIndex(S=>S.pubkey.equals(r));if(w>-1){const[S]=h.splice(w,1);S.isSigner=!0,S.isWritable=!0,h.unshift(S)}else h.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const S of this.signatures){const M=h.findIndex(T=>T.pubkey.equals(S.publicKey));if(M>-1)h[M].isSigner||(h[M].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${S.publicKey.toString()}`)}let y=0,b=0,x=0;const _=[],L=[];h.forEach(({pubkey:S,isSigner:M,isWritable:T})=>{M?(_.push(S.toString()),y+=1,T||(b+=1)):(L.push(S.toString()),T||(x+=1))});const k=_.concat(L),E=e.map(S=>{const{data:M,programId:T}=S;return{programIdIndex:k.indexOf(T.toString()),accounts:S.keys.map(q=>k.indexOf(q.pubkey.toString())),data:Zt.encode(M)}});return E.forEach(S=>{ie(S.programIdIndex>=0),S.accounts.forEach(M=>ie(M>=0))}),new Ze({header:{numRequiredSignatures:y,numReadonlySignedAccounts:b,numReadonlyUnsignedAccounts:x},accountKeys:k,recentBlockhash:t,instructions:E})}_compile(){const t=this.compileMessage(),e=t.accountKeys.slice(0,t.header.numRequiredSignatures);return this.signatures.length===e.length&&this.signatures.every((c,i)=>e[i].equals(c.publicKey))||(this.signatures=e.map(r=>({signature:null,publicKey:r}))),t}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(t){return(await t.getFeeForMessage(this.compileMessage())).value}setSigners(...t){if(t.length===0)throw new Error("No signers");const e=new Set;this.signatures=t.filter(r=>{const c=r.toString();return e.has(c)?!1:(e.add(c),!0)}).map(r=>({signature:null,publicKey:r}))}sign(...t){if(t.length===0)throw new Error("No signers");const e=new Set,r=[];for(const i of t){const h=i.publicKey.toString();e.has(h)||(e.add(h),r.push(i))}this.signatures=r.map(i=>({signature:null,publicKey:i.publicKey}));const c=this._compile();this._partialSign(c,...r)}partialSign(...t){if(t.length===0)throw new Error("No signers");const e=new Set,r=[];for(const i of t){const h=i.publicKey.toString();e.has(h)||(e.add(h),r.push(i))}const c=this._compile();this._partialSign(c,...r)}_partialSign(t,...e){const r=t.serialize();e.forEach(c=>{const i=Bu(r,c.secretKey);this._addSignature(c.publicKey,Ur(i))})}addSignature(t,e){this._compile(),this._addSignature(t,e)}_addSignature(t,e){ie(e.length===64);const r=this.signatures.findIndex(c=>t.equals(c.publicKey));if(r<0)throw new Error(`unknown signer: ${t.toString()}`);this.signatures[r].signature=Dt.Buffer.from(e)}verifySignatures(t){return this._verifySignatures(this.serializeMessage(),t===void 0?!0:t)}_verifySignatures(t,e){for(const{signature:r,publicKey:c}of this.signatures)if(r===null){if(e)return!1}else if(!Au(r,t,c.toBytes()))return!1;return!0}serialize(t){const{requireAllSignatures:e,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},t),c=this.serializeMessage();if(r&&!this._verifySignatures(c,e))throw new Error("Signature verification failed");return this._serialize(c)}_serialize(t){const{signatures:e}=this,r=[];be(r,e.length);const c=r.length+e.length*64+t.length,i=Dt.Buffer.alloc(c);return ie(e.length<256),Dt.Buffer.from(r).copy(i,0),e.forEach(({signature:h},w)=>{h!==null&&(ie(h.length===64,"signature has invalid length"),Dt.Buffer.from(h).copy(i,r.length+w*64))}),t.copy(i,r.length+e.length*64),ie(i.length<=Pr,`Transaction too large: ${i.length} > ${Pr}`),i}get keys(){return ie(this.instructions.length===1),this.instructions[0].keys.map(t=>t.pubkey)}get programId(){return ie(this.instructions.length===1),this.instructions[0].programId}get data(){return ie(this.instructions.length===1),this.instructions[0].data}static from(t){let e=[...t];const r=ve(e);let c=[];for(let i=0;i<r;i++){const h=e.slice(0,ai);e=e.slice(ai),c.push(Zt.encode(Dt.Buffer.from(h)))}return We.populate(Ze.from(e),c)}static populate(t,e=[]){const r=new We;return r.recentBlockhash=t.recentBlockhash,t.header.numRequiredSignatures>0&&(r.feePayer=t.accountKeys[0]),e.forEach((c,i)=>{const h={signature:c==Zt.encode(Nu)?null:Zt.decode(c),publicKey:t.accountKeys[i]};r.signatures.push(h)}),t.instructions.forEach(c=>{const i=c.accounts.map(h=>{const w=t.accountKeys[h];return{pubkey:w,isSigner:r.signatures.some(y=>y.publicKey.toString()===w.toString())||t.isAccountSigner(h),isWritable:t.isAccountWritable(h)}});r.instructions.push(new ls({keys:i,programId:t.accountKeys[c.programIdIndex],data:Zt.decode(c.data)}))}),r._message=t,r._json=r.toJSON(),r}}const qu=160,Uu=64,Fu=qu/Uu,Ku=1e3/Fu;new it("SysvarC1ock11111111111111111111111111111111");new it("SysvarEpochSchedu1e111111111111111111111111");new it("Sysvar1nstructions1111111111111111111111111");new it("SysvarRecentB1ockHashes11111111111111111111");new it("SysvarRent111111111111111111111111111111111");new it("SysvarRewards111111111111111111111111111111");new it("SysvarS1otHashes111111111111111111111111111");new it("SysvarS1otHistory11111111111111111111111111");new it("SysvarStakeHistory1111111111111111111111111");function Tr(o){return new Promise(t=>setTimeout(t,o))}const zu=ce("lamportsPerSignature"),qo=Q([nt("version"),nt("state"),Ht("authorizedPubkey"),Ht("nonce"),Q([zu],"feeCalculator")]);qo.span;class zi{constructor(t){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=t.authorizedPubkey,this.nonce=t.nonce,this.feeCalculator=t.feeCalculator}static fromAccountData(t){const e=qo.decode(Ur(t),0);return new zi({authorizedPubkey:new it(e.authorizedPubkey),nonce:new it(e.nonce).toString(),feeCalculator:e.feeCalculator})}}const Du=o=>{const t=o.decode.bind(o),e=o.encode.bind(o);return{decode:t,encode:e}},Hu=o=>t=>{const e=re(o,t),{encode:r,decode:c}=Du(e),i=e;return i.decode=(h,w)=>{const y=c(h,w);return jc(Dt.Buffer.from(y))},i.encode=(h,w,y)=>{const b=Vc(h,o);return r(b,w,y)},i},Fr=Hu(8);Object.freeze({Create:{index:0,layout:Q([nt("instruction"),ge("lamports"),ge("space"),Ht("programId")])},Assign:{index:1,layout:Q([nt("instruction"),Ht("programId")])},Transfer:{index:2,layout:Q([nt("instruction"),Fr("lamports")])},CreateWithSeed:{index:3,layout:Q([nt("instruction"),Ht("base"),Lr("seed"),ge("lamports"),ge("space"),Ht("programId")])},AdvanceNonceAccount:{index:4,layout:Q([nt("instruction")])},WithdrawNonceAccount:{index:5,layout:Q([nt("instruction"),ge("lamports")])},InitializeNonceAccount:{index:6,layout:Q([nt("instruction"),Ht("authorized")])},AuthorizeNonceAccount:{index:7,layout:Q([nt("instruction"),Ht("authorized")])},Allocate:{index:8,layout:Q([nt("instruction"),ge("space")])},AllocateWithSeed:{index:9,layout:Q([nt("instruction"),Ht("base"),Lr("seed"),ge("space"),Ht("programId")])},AssignWithSeed:{index:10,layout:Q([nt("instruction"),Ht("base"),Lr("seed"),Ht("programId")])},TransferWithSeed:{index:11,layout:Q([nt("instruction"),Fr("lamports"),Lr("seed"),Ht("programId")])},UpgradeNonceAccount:{index:12,layout:Q([nt("instruction")])}});new it("11111111111111111111111111111111");new it("BPFLoader2111111111111111111111111111111111");function $u(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Wu=Object.prototype.toString,ju=Object.keys||function(o){var t=[];for(var e in o)t.push(e);return t};function sn(o,t){var e,r,c,i,h,w,y;if(o===!0)return"true";if(o===!1)return"false";switch(typeof o){case"object":if(o===null)return null;if(o.toJSON&&typeof o.toJSON=="function")return sn(o.toJSON(),t);if(y=Wu.call(o),y==="[object Array]"){for(c="[",r=o.length-1,e=0;e<r;e++)c+=sn(o[e],!0)+",";return r>-1&&(c+=sn(o[e],!0)),c+"]"}else if(y==="[object Object]"){for(i=ju(o).sort(),r=i.length,c="",e=0;e<r;)h=i[e],w=sn(o[h],!1),w!==void 0&&(c&&(c+=","),c+=JSON.stringify(h)+":"+w),e++;return"{"+c+"}"}else return JSON.stringify(o);case"function":case"undefined":return t?null:void 0;case"string":return JSON.stringify(o);default:return isFinite(o)?o:null}}var Gu=function(o){var t=sn(o,!1);if(t!==void 0)return""+t},ds=$u(Gu);const rn=32;function Vn(o){let t=0;for(;o>1;)o/=2,t++;return t}function Zu(o){return o===0?1:(o--,o|=o>>1,o|=o>>2,o|=o>>4,o|=o>>8,o|=o>>16,o|=o>>32,o+1)}class Vu{constructor(t,e,r,c,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=t,this.leaderScheduleSlotOffset=e,this.warmup=r,this.firstNormalEpoch=c,this.firstNormalSlot=i}getEpoch(t){return this.getEpochAndSlotIndex(t)[0]}getEpochAndSlotIndex(t){if(t<this.firstNormalSlot){const e=Vn(Zu(t+rn+1))-Vn(rn)-1,r=this.getSlotsInEpoch(e),c=t-(r-rn);return[e,c]}else{const e=t-this.firstNormalSlot,r=Math.floor(e/this.slotsPerEpoch),c=this.firstNormalEpoch+r,i=e%this.slotsPerEpoch;return[c,i]}}getFirstSlotInEpoch(t){return t<=this.firstNormalEpoch?(Math.pow(2,t)-1)*rn:(t-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(t){return this.getFirstSlotInEpoch(t)+this.getSlotsInEpoch(t)-1}getSlotsInEpoch(t){return t<this.firstNormalEpoch?Math.pow(2,t+Vn(rn)):this.slotsPerEpoch}}class ps extends Error{constructor(t,e){super(t),this.logs=void 0,this.logs=e}}class X extends Error{constructor({code:t,message:e,data:r},c){super(c!=null?`${c}: ${e}`:e),this.code=void 0,this.data=void 0,this.code=t,this.data=r,this.name="SolanaJSONRPCError"}}var Yu=globalThis.fetch;class Ju extends gu{constructor(t,e,r){const c=i=>{const h=mu(i,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...e});return"socket"in h?this.underlyingSocket=h.socket:this.underlyingSocket=h,h};super(c,t,e,r),this.underlyingSocket=void 0}call(...t){var r;const e=(r=this.underlyingSocket)==null?void 0:r.readyState;return e===1?super.call(...t):Promise.reject(new Error("Tried to call a JSON-RPC method `"+t[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+e+")"))}notify(...t){var r;const e=(r=this.underlyingSocket)==null?void 0:r.readyState;return e===1?super.notify(...t):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+t[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+e+")"))}}function Xu(o,t){let e;try{e=o.layout.decode(t)}catch(r){throw new Error("invalid instruction; "+r)}if(e.typeIndex!==o.index)throw new Error(`invalid account data; account type mismatch ${e.typeIndex} != ${o.index}`);return e}const gs=56;class ms{constructor(t){this.key=void 0,this.state=void 0,this.key=t.key,this.state=t.state}isActive(){const t=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===t}static deserialize(t){const e=Xu(Qu,t),r=t.length-gs;ie(r>=0,"lookup table is invalid"),ie(r%32===0,"lookup table is invalid");const c=r/32,{addresses:i}=Q([fe(Ht(),c,"addresses")]).decode(t.slice(gs));return{deactivationSlot:e.deactivationSlot,lastExtendedSlot:e.lastExtendedSlot,lastExtendedSlotStartIndex:e.lastExtendedStartIndex,authority:e.authority.length!==0?new it(e.authority[0]):void 0,addresses:i.map(h=>new it(h))}}}const Qu={index:1,layout:Q([nt("typeIndex"),Fr("deactivationSlot"),ce("lastExtendedSlot"),jt("lastExtendedStartIndex"),jt(),fe(Ht(),Mr(jt(),-1),"authority")])},th=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function eh(o){const t=o.match(th);if(t==null)throw TypeError(`Failed to validate endpoint URL \`${o}\``);const[e,r,c,i]=t,h=o.startsWith("https:")?"wss:":"ws:",w=c==null?null:parseInt(c.slice(1),10),y=w==null?"":`:${w+1}`;return`${h}//${r}${y}${i}`}const se=gn(Oi(it),H(),o=>new it(o)),Uo=Ni([H(),Qt("base64")]),Di=gn(Oi(Dt.Buffer),Uo,o=>Dt.Buffer.from(o[0],"base64")),rh=30*1e3;function nh(o){if(/^https?:/.test(o)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return o}function Yt(o){let t,e;if(typeof o=="string")t=o;else if(o){const{commitment:r,...c}=o;t=r,e=c}return{commitment:t,config:e}}function Fo(o){return de([z({jsonrpc:Qt("2.0"),id:H(),result:o}),z({jsonrpc:Qt("2.0"),id:H(),error:z({code:pn(),message:H(),data:ot(nu())})})])}const ih=Fo(pn());function zt(o){return gn(Fo(o),ih,t=>"error"in t?t:{...t,result:$(t.result,o)})}function ne(o){return zt(z({context:z({slot:A()}),value:o}))}function Fn(o){return z({context:z({slot:A()}),value:o})}function Yn(o,t){return o===0?new Rn({header:t.header,staticAccountKeys:t.accountKeys.map(e=>new it(e)),recentBlockhash:t.recentBlockhash,compiledInstructions:t.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:Zt.decode(e.data)})),addressTableLookups:t.addressTableLookups}):new Ze(t)}const sh=z({foundation:A(),foundationTerm:A(),initial:A(),taper:A(),terminal:A()}),oh=zt(G(W(z({epoch:A(),effectiveSlot:A(),amount:A(),postBalance:A(),commission:ot(W(A()))})))),ah=G(z({slot:A(),prioritizationFee:A()})),ch=z({total:A(),validator:A(),foundation:A(),epoch:A()}),uh=z({epoch:A(),slotIndex:A(),slotsInEpoch:A(),absoluteSlot:A(),blockHeight:ot(A()),transactionCount:ot(A())}),hh=z({slotsPerEpoch:A(),leaderScheduleSlotOffset:A(),warmup:Ie(),firstNormalEpoch:A(),firstNormalSlot:A()}),fh=xo(H(),G(A())),Br=W(de([z({}),H()])),lh=z({err:Br}),dh=Qt("receivedSignature"),ph=z({"solana-core":H(),"feature-set":ot(A())}),ws=ne(z({err:W(de([z({}),H()])),logs:W(G(H())),accounts:ot(W(G(W(z({executable:Ie(),owner:H(),lamports:A(),data:G(H()),rentEpoch:ot(A())}))))),unitsConsumed:ot(A()),returnData:ot(W(z({programId:H(),data:Ni([H(),Qt("base64")])})))})),gh=ne(z({byIdentity:xo(H(),G(A())),range:z({firstSlot:A(),lastSlot:A()})}));function mh(o,t,e,r,c,i){const h=e||Yu;let w;i!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let y;return r&&(y=async(x,_)=>{const L=await new Promise((k,E)=>{try{r(x,_,(S,M)=>k([S,M]))}catch(S){E(S)}});return await h(...L)}),new fu(async(x,_)=>{const L={method:"POST",body:x,agent:w,headers:Object.assign({"Content-Type":"application/json"},t||{},yf)};try{let k=5,E,S=500;for(;y?E=await y(o,L):E=await h(o,L),!(E.status!==429||c===!0||(k-=1,k===0));)console.log(`Server responded with ${E.status} ${E.statusText}.  Retrying after ${S}ms delay...`),await Tr(S),S*=2;const M=await E.text();E.ok?_(null,M):_(new Error(`${E.status} ${E.statusText}: ${M}`))}catch(k){k instanceof Error&&_(k)}},{})}function wh(o){return(t,e)=>new Promise((r,c)=>{o.request(t,e,(i,h)=>{if(i){c(i);return}r(h)})})}function yh(o){return t=>new Promise((e,r)=>{t.length===0&&e([]);const c=t.map(i=>o.request(i.methodName,i.args));o.request(c,(i,h)=>{if(i){r(i);return}e(h)})})}const vh=zt(sh),bh=zt(ch),xh=zt(ah),Mh=zt(uh),_h=zt(hh),Sh=zt(fh),Eh=zt(A()),kh=ne(z({total:A(),circulating:A(),nonCirculating:A(),nonCirculatingAccounts:G(se)})),ci=z({amount:H(),uiAmount:W(A()),decimals:A(),uiAmountString:ot(H())}),Bh=ne(G(z({address:se,amount:H(),uiAmount:W(A()),decimals:A(),uiAmountString:ot(H())}))),Ah=ne(G(z({pubkey:se,account:z({executable:Ie(),owner:se,lamports:A(),data:Di,rentEpoch:A()})}))),ui=z({program:H(),parsed:pn(),space:A()}),Ih=ne(G(z({pubkey:se,account:z({executable:Ie(),owner:se,lamports:A(),data:ui,rentEpoch:A()})}))),Rh=ne(G(z({lamports:A(),address:se}))),un=z({executable:Ie(),owner:se,lamports:A(),data:Di,rentEpoch:A()}),Th=z({pubkey:se,account:un}),Lh=gn(de([Oi(Dt.Buffer),ui]),de([Uo,ui]),o=>Array.isArray(o)?$(o,Di):o),hi=z({executable:Ie(),owner:se,lamports:A(),data:Lh,rentEpoch:A()}),Ch=z({pubkey:se,account:hi}),Ph=z({state:de([Qt("active"),Qt("inactive"),Qt("activating"),Qt("deactivating")]),active:A(),inactive:A()}),Oh=zt(G(z({signature:H(),slot:A(),err:Br,memo:W(H()),blockTime:ot(W(A()))}))),Nh=zt(G(z({signature:H(),slot:A(),err:Br,memo:W(H()),blockTime:ot(W(A()))}))),qh=z({subscription:A(),result:Fn(un)}),Uh=z({pubkey:se,account:un}),Fh=z({subscription:A(),result:Fn(Uh)}),Kh=z({parent:A(),slot:A(),root:A()}),zh=z({subscription:A(),result:Kh}),Dh=de([z({type:de([Qt("firstShredReceived"),Qt("completed"),Qt("optimisticConfirmation"),Qt("root")]),slot:A(),timestamp:A()}),z({type:Qt("createdBank"),parent:A(),slot:A(),timestamp:A()}),z({type:Qt("frozen"),slot:A(),timestamp:A(),stats:z({numTransactionEntries:A(),numSuccessfulTransactions:A(),numFailedTransactions:A(),maxTransactionsPerEntry:A()})}),z({type:Qt("dead"),slot:A(),timestamp:A(),err:H()})]),Hh=z({subscription:A(),result:Dh}),$h=z({subscription:A(),result:Fn(de([lh,dh]))}),Wh=z({subscription:A(),result:A()}),jh=z({pubkey:H(),gossip:W(H()),tpu:W(H()),rpc:W(H()),version:W(H())}),ys=z({votePubkey:H(),nodePubkey:H(),activatedStake:A(),epochVoteAccount:Ie(),epochCredits:G(Ni([A(),A(),A()])),commission:A(),lastVote:A(),rootSlot:W(A())}),Gh=zt(z({current:G(ys),delinquent:G(ys)})),Zh=de([Qt("processed"),Qt("confirmed"),Qt("finalized")]),Vh=z({slot:A(),confirmations:W(A()),err:Br,confirmationStatus:ot(Zh)}),Yh=ne(G(W(Vh))),Jh=zt(A()),Ko=z({accountKey:se,writableIndexes:G(A()),readonlyIndexes:G(A())}),Hi=z({signatures:G(H()),message:z({accountKeys:G(H()),header:z({numRequiredSignatures:A(),numReadonlySignedAccounts:A(),numReadonlyUnsignedAccounts:A()}),instructions:G(z({accounts:G(A()),data:H(),programIdIndex:A()})),recentBlockhash:H(),addressTableLookups:ot(G(Ko))})}),zo=z({pubkey:se,signer:Ie(),writable:Ie(),source:ot(de([Qt("transaction"),Qt("lookupTable")]))}),Do=z({accountKeys:G(zo),signatures:G(H())}),Ho=z({parsed:pn(),program:H(),programId:se}),$o=z({accounts:G(se),data:H(),programId:se}),Xh=de([$o,Ho]),Qh=de([z({parsed:pn(),program:H(),programId:H()}),z({accounts:G(H()),data:H(),programId:H()})]),Wo=gn(Xh,Qh,o=>"accounts"in o?$(o,$o):$(o,Ho)),jo=z({signatures:G(H()),message:z({accountKeys:G(zo),instructions:G(Wo),recentBlockhash:H(),addressTableLookups:ot(W(G(Ko)))})}),Tn=z({accountIndex:A(),mint:H(),owner:ot(H()),uiTokenAmount:ci}),Go=z({writable:G(se),readonly:G(se)}),Kn=z({err:Br,fee:A(),innerInstructions:ot(W(G(z({index:A(),instructions:G(z({accounts:G(A()),data:H(),programIdIndex:A()}))})))),preBalances:G(A()),postBalances:G(A()),logMessages:ot(W(G(H()))),preTokenBalances:ot(W(G(Tn))),postTokenBalances:ot(W(G(Tn))),loadedAddresses:ot(Go),computeUnitsConsumed:ot(A())}),$i=z({err:Br,fee:A(),innerInstructions:ot(W(G(z({index:A(),instructions:G(Wo)})))),preBalances:G(A()),postBalances:G(A()),logMessages:ot(W(G(H()))),preTokenBalances:ot(W(G(Tn))),postTokenBalances:ot(W(G(Tn))),loadedAddresses:ot(Go),computeUnitsConsumed:ot(A())}),Wr=de([Qt(0),Qt("legacy")]),Ar=z({pubkey:H(),lamports:A(),postBalance:W(A()),rewardType:W(H()),commission:ot(W(A()))}),tf=zt(W(z({blockhash:H(),previousBlockhash:H(),parentSlot:A(),transactions:G(z({transaction:Hi,meta:W(Kn),version:ot(Wr)})),rewards:ot(G(Ar)),blockTime:W(A()),blockHeight:W(A())}))),ef=zt(W(z({blockhash:H(),previousBlockhash:H(),parentSlot:A(),rewards:ot(G(Ar)),blockTime:W(A()),blockHeight:W(A())}))),rf=zt(W(z({blockhash:H(),previousBlockhash:H(),parentSlot:A(),transactions:G(z({transaction:Do,meta:W(Kn),version:ot(Wr)})),rewards:ot(G(Ar)),blockTime:W(A()),blockHeight:W(A())}))),nf=zt(W(z({blockhash:H(),previousBlockhash:H(),parentSlot:A(),transactions:G(z({transaction:jo,meta:W($i),version:ot(Wr)})),rewards:ot(G(Ar)),blockTime:W(A()),blockHeight:W(A())}))),sf=zt(W(z({blockhash:H(),previousBlockhash:H(),parentSlot:A(),transactions:G(z({transaction:Do,meta:W($i),version:ot(Wr)})),rewards:ot(G(Ar)),blockTime:W(A()),blockHeight:W(A())}))),of=zt(W(z({blockhash:H(),previousBlockhash:H(),parentSlot:A(),rewards:ot(G(Ar)),blockTime:W(A()),blockHeight:W(A())}))),af=zt(W(z({blockhash:H(),previousBlockhash:H(),parentSlot:A(),transactions:G(z({transaction:Hi,meta:W(Kn)})),rewards:ot(G(Ar)),blockTime:W(A())}))),vs=zt(W(z({blockhash:H(),previousBlockhash:H(),parentSlot:A(),signatures:G(H()),blockTime:W(A())}))),Jn=zt(W(z({slot:A(),meta:W(Kn),blockTime:ot(W(A())),transaction:Hi,version:ot(Wr)}))),vn=zt(W(z({slot:A(),transaction:jo,meta:W($i),blockTime:ot(W(A())),version:ot(Wr)}))),cf=ne(z({blockhash:H(),feeCalculator:z({lamportsPerSignature:A()})})),uf=ne(z({blockhash:H(),lastValidBlockHeight:A()})),hf=ne(Ie()),ff=z({slot:A(),numTransactions:A(),numSlots:A(),samplePeriodSecs:A()}),lf=zt(G(ff)),df=ne(W(z({feeCalculator:z({lamportsPerSignature:A()})}))),pf=zt(H()),gf=zt(H()),mf=z({err:Br,logs:G(H()),signature:H()}),wf=z({result:Fn(mf),subscription:A()}),yf={"solana-client":"js/0.0.0-development"};class Wi{constructor(t,e){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const b={};return async x=>{const{commitment:_,config:L}=Yt(x),k=this._buildArgs([],_,void 0,L),E=ds(k);return b[E]=b[E]??(async()=>{try{const S=await this._rpcRequest("getBlockHeight",k),M=$(S,zt(A()));if("error"in M)throw new X(M.error,"failed to get block height information");return M.result}finally{delete b[E]}})(),await b[E]}})();let r,c,i,h,w,y;e&&typeof e=="string"?this._commitment=e:e&&(this._commitment=e.commitment,this._confirmTransactionInitialTimeout=e.confirmTransactionInitialTimeout,r=e.wsEndpoint,c=e.httpHeaders,i=e.fetch,h=e.fetchMiddleware,w=e.disableRetryOnRateLimit,y=e.httpAgent),this._rpcEndpoint=nh(t),this._rpcWsEndpoint=r||eh(t),this._rpcClient=mh(t,c,i,h,w,y),this._rpcRequest=wh(this._rpcClient),this._rpcBatchRequest=yh(this._rpcClient),this._rpcWebSocket=new Ju(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(t,e){const{commitment:r,config:c}=Yt(e),i=this._buildArgs([t.toBase58()],r,void 0,c),h=await this._rpcRequest("getBalance",i),w=$(h,ne(A()));if("error"in w)throw new X(w.error,`failed to get balance for ${t.toBase58()}`);return w.result}async getBalance(t,e){return await this.getBalanceAndContext(t,e).then(r=>r.value).catch(r=>{throw new Error("failed to get balance of account "+t.toBase58()+": "+r)})}async getBlockTime(t){const e=await this._rpcRequest("getBlockTime",[t]),r=$(e,zt(W(A())));if("error"in r)throw new X(r.error,`failed to get block time for slot ${t}`);return r.result}async getMinimumLedgerSlot(){const t=await this._rpcRequest("minimumLedgerSlot",[]),e=$(t,zt(A()));if("error"in e)throw new X(e.error,"failed to get minimum ledger slot");return e.result}async getFirstAvailableBlock(){const t=await this._rpcRequest("getFirstAvailableBlock",[]),e=$(t,Eh);if("error"in e)throw new X(e.error,"failed to get first available block");return e.result}async getSupply(t){let e={};typeof t=="string"?e={commitment:t}:t?e={...t,commitment:t&&t.commitment||this.commitment}:e={commitment:this.commitment};const r=await this._rpcRequest("getSupply",[e]),c=$(r,kh);if("error"in c)throw new X(c.error,"failed to get supply");return c.result}async getTokenSupply(t,e){const r=this._buildArgs([t.toBase58()],e),c=await this._rpcRequest("getTokenSupply",r),i=$(c,ne(ci));if("error"in i)throw new X(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(t,e){const r=this._buildArgs([t.toBase58()],e),c=await this._rpcRequest("getTokenAccountBalance",r),i=$(c,ne(ci));if("error"in i)throw new X(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(t,e,r){const{commitment:c,config:i}=Yt(r);let h=[t.toBase58()];"mint"in e?h.push({mint:e.mint.toBase58()}):h.push({programId:e.programId.toBase58()});const w=this._buildArgs(h,c,"base64",i),y=await this._rpcRequest("getTokenAccountsByOwner",w),b=$(y,Ah);if("error"in b)throw new X(b.error,`failed to get token accounts owned by account ${t.toBase58()}`);return b.result}async getParsedTokenAccountsByOwner(t,e,r){let c=[t.toBase58()];"mint"in e?c.push({mint:e.mint.toBase58()}):c.push({programId:e.programId.toBase58()});const i=this._buildArgs(c,r,"jsonParsed"),h=await this._rpcRequest("getTokenAccountsByOwner",i),w=$(h,Ih);if("error"in w)throw new X(w.error,`failed to get token accounts owned by account ${t.toBase58()}`);return w.result}async getLargestAccounts(t){const e={...t,commitment:t&&t.commitment||this.commitment},r=e.filter||e.commitment?[e]:[],c=await this._rpcRequest("getLargestAccounts",r),i=$(c,Rh);if("error"in i)throw new X(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(t,e){const r=this._buildArgs([t.toBase58()],e),c=await this._rpcRequest("getTokenLargestAccounts",r),i=$(c,Bh);if("error"in i)throw new X(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(t,e){const{commitment:r,config:c}=Yt(e),i=this._buildArgs([t.toBase58()],r,"base64",c),h=await this._rpcRequest("getAccountInfo",i),w=$(h,ne(W(un)));if("error"in w)throw new X(w.error,`failed to get info about account ${t.toBase58()}`);return w.result}async getParsedAccountInfo(t,e){const{commitment:r,config:c}=Yt(e),i=this._buildArgs([t.toBase58()],r,"jsonParsed",c),h=await this._rpcRequest("getAccountInfo",i),w=$(h,ne(W(hi)));if("error"in w)throw new X(w.error,`failed to get info about account ${t.toBase58()}`);return w.result}async getAccountInfo(t,e){try{return(await this.getAccountInfoAndContext(t,e)).value}catch(r){throw new Error("failed to get info about account "+t.toBase58()+": "+r)}}async getMultipleParsedAccounts(t,e){const{commitment:r,config:c}=Yt(e),i=t.map(b=>b.toBase58()),h=this._buildArgs([i],r,"jsonParsed",c),w=await this._rpcRequest("getMultipleAccounts",h),y=$(w,ne(G(W(hi))));if("error"in y)throw new X(y.error,`failed to get info for accounts ${i}`);return y.result}async getMultipleAccountsInfoAndContext(t,e){const{commitment:r,config:c}=Yt(e),i=t.map(b=>b.toBase58()),h=this._buildArgs([i],r,"base64",c),w=await this._rpcRequest("getMultipleAccounts",h),y=$(w,ne(G(W(un))));if("error"in y)throw new X(y.error,`failed to get info for accounts ${i}`);return y.result}async getMultipleAccountsInfo(t,e){return(await this.getMultipleAccountsInfoAndContext(t,e)).value}async getStakeActivation(t,e,r){const{commitment:c,config:i}=Yt(e),h=this._buildArgs([t.toBase58()],c,void 0,{...i,epoch:r??(i==null?void 0:i.epoch)}),w=await this._rpcRequest("getStakeActivation",h),y=$(w,zt(Ph));if("error"in y)throw new X(y.error,`failed to get Stake Activation ${t.toBase58()}`);return y.result}async getProgramAccounts(t,e){const{commitment:r,config:c}=Yt(e),{encoding:i,...h}=c||{},w=this._buildArgs([t.toBase58()],r,i||"base64",h),y=await this._rpcRequest("getProgramAccounts",w),b=G(Th),x=h.withContext===!0?$(y,ne(b)):$(y,zt(b));if("error"in x)throw new X(x.error,`failed to get accounts owned by program ${t.toBase58()}`);return x.result}async getParsedProgramAccounts(t,e){const{commitment:r,config:c}=Yt(e),i=this._buildArgs([t.toBase58()],r,"jsonParsed",c),h=await this._rpcRequest("getProgramAccounts",i),w=$(h,zt(G(Ch)));if("error"in w)throw new X(w.error,`failed to get accounts owned by program ${t.toBase58()}`);return w.result}async confirmTransaction(t,e){var i;let r;if(typeof t=="string")r=t;else{const h=t;if((i=h.abortSignal)!=null&&i.aborted)return Promise.reject(h.abortSignal.reason);r=h.signature}let c;try{c=Zt.decode(r)}catch{throw new Error("signature must be base58 encoded: "+r)}return ie(c.length===64,"signature has invalid length"),typeof t=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:e||this.commitment,signature:r}):"lastValidBlockHeight"in t?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e||this.commitment,strategy:t}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:e||this.commitment,strategy:t})}getCancellationPromise(t){return new Promise((e,r)=>{t!=null&&(t.aborted?r(t.reason):t.addEventListener("abort",()=>{r(t.reason)}))})}getTransactionConfirmationPromise({commitment:t,signature:e}){let r,c,i=!1;const h=new Promise((y,b)=>{try{r=this.onSignature(e,(_,L)=>{r=void 0;const k={context:L,value:_};y({__type:$e.PROCESSED,response:k})},t);const x=new Promise(_=>{r==null?_():c=this._onSubscriptionStateChange(r,L=>{L==="subscribed"&&_()})});(async()=>{if(await x,i)return;const _=await this.getSignatureStatus(e);if(i||_==null)return;const{context:L,value:k}=_;if(k!=null)if(k!=null&&k.err)b(k.err);else{switch(t){case"confirmed":case"single":case"singleGossip":{if(k.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(k.confirmationStatus==="processed"||k.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}i=!0,y({__type:$e.PROCESSED,response:{context:L,value:k}})}})()}catch(x){b(x)}});return{abortConfirmation:()=>{c&&(c(),c=void 0),r!=null&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:h}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t,strategy:{abortSignal:e,lastValidBlockHeight:r,signature:c}}){let i=!1;const h=new Promise(_=>{const L=async()=>{try{return await this.getBlockHeight(t)}catch{return-1}};(async()=>{let k=await L();if(!i){for(;k<=r;)if(await Tr(1e3),i||(k=await L(),i))return;_({__type:$e.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:w,confirmationPromise:y}=this.getTransactionConfirmationPromise({commitment:t,signature:c}),b=this.getCancellationPromise(e);let x;try{const _=await Promise.race([b,y,h]);if(_.__type===$e.PROCESSED)x=_.response;else throw new Oo(c)}finally{i=!0,w()}return x}async confirmTransactionUsingDurableNonceStrategy({commitment:t,strategy:{abortSignal:e,minContextSlot:r,nonceAccountPubkey:c,nonceValue:i,signature:h}}){let w=!1;const y=new Promise(k=>{let E=i,S=null;const M=async()=>{try{const{context:T,value:q}=await this.getNonceAndContext(c,{commitment:t,minContextSlot:r});return S=T.slot,q==null?void 0:q.nonce}catch{return E}};(async()=>{if(E=await M(),!w)for(;;){if(i!==E){k({__type:$e.NONCE_INVALID,slotInWhichNonceDidAdvance:S});return}if(await Tr(2e3),w||(E=await M(),w))return}})()}),{abortConfirmation:b,confirmationPromise:x}=this.getTransactionConfirmationPromise({commitment:t,signature:h}),_=this.getCancellationPromise(e);let L;try{const k=await Promise.race([_,x,y]);if(k.__type===$e.PROCESSED)L=k.response;else{let E;for(;;){const S=await this.getSignatureStatus(h);if(S==null)break;if(S.context.slot<(k.slotInWhichNonceDidAdvance??r)){await Tr(400);continue}E=S;break}if(E!=null&&E.value){const S=t||"finalized",{confirmationStatus:M}=E.value;switch(S){case"processed":case"recent":if(M!=="processed"&&M!=="confirmed"&&M!=="finalized")throw new nn(h);break;case"confirmed":case"single":case"singleGossip":if(M!=="confirmed"&&M!=="finalized")throw new nn(h);break;case"finalized":case"max":case"root":if(M!=="finalized")throw new nn(h);break;default:}L={context:E.context,value:{err:E.value.err}}}else throw new nn(h)}}finally{w=!0,b()}return L}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:t,signature:e}){let r;const c=new Promise(y=>{let b=this._confirmTransactionInitialTimeout||6e4;switch(t){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{b=this._confirmTransactionInitialTimeout||3e4;break}}r=setTimeout(()=>y({__type:$e.TIMED_OUT,timeoutMs:b}),b)}),{abortConfirmation:i,confirmationPromise:h}=this.getTransactionConfirmationPromise({commitment:t,signature:e});let w;try{const y=await Promise.race([h,c]);if(y.__type===$e.PROCESSED)w=y.response;else throw new No(e,y.timeoutMs/1e3)}finally{clearTimeout(r),i()}return w}async getClusterNodes(){const t=await this._rpcRequest("getClusterNodes",[]),e=$(t,zt(G(jh)));if("error"in e)throw new X(e.error,"failed to get cluster nodes");return e.result}async getVoteAccounts(t){const e=this._buildArgs([],t),r=await this._rpcRequest("getVoteAccounts",e),c=$(r,Gh);if("error"in c)throw new X(c.error,"failed to get vote accounts");return c.result}async getSlot(t){const{commitment:e,config:r}=Yt(t),c=this._buildArgs([],e,void 0,r),i=await this._rpcRequest("getSlot",c),h=$(i,zt(A()));if("error"in h)throw new X(h.error,"failed to get slot");return h.result}async getSlotLeader(t){const{commitment:e,config:r}=Yt(t),c=this._buildArgs([],e,void 0,r),i=await this._rpcRequest("getSlotLeader",c),h=$(i,zt(H()));if("error"in h)throw new X(h.error,"failed to get slot leader");return h.result}async getSlotLeaders(t,e){const r=[t,e],c=await this._rpcRequest("getSlotLeaders",r),i=$(c,zt(G(se)));if("error"in i)throw new X(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(t,e){const{context:r,value:c}=await this.getSignatureStatuses([t],e);ie(c.length===1);const i=c[0];return{context:r,value:i}}async getSignatureStatuses(t,e){const r=[t];e&&r.push(e);const c=await this._rpcRequest("getSignatureStatuses",r),i=$(c,Yh);if("error"in i)throw new X(i.error,"failed to get signature status");return i.result}async getTransactionCount(t){const{commitment:e,config:r}=Yt(t),c=this._buildArgs([],e,void 0,r),i=await this._rpcRequest("getTransactionCount",c),h=$(i,zt(A()));if("error"in h)throw new X(h.error,"failed to get transaction count");return h.result}async getTotalSupply(t){return(await this.getSupply({commitment:t,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(t){const e=this._buildArgs([],t),r=await this._rpcRequest("getInflationGovernor",e),c=$(r,vh);if("error"in c)throw new X(c.error,"failed to get inflation");return c.result}async getInflationReward(t,e,r){const{commitment:c,config:i}=Yt(r),h=this._buildArgs([t.map(b=>b.toBase58())],c,void 0,{...i,epoch:e??(i==null?void 0:i.epoch)}),w=await this._rpcRequest("getInflationReward",h),y=$(w,oh);if("error"in y)throw new X(y.error,"failed to get inflation reward");return y.result}async getInflationRate(){const t=await this._rpcRequest("getInflationRate",[]),e=$(t,bh);if("error"in e)throw new X(e.error,"failed to get inflation rate");return e.result}async getEpochInfo(t){const{commitment:e,config:r}=Yt(t),c=this._buildArgs([],e,void 0,r),i=await this._rpcRequest("getEpochInfo",c),h=$(i,Mh);if("error"in h)throw new X(h.error,"failed to get epoch info");return h.result}async getEpochSchedule(){const t=await this._rpcRequest("getEpochSchedule",[]),e=$(t,_h);if("error"in e)throw new X(e.error,"failed to get epoch schedule");const r=e.result;return new Vu(r.slotsPerEpoch,r.leaderScheduleSlotOffset,r.warmup,r.firstNormalEpoch,r.firstNormalSlot)}async getLeaderSchedule(){const t=await this._rpcRequest("getLeaderSchedule",[]),e=$(t,Sh);if("error"in e)throw new X(e.error,"failed to get leader schedule");return e.result}async getMinimumBalanceForRentExemption(t,e){const r=this._buildArgs([t],e),c=await this._rpcRequest("getMinimumBalanceForRentExemption",r),i=$(c,Jh);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(t){const e=this._buildArgs([],t),r=await this._rpcRequest("getRecentBlockhash",e),c=$(r,cf);if("error"in c)throw new X(c.error,"failed to get recent blockhash");return c.result}async getRecentPerformanceSamples(t){const e=await this._rpcRequest("getRecentPerformanceSamples",t?[t]:[]),r=$(e,lf);if("error"in r)throw new X(r.error,"failed to get recent performance samples");return r.result}async getFeeCalculatorForBlockhash(t,e){const r=this._buildArgs([t],e),c=await this._rpcRequest("getFeeCalculatorForBlockhash",r),i=$(c,df);if("error"in i)throw new X(i.error,"failed to get fee calculator");const{context:h,value:w}=i.result;return{context:h,value:w!==null?w.feeCalculator:null}}async getFeeForMessage(t,e){const r=Ur(t.serialize()).toString("base64"),c=this._buildArgs([r],e),i=await this._rpcRequest("getFeeForMessage",c),h=$(i,ne(W(A())));if("error"in h)throw new X(h.error,"failed to get fee for message");if(h.result===null)throw new Error("invalid blockhash");return h.result}async getRecentPrioritizationFees(t){var h;const e=(h=t==null?void 0:t.lockedWritableAccounts)==null?void 0:h.map(w=>w.toBase58()),r=e!=null&&e.length?[e]:[],c=await this._rpcRequest("getRecentPrioritizationFees",r),i=$(c,xh);if("error"in i)throw new X(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(t){try{return(await this.getRecentBlockhashAndContext(t)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhash(t){try{return(await this.getLatestBlockhashAndContext(t)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhashAndContext(t){const{commitment:e,config:r}=Yt(t),c=this._buildArgs([],e,void 0,r),i=await this._rpcRequest("getLatestBlockhash",c),h=$(i,uf);if("error"in h)throw new X(h.error,"failed to get latest blockhash");return h.result}async isBlockhashValid(t,e){const{commitment:r,config:c}=Yt(e),i=this._buildArgs([t],r,void 0,c),h=await this._rpcRequest("isBlockhashValid",i),w=$(h,hf);if("error"in w)throw new X(w.error,"failed to determine if the blockhash `"+t+"`is valid");return w.result}async getVersion(){const t=await this._rpcRequest("getVersion",[]),e=$(t,zt(ph));if("error"in e)throw new X(e.error,"failed to get version");return e.result}async getGenesisHash(){const t=await this._rpcRequest("getGenesisHash",[]),e=$(t,zt(H()));if("error"in e)throw new X(e.error,"failed to get genesis hash");return e.result}async getBlock(t,e){const{commitment:r,config:c}=Yt(e),i=this._buildArgsAtLeastConfirmed([t],r,void 0,c),h=await this._rpcRequest("getBlock",i);try{switch(c==null?void 0:c.transactionDetails){case"accounts":{const w=$(h,rf);if("error"in w)throw w.error;return w.result}case"none":{const w=$(h,ef);if("error"in w)throw w.error;return w.result}default:{const w=$(h,tf);if("error"in w)throw w.error;const{result:y}=w;return y?{...y,transactions:y.transactions.map(({transaction:b,meta:x,version:_})=>({meta:x,transaction:{...b,message:Yn(_,b.message)},version:_}))}:null}}}catch(w){throw new X(w,"failed to get confirmed block")}}async getParsedBlock(t,e){const{commitment:r,config:c}=Yt(e),i=this._buildArgsAtLeastConfirmed([t],r,"jsonParsed",c),h=await this._rpcRequest("getBlock",i);try{switch(c==null?void 0:c.transactionDetails){case"accounts":{const w=$(h,sf);if("error"in w)throw w.error;return w.result}case"none":{const w=$(h,of);if("error"in w)throw w.error;return w.result}default:{const w=$(h,nf);if("error"in w)throw w.error;return w.result}}}catch(w){throw new X(w,"failed to get block")}}async getBlockProduction(t){let e,r;if(typeof t=="string")r=t;else if(t){const{commitment:w,...y}=t;r=w,e=y}const c=this._buildArgs([],r,"base64",e),i=await this._rpcRequest("getBlockProduction",c),h=$(i,gh);if("error"in h)throw new X(h.error,"failed to get block production information");return h.result}async getTransaction(t,e){const{commitment:r,config:c}=Yt(e),i=this._buildArgsAtLeastConfirmed([t],r,void 0,c),h=await this._rpcRequest("getTransaction",i),w=$(h,Jn);if("error"in w)throw new X(w.error,"failed to get transaction");const y=w.result;return y&&{...y,transaction:{...y.transaction,message:Yn(y.version,y.transaction.message)}}}async getParsedTransaction(t,e){const{commitment:r,config:c}=Yt(e),i=this._buildArgsAtLeastConfirmed([t],r,"jsonParsed",c),h=await this._rpcRequest("getTransaction",i),w=$(h,vn);if("error"in w)throw new X(w.error,"failed to get transaction");return w.result}async getParsedTransactions(t,e){const{commitment:r,config:c}=Yt(e),i=t.map(y=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([y],r,"jsonParsed",c)}));return(await this._rpcBatchRequest(i)).map(y=>{const b=$(y,vn);if("error"in b)throw new X(b.error,"failed to get transactions");return b.result})}async getTransactions(t,e){const{commitment:r,config:c}=Yt(e),i=t.map(y=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([y],r,void 0,c)}));return(await this._rpcBatchRequest(i)).map(y=>{const b=$(y,Jn);if("error"in b)throw new X(b.error,"failed to get transactions");const x=b.result;return x&&{...x,transaction:{...x.transaction,message:Yn(x.version,x.transaction.message)}}})}async getConfirmedBlock(t,e){const r=this._buildArgsAtLeastConfirmed([t],e),c=await this._rpcRequest("getConfirmedBlock",r),i=$(c,af);if("error"in i)throw new X(i.error,"failed to get confirmed block");const h=i.result;if(!h)throw new Error("Confirmed block "+t+" not found");const w={...h,transactions:h.transactions.map(({transaction:y,meta:b})=>{const x=new Ze(y.message);return{meta:b,transaction:{...y,message:x}}})};return{...w,transactions:w.transactions.map(({transaction:y,meta:b})=>({meta:b,transaction:We.populate(y.message,y.signatures)}))}}async getBlocks(t,e,r){const c=this._buildArgsAtLeastConfirmed(e!==void 0?[t,e]:[t],r),i=await this._rpcRequest("getBlocks",c),h=$(i,zt(G(A())));if("error"in h)throw new X(h.error,"failed to get blocks");return h.result}async getBlockSignatures(t,e){const r=this._buildArgsAtLeastConfirmed([t],e,void 0,{transactionDetails:"signatures",rewards:!1}),c=await this._rpcRequest("getBlock",r),i=$(c,vs);if("error"in i)throw new X(i.error,"failed to get block");const h=i.result;if(!h)throw new Error("Block "+t+" not found");return h}async getConfirmedBlockSignatures(t,e){const r=this._buildArgsAtLeastConfirmed([t],e,void 0,{transactionDetails:"signatures",rewards:!1}),c=await this._rpcRequest("getConfirmedBlock",r),i=$(c,vs);if("error"in i)throw new X(i.error,"failed to get confirmed block");const h=i.result;if(!h)throw new Error("Confirmed block "+t+" not found");return h}async getConfirmedTransaction(t,e){const r=this._buildArgsAtLeastConfirmed([t],e),c=await this._rpcRequest("getConfirmedTransaction",r),i=$(c,Jn);if("error"in i)throw new X(i.error,"failed to get transaction");const h=i.result;if(!h)return h;const w=new Ze(h.transaction.message),y=h.transaction.signatures;return{...h,transaction:We.populate(w,y)}}async getParsedConfirmedTransaction(t,e){const r=this._buildArgsAtLeastConfirmed([t],e,"jsonParsed"),c=await this._rpcRequest("getConfirmedTransaction",r),i=$(c,vn);if("error"in i)throw new X(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(t,e){const r=t.map(h=>({methodName:"getConfirmedTransaction",args:this._buildArgsAtLeastConfirmed([h],e,"jsonParsed")}));return(await this._rpcBatchRequest(r)).map(h=>{const w=$(h,vn);if("error"in w)throw new X(w.error,"failed to get confirmed transactions");return w.result})}async getConfirmedSignaturesForAddress(t,e,r){let c={},i=await this.getFirstAvailableBlock();for(;!("until"in c)&&(e--,!(e<=0||e<i));)try{const y=await this.getConfirmedBlockSignatures(e,"finalized");y.signatures.length>0&&(c.until=y.signatures[y.signatures.length-1].toString())}catch(y){if(y instanceof Error&&y.message.includes("skipped"))continue;throw y}let h=await this.getSlot("finalized");for(;!("before"in c)&&(r++,!(r>h));)try{const y=await this.getConfirmedBlockSignatures(r);y.signatures.length>0&&(c.before=y.signatures[y.signatures.length-1].toString())}catch(y){if(y instanceof Error&&y.message.includes("skipped"))continue;throw y}return(await this.getConfirmedSignaturesForAddress2(t,c)).map(y=>y.signature)}async getConfirmedSignaturesForAddress2(t,e,r){const c=this._buildArgsAtLeastConfirmed([t.toBase58()],r,void 0,e),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",c),h=$(i,Oh);if("error"in h)throw new X(h.error,"failed to get confirmed signatures for address");return h.result}async getSignaturesForAddress(t,e,r){const c=this._buildArgsAtLeastConfirmed([t.toBase58()],r,void 0,e),i=await this._rpcRequest("getSignaturesForAddress",c),h=$(i,Nh);if("error"in h)throw new X(h.error,"failed to get signatures for address");return h.result}async getAddressLookupTable(t,e){const{context:r,value:c}=await this.getAccountInfoAndContext(t,e);let i=null;return c!==null&&(i=new ms({key:t,state:ms.deserialize(c.data)})),{context:r,value:i}}async getNonceAndContext(t,e){const{context:r,value:c}=await this.getAccountInfoAndContext(t,e);let i=null;return c!==null&&(i=zi.fromAccountData(c.data)),{context:r,value:i}}async getNonce(t,e){return await this.getNonceAndContext(t,e).then(r=>r.value).catch(r=>{throw new Error("failed to get nonce for account "+t.toBase58()+": "+r)})}async requestAirdrop(t,e){const r=await this._rpcRequest("requestAirdrop",[t.toBase58(),e]),c=$(r,pf);if("error"in c)throw new X(c.error,`airdrop to ${t.toBase58()} failed`);return c.result}async _blockhashWithExpiryBlockHeight(t){if(!t){for(;this._pollingBlockhash;)await Tr(100);const r=Date.now()-this._blockhashInfo.lastFetch>=rh;if(this._blockhashInfo.latestBlockhash!==null&&!r)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const t=Date.now(),e=this._blockhashInfo.latestBlockhash,r=e?e.blockhash:null;for(let c=0;c<50;c++){const i=await this.getLatestBlockhash("finalized");if(r!==i.blockhash)return this._blockhashInfo={latestBlockhash:i,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},i;await Tr(Ku/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-t}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(t){const{commitment:e,config:r}=Yt(t),c=this._buildArgs([],e,"base64",r),i=await this._rpcRequest("getStakeMinimumDelegation",c),h=$(i,ne(A()));if("error"in h)throw new X(h.error,"failed to get stake minimum delegation");return h.result}async simulateTransaction(t,e,r){if("message"in t){const S=t.serialize(),M=Dt.Buffer.from(S).toString("base64");if(Array.isArray(e)||r!==void 0)throw new Error("Invalid arguments");const T=e||{};T.encoding="base64","commitment"in T||(T.commitment=this.commitment);const q=[M,T],I=await this._rpcRequest("simulateTransaction",q),N=$(I,ws);if("error"in N)throw new Error("failed to simulate transaction: "+N.error.message);return N.result}let c;if(t instanceof We){let E=t;c=new We,c.feePayer=E.feePayer,c.instructions=t.instructions,c.nonceInfo=E.nonceInfo,c.signatures=E.signatures}else c=We.populate(t),c._message=c._json=void 0;if(e!==void 0&&!Array.isArray(e))throw new Error("Invalid arguments");const i=e;if(c.nonceInfo&&i)c.sign(...i);else{let E=this._disableBlockhashCaching;for(;;){const S=await this._blockhashWithExpiryBlockHeight(E);if(c.lastValidBlockHeight=S.lastValidBlockHeight,c.recentBlockhash=S.blockhash,!i)break;if(c.sign(...i),!c.signature)throw new Error("!signature");const M=c.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(M)&&!this._blockhashInfo.transactionSignatures.includes(M)){this._blockhashInfo.simulatedSignatures.push(M);break}else E=!0}}const h=c._compile(),w=h.serialize(),b=c._serialize(w).toString("base64"),x={encoding:"base64",commitment:this.commitment};if(r){const E=(Array.isArray(r)?r:h.nonProgramIds()).map(S=>S.toBase58());x.accounts={encoding:"base64",addresses:E}}i&&(x.sigVerify=!0);const _=[b,x],L=await this._rpcRequest("simulateTransaction",_),k=$(L,ws);if("error"in k){let E;if("data"in k.error&&(E=k.error.data.logs,E&&Array.isArray(E))){const S=`
    `,M=S+E.join(S);console.error(k.error.message,M)}throw new ps("failed to simulate transaction: "+k.error.message,E)}return k.result}async sendTransaction(t,e,r){if("version"in t){if(e&&Array.isArray(e))throw new Error("Invalid arguments");const h=t.serialize();return await this.sendRawTransaction(h,e)}if(e===void 0||!Array.isArray(e))throw new Error("Invalid arguments");const c=e;if(t.nonceInfo)t.sign(...c);else{let h=this._disableBlockhashCaching;for(;;){const w=await this._blockhashWithExpiryBlockHeight(h);if(t.lastValidBlockHeight=w.lastValidBlockHeight,t.recentBlockhash=w.blockhash,t.sign(...c),!t.signature)throw new Error("!signature");const y=t.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(y))h=!0;else{this._blockhashInfo.transactionSignatures.push(y);break}}}const i=t.serialize();return await this.sendRawTransaction(i,r)}async sendRawTransaction(t,e){const r=Ur(t).toString("base64");return await this.sendEncodedTransaction(r,e)}async sendEncodedTransaction(t,e){const r={encoding:"base64"},c=e&&e.skipPreflight,i=e&&e.preflightCommitment||this.commitment;e&&e.maxRetries!=null&&(r.maxRetries=e.maxRetries),e&&e.minContextSlot!=null&&(r.minContextSlot=e.minContextSlot),c&&(r.skipPreflight=c),i&&(r.preflightCommitment=i);const h=[t,r],w=await this._rpcRequest("sendTransaction",h),y=$(w,gf);if("error"in y){let b;throw"data"in y.error&&(b=y.error.data.logs),new ps("failed to send transaction: "+y.error.message,b)}return y.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(t){this._rpcWebSocketConnected=!1,console.error("ws error:",t.message)}_wsOnClose(t){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),t===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([e,r])=>{this._setSubscription(e,{...r,state:"pending"})})}_setSubscription(t,e){var c;const r=(c=this._subscriptionsByHash[t])==null?void 0:c.state;if(this._subscriptionsByHash[t]=e,r!==e.state){const i=this._subscriptionStateChangeCallbacksByHash[t];i&&i.forEach(h=>{try{h(e.state)}catch{}})}}_onSubscriptionStateChange(t,e){var i;const r=this._subscriptionHashByClientSubscriptionId[t];if(r==null)return()=>{};const c=(i=this._subscriptionStateChangeCallbacksByHash)[r]||(i[r]=new Set);return c.add(e),()=>{c.delete(e),c.size===0&&delete this._subscriptionStateChangeCallbacksByHash[r]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(r){r instanceof Error&&console.log(`Error when closing socket connection: ${r.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const t=this._rpcWebSocketGeneration,e=()=>t===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async r=>{const c=this._subscriptionsByHash[r];if(c!==void 0)switch(c.state){case"pending":case"unsubscribed":if(c.callbacks.size===0){delete this._subscriptionsByHash[r],c.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[c.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:i,method:h}=c;try{this._setSubscription(r,{...c,state:"subscribing"});const w=await this._rpcWebSocket.call(h,i);this._setSubscription(r,{...c,serverSubscriptionId:w,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[w]=c.callbacks,await this._updateSubscriptions()}catch(w){if(w instanceof Error&&console.error(`${h} error for argument`,i,w.message),!e())return;this._setSubscription(r,{...c,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":c.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:i,unsubscribeMethod:h}=c;if(this._subscriptionsAutoDisposedByRpc.has(i))this._subscriptionsAutoDisposedByRpc.delete(i);else{this._setSubscription(r,{...c,state:"unsubscribing"}),this._setSubscription(r,{...c,state:"unsubscribing"});try{await this._rpcWebSocket.call(h,[i])}catch(w){if(w instanceof Error&&console.error(`${h} error:`,w.message),!e())return;this._setSubscription(r,{...c,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(r,{...c,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(t,e){const r=this._subscriptionCallbacksByServerSubscriptionId[t];r!==void 0&&r.forEach(c=>{try{c(...e)}catch(i){console.error(i)}})}_wsOnAccountNotification(t){const{result:e,subscription:r}=$(t,qh);this._handleServerNotification(r,[e.value,e.context])}_makeSubscription(t,e){const r=this._nextClientSubscriptionId++,c=ds([t.method,e],!0),i=this._subscriptionsByHash[c];return i===void 0?this._subscriptionsByHash[c]={...t,args:e,callbacks:new Set([t.callback]),state:"pending"}:i.callbacks.add(t.callback),this._subscriptionHashByClientSubscriptionId[r]=c,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const h=this._subscriptionsByHash[c];ie(h!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),h.callbacks.delete(t.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(t,e,r){const c=this._buildArgs([t.toBase58()],r||this._commitment||"finalized","base64");return this._makeSubscription({callback:e,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},c)}async removeAccountChangeListener(t){await this._unsubscribeClientSubscription(t,"account change")}_wsOnProgramAccountNotification(t){const{result:e,subscription:r}=$(t,Fh);this._handleServerNotification(r,[{accountId:e.value.pubkey,accountInfo:e.value.account},e.context])}onProgramAccountChange(t,e,r,c){const i=this._buildArgs([t.toBase58()],r||this._commitment||"finalized","base64",c?{filters:c}:void 0);return this._makeSubscription({callback:e,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},i)}async removeProgramAccountChangeListener(t){await this._unsubscribeClientSubscription(t,"program account change")}onLogs(t,e,r){const c=this._buildArgs([typeof t=="object"?{mentions:[t.toString()]}:t],r||this._commitment||"finalized");return this._makeSubscription({callback:e,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},c)}async removeOnLogsListener(t){await this._unsubscribeClientSubscription(t,"logs")}_wsOnLogsNotification(t){const{result:e,subscription:r}=$(t,wf);this._handleServerNotification(r,[e.value,e.context])}_wsOnSlotNotification(t){const{result:e,subscription:r}=$(t,zh);this._handleServerNotification(r,[e])}onSlotChange(t){return this._makeSubscription({callback:t,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(t){await this._unsubscribeClientSubscription(t,"slot change")}_wsOnSlotUpdatesNotification(t){const{result:e,subscription:r}=$(t,Hh);this._handleServerNotification(r,[e])}onSlotUpdate(t){return this._makeSubscription({callback:t,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(t){await this._unsubscribeClientSubscription(t,"slot update")}async _unsubscribeClientSubscription(t,e){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[t];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${t}\` for '${e}' events could not be found.`)}_buildArgs(t,e,r,c){const i=e||this._commitment;if(i||r||c){let h={};r&&(h.encoding=r),i&&(h.commitment=i),c&&(h=Object.assign(h,c)),t.push(h)}return t}_buildArgsAtLeastConfirmed(t,e,r,c){const i=e||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(t,e,r,c)}_wsOnSignatureNotification(t){const{result:e,subscription:r}=$(t,$h);e.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,e.value==="receivedSignature"?[{type:"received"},e.context]:[{type:"status",result:e.value},e.context])}onSignature(t,e,r){const c=this._buildArgs([t],r||this._commitment||"finalized"),i=this._makeSubscription({callback:(h,w)=>{if(h.type==="status"){e(h.result,w);try{this.removeSignatureListener(i)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},c);return i}onSignatureWithOptions(t,e,r){const{commitment:c,...i}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},h=this._buildArgs([t],c,void 0,i),w=this._makeSubscription({callback:(y,b)=>{e(y,b);try{this.removeSignatureListener(w)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},h);return w}async removeSignatureListener(t){await this._unsubscribeClientSubscription(t,"signature result")}_wsOnRootNotification(t){const{result:e,subscription:r}=$(t,Wh);this._handleServerNotification(r,[e])}onRootChange(t){return this._makeSubscription({callback:t,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(t){await this._unsubscribeClientSubscription(t,"root change")}}class on{constructor(t){this._keypair=void 0,this._keypair=t??us()}static generate(){return new on(us())}static fromSecretKey(t,e){if(t.byteLength!==64)throw new Error("bad secret key size");const r=t.slice(32,64);if(!e||!e.skipValidation){const c=t.slice(0,32),i=oi(c);for(let h=0;h<32;h++)if(r[h]!==i[h])throw new Error("provided secretKey is invalid")}return new on({publicKey:r,secretKey:t})}static fromSeed(t){const e=oi(t),r=new Uint8Array(64);return r.set(t),r.set(e,32),new on({publicKey:e,secretKey:r})}get publicKey(){return new it(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:Q([nt("instruction"),Fr("recentSlot"),jt("bumpSeed")])},FreezeLookupTable:{index:1,layout:Q([nt("instruction")])},ExtendLookupTable:{index:2,layout:Q([nt("instruction"),Fr(),fe(Ht(),Mr(nt(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:Q([nt("instruction")])},CloseLookupTable:{index:4,layout:Q([nt("instruction")])}});new it("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:Q([jt("instruction"),nt("units"),nt("additionalFee")])},RequestHeapFrame:{index:1,layout:Q([jt("instruction"),nt("bytes")])},SetComputeUnitLimit:{index:2,layout:Q([jt("instruction"),nt("units")])},SetComputeUnitPrice:{index:3,layout:Q([jt("instruction"),Fr("microLamports")])}});new it("ComputeBudget111111111111111111111111111111");Q([jt("numSignatures"),jt("padding"),ye("signatureOffset"),ye("signatureInstructionIndex"),ye("publicKeyOffset"),ye("publicKeyInstructionIndex"),ye("messageDataOffset"),ye("messageDataSize"),ye("messageInstructionIndex")]);new it("Ed25519SigVerify111111111111111111111111111");Ki.utils.isValidPrivateKey;Ki.getPublicKey;Q([jt("numSignatures"),ye("signatureOffset"),jt("signatureInstructionIndex"),ye("ethAddressOffset"),jt("ethAddressInstructionIndex"),ye("messageDataOffset"),ye("messageDataSize"),jt("messageInstructionIndex"),re(20,"ethAddress"),re(64,"signature"),jt("recoveryId")]);new it("KeccakSecp256k11111111111111111111111111111");var Zo;new it("StakeConfig11111111111111111111111111111111");class Vo{constructor(t,e,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=t,this.epoch=e,this.custodian=r}}Zo=Vo;Vo.default=new Zo(0,0,it.default);Object.freeze({Initialize:{index:0,layout:Q([nt("instruction"),Lu(),Cu()])},Authorize:{index:1,layout:Q([nt("instruction"),Ht("newAuthorized"),nt("stakeAuthorizationType")])},Delegate:{index:2,layout:Q([nt("instruction")])},Split:{index:3,layout:Q([nt("instruction"),ge("lamports")])},Withdraw:{index:4,layout:Q([nt("instruction"),ge("lamports")])},Deactivate:{index:5,layout:Q([nt("instruction")])},Merge:{index:7,layout:Q([nt("instruction")])},AuthorizeWithSeed:{index:8,layout:Q([nt("instruction"),Ht("newAuthorized"),nt("stakeAuthorizationType"),Lr("authoritySeed"),Ht("authorityOwner")])}});new it("Stake11111111111111111111111111111111111111");Object.freeze({InitializeAccount:{index:0,layout:Q([nt("instruction"),Pu()])},Authorize:{index:1,layout:Q([nt("instruction"),Ht("newAuthorized"),nt("voteAuthorizationType")])},Withdraw:{index:3,layout:Q([nt("instruction"),ge("lamports")])},AuthorizeWithSeed:{index:10,layout:Q([nt("instruction"),Ou()])}});new it("Vote111111111111111111111111111111111111111");new it("Va1idator1nfo111111111111111111111111111111");z({name:H(),website:ot(H()),details:ot(H()),keybaseUsername:ot(H())});new it("Vote111111111111111111111111111111111111111");Q([Ht("nodePubkey"),Ht("authorizedWithdrawer"),jt("commission"),ce(),fe(Q([ce("slot"),nt("confirmationCount")]),Mr(nt(),-8),"votes"),jt("rootSlotValid"),ce("rootSlot"),ce(),fe(Q([ce("epoch"),Ht("authorizedVoter")]),Mr(nt(),-8),"authorizedVoters"),Q([fe(Q([Ht("authorizedPubkey"),ce("epochOfLastAuthorizedSwitch"),ce("targetEpoch")]),32,"buf"),ce("idx"),jt("isEmpty")],"priorVoters"),ce(),fe(Q([ce("epoch"),ce("credits"),ce("prevCredits")]),Mr(nt(),-8),"epochCredits"),Q([ce("slot"),ce("timestamp")],"lastTimestamp")]);function vf(o){return(t,e,r,c)=>t.method==="solana_chainId"?(e.result=o,c()):r()}function bf(o){return(t,e,r,c)=>t.method==="solana_provider_config"?(e.result=o,c()):r()}function Yo(o){const{chainId:t}=o;return fn([vf(t),bf(o)])}function xf(o){const{rpcTarget:t}=o,e=aa({rpcTarget:t});return{networkMiddleware:fn([Yo(o),e]),fetchMiddleware:e}}function Mf(o){let{getAccounts:t}=o;return Ln(async(e,r,c)=>{const{method:i}=e;if(i!=="getAccounts")return c();if(!t)throw new Error("WalletMiddleware - opts.getAccounts not provided");const h=await t(e);r.result=h})}function _f(o){let{requestAccounts:t}=o;return Ln(async(e,r,c)=>{const{method:i}=e;if(i!=="requestAccounts")return c();if(!t)throw new Error("WalletMiddleware - opts.requestAccounts not provided");const h=await t(e);r.result=h})}function Ce(o,t){return Ln(async(e,r,c)=>{const{method:i}=e;if(i!==o)return c();if(!t)throw new Error("WalletMiddleware - ".concat(o," not provided"));const h=await t(e);r.result=h})}function ji(o){const{getAccounts:t,requestAccounts:e,signTransaction:r,signAndSendTransaction:c,signAllTransactions:i,signMessage:h,getPrivateKey:w,getSecretKey:y}=o;return fn([_f({requestAccounts:e}),Mf({getAccounts:t}),Ce("signTransaction",r),Ce("signAndSendTransaction",c),Ce("signAllTransactions",i),Ce("signMessage",h),Ce("solanaPrivateKey",w),Ce("solanaSecretKey",y)])}function Sf(o){let{addNewChainConfig:t,switchSolanaChain:e}=o;return fn([Ce("addSolanaChain",t),Ce("switchSolanaChain",e)])}function Ef(o){let{updatePrivatekey:t}=o;return fn([Ce("updateAccount",t)])}function bs(o,t){var e=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),e.push.apply(e,r)}return e}function xs(o){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?bs(Object(e),!0).forEach(function(r){Kr(o,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(e)):bs(Object(e)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(e,r))})}return o}class zn extends pi{constructor(t){let{config:e,state:r}=t;super({config:{chainConfig:xs(xs({},e.chainConfig),{},{chainNamespace:Mn.SOLANA})},state:r})}async switchChain(t){return Promise.resolve()}async setupProvider(t){const e=new di,r=this.getProviderHandlers(t),c=ji(r);e.push(c);const i=Yo(this.config.chainConfig);e.push(i);const h=this.getInjectedProviderProxy(t);h&&e.push(h);const w=gi(e);this.updateProviderEngineProxy(w),await this.lookupNetwork()}async lookupNetwork(){const{chainConfig:t}=this.config;return this.update({chainId:t.chainId}),t.chainId||""}getInjectedProviderProxy(t){}}const Gi=o=>({requestAccounts:async()=>o.publicKey?[Zt.encode(o.publicKey.toBytes())]:[],getAccounts:async()=>o.publicKey?[Zt.encode(o.publicKey.toBytes())]:[],getPrivateKey:async()=>{throw $t.ethErrors.rpc.methodNotSupported()},getSecretKey:async()=>{throw $t.ethErrors.rpc.methodNotSupported()},signTransaction:async e=>await o.signTransaction(e.params.message),signMessage:async e=>(await o.signMessage(e.params.message,e.params.display)).signature,signAllTransactions:async e=>{var r,c;if(!((r=e.params)!==null&&r!==void 0&&r.message)||!((c=e.params)!==null&&c!==void 0&&c.message.length))throw $t.ethErrors.rpc.invalidParams("message");return await o.signAllTransactions(e.params.message)},signAndSendTransaction:async e=>({signature:(await o.signAndSendTransaction(e.params.message)).signature})});function Ms(o,t){var e=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),e.push.apply(e,r)}return e}function kf(o){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Ms(Object(e),!0).forEach(function(r){Kr(o,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(e)):Ms(Object(e)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(e,r))})}return o}function Jo(o){return Ln(async(t,e,r)=>{const c=await o.request(kf({},t));e.result=c})}class Bf extends zn{getProviderHandlers(t){return Gi(t)}getInjectedProviderProxy(t){return Jo(t)}}const Af=(o,t)=>({requestAccounts:async()=>{const{data:r}=await o.connect();return[r.publicKey]},getAccounts:async()=>{const{data:r}=await o.connect();return[r.publicKey]},getPrivateKey:async()=>{throw $t.ethErrors.rpc.methodNotSupported()},getSecretKey:async()=>{throw $t.ethErrors.rpc.methodNotSupported()},signTransaction:async r=>{const c=r.params.message;if(!c)throw $t.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});const{data:i}=await o.signTransaction(Zt.encode(c.serializeMessage()));if(!i.publicKey||!i.signature)throw new Error("Invalid signature from slope wallet");const h=new it(i.publicKey),w=Zt.decode(i.signature);return c.addSignature(h,w),c},signMessage:async r=>{const c=await o.signMessage(r.params.message);return Zt.decode(c.data.signature)},signAndSendTransaction:async r=>{const c=t();if(!c)throw $t.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const i=r.params.message;if(!i)throw $t.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});const{data:h}=await o.signTransaction(Zt.encode(i.serializeMessage()));if(!h.publicKey||!h.signature)throw new Error("Invalid signature from slope wallet");const w=new it(h.publicKey),y=Zt.decode(h.signature);i.addSignature(w,y);const b=await c.request({method:"solana_provider_config",params:[]});return{signature:await new Wi(b.rpcTarget).sendRawTransaction(i.serialize())}},signAllTransactions:async r=>{var c,i,h;if(!((c=r.params)!==null&&c!==void 0&&c.message)||!((i=r.params)!==null&&i!==void 0&&i.message.length))throw $t.ethErrors.rpc.invalidParams("message");const w=r.params.message,{length:y}=w,b=[];for(let k=0;k<y;k++)b.push(Zt.encode(r.params.message[k].serializeMessage()));const{msg:x,data:_}=await o.signAllTransactions(b);if(!_.publicKey||((h=_.signatures)===null||h===void 0?void 0:h.length)!==y)throw new Error(x);const L=new it(_.publicKey);for(let k=0;k<y;k++){const E=Zt.decode(_.signatures[k]);w[k].addSignature(L,E)}return w}});class If extends zn{getProviderHandlers(t){return Af(t,this.getProviderEngineProxy.bind(this))}}const Rf=(o,t)=>{const e=Gi(o);return e.signAndSendTransaction=async r=>{const c=t();if(!c)throw $t.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const i=await o.signTransaction(r.params.message),h=await c.request({method:"solana_provider_config",params:[]});return{signature:await new Wi(h.rpcTarget).sendRawTransaction(i.serialize())}},e};class Tf extends zn{getProviderHandlers(t){return Rf(t,this.getProviderEngineProxy.bind(this))}}const Lf=(o,t)=>{const e=Gi(o);return e.signMessage=async r=>{const{signature:c}=await o.sign(r.params.message,"utf8");return c},e.signAndSendTransaction=async r=>{const c=t();if(!c)throw $t.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const i=await o.signTransaction(r.params.message),h=await c.request({method:"solana_provider_config",params:[]});return{signature:await new Wi(h.rpcTarget).sendRawTransaction(i.serialize())}},e};class Cf extends zn{getProviderHandlers(t){return Lf(t,this.getProviderEngineProxy.bind(this))}}const Pf=o=>({requestAccounts:async()=>await o.request({method:"solana_requestAccounts",params:{}}),getAccounts:async()=>await o.request({method:"solana_requestAccounts",params:{}}),getPrivateKey:async()=>{throw $t.ethErrors.rpc.methodNotSupported()},getSecretKey:async()=>{throw $t.ethErrors.rpc.methodNotSupported()},signMessage:async e=>{var r;if(!((r=e.params)!==null&&r!==void 0&&r.message))throw $t.ethErrors.rpc.invalidParams("message");return await o.signMessage(e.params.message)},signTransaction:async e=>{var r;if(!((r=e.params)!==null&&r!==void 0&&r.message))throw $t.ethErrors.rpc.invalidParams("message");const c=e.params.message;return await o.signTransaction(c)},signAndSendTransaction:async e=>{var r;if(!((r=e.params)!==null&&r!==void 0&&r.message))throw $t.ethErrors.rpc.invalidParams("message");const c=e.params.message;return{signature:await o.sendTransaction(c)}},signAllTransactions:async e=>{var r,c;if(!((r=e.params)!==null&&r!==void 0&&r.message)||!((c=e.params)!==null&&c!==void 0&&c.message.length))throw $t.ethErrors.rpc.invalidParams("message");const i=e.params.message;return await o.signAllTransactions(i)}});function _s(o,t){var e=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),e.push.apply(e,r)}return e}function bn(o){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?_s(Object(e),!0).forEach(function(r){Kr(o,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(e)):_s(Object(e)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(e,r))})}return o}class Of extends pi{constructor(t){let{config:e,state:r}=t;super({config:{chainConfig:bn(bn({},e.chainConfig),{},{chainNamespace:Mn.SOLANA})},state:r})}async switchChain(t){return Promise.resolve()}async setupProvider(t){this.handleInjectedProviderUpdate(t),await this.setupEngine(t)}async lookupNetwork(){if(!this.provider)throw $t.ethErrors.provider.custom({message:"Torus solana provider is not initialized",code:4902});const{chainId:t}=this.config.chainConfig,e=await this.provider.request({method:"solana_chainId"}),r=Zi(e.toString())?e:"0x".concat(parseInt(e,10).toString(16));if(t!==r)throw li.rpcConnectionError("Invalid network, net_version is: ".concat(r,", expected: ").concat(t));return this.update({chainId:r}),this.provider.emit("connect",{chainId:this.state.chainId}),this.provider.emit("chainChanged",this.state.chainId),this.state.chainId}async setupEngine(t){const e=Pf(t),r=ji(e),c=Jo(t),i=new di;i.push(r),i.push(c);const h=gi(i);this.updateProviderEngineProxy(h),await this.lookupNetwork()}async handleInjectedProviderUpdate(t){t.on("accountsChanged",async e=>{this.provider.emit("accountsChanged",e)}),t.on("chainChanged",async e=>{const r=Zi(e)?e:"0x".concat(parseInt(e,10).toString(16));this.configure({chainConfig:bn(bn({},this.config.chainConfig),{},{chainId:r})}),await this.setupProvider(t)})}}async function Nf(o){let{privKey:t,getProviderEngineProxy:e}=o;const r=()=>on.fromSecretKey(Buffer.from(t,"hex"));if(typeof t!="string")throw li.invalidParams("privKey must be a string");const c=r();return{requestAccounts:async()=>[c.publicKey.toBase58()],getAccounts:async()=>[c.publicKey.toBase58()],getPrivateKey:async()=>t,getSecretKey:async()=>Zt.encode(c.secretKey),signTransaction:async h=>{var w;if(!((w=h.params)!==null&&w!==void 0&&w.message))throw $t.ethErrors.rpc.invalidParams("message");const y=h.params.message;return y.partialSign(c),y},signMessage:async h=>{var w;if(!((w=h.params)!==null&&w!==void 0&&w.message))throw $t.ethErrors.rpc.invalidParams("message");return ca.sign.detached(h.params.message,c.secretKey)},signAndSendTransaction:async h=>{var w;if(!((w=h.params)!==null&&w!==void 0&&w.message))throw $t.ethErrors.rpc.invalidParams("message");const y=e();if(!y)throw $t.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const b=h.params.message;return b.sign(c),{signature:await y.request({method:"sendTransaction",params:[Zt.encode(b.serialize())]})}},signAllTransactions:async h=>{var w,y,b;if(!((w=h.params)!==null&&w!==void 0&&w.message)||!((y=h.params)!==null&&y!==void 0&&y.message.length))throw $t.ethErrors.rpc.invalidParams("message");const x=(b=h.params)===null||b===void 0?void 0:b.message;for(const _ of x||[])_.partialSign(c);return x}}}function Ss(o,t){var e=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),e.push.apply(e,r)}return e}function Es(o){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Ss(Object(e),!0).forEach(function(r){Kr(o,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(e)):Ss(Object(e)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(e,r))})}return o}class fi extends pi{constructor(t){let{config:e,state:r}=t;super({config:{chainConfig:Es(Es({},e.chainConfig),{},{chainNamespace:Mn.SOLANA})},state:r})}async enable(){if(!this.state.privateKey)throw $t.ethErrors.provider.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});return await this.setupProvider(this.state.privateKey),this._providerEngineProxy.request({method:"eth_accounts"})}async setupProvider(t){const e=await Nf({privKey:t,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)}),r=ji(e),c=new di,{networkMiddleware:i}=xf(this.config.chainConfig);c.push(this.getChainSwitchMiddleware()),c.push(this.getAccountMiddleware()),c.push(r),c.push(i);const h=gi(c);this.updateProviderEngineProxy(h),await this.lookupNetwork()}async updateAccount(t){if(!this._providerEngineProxy)throw $t.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});await this._providerEngineProxy.request({method:"solanaPrivateKey"})!==t.privateKey&&(await this.setupProvider(t.privateKey),this._providerEngineProxy.emit("accountsChanged",{accounts:await this._providerEngineProxy.request({method:"requestAccounts"})}))}async switchChain(t){if(!this._providerEngineProxy)throw $t.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const e=this.getChainConfig(t.chainId);this.update({chainId:"loading"}),this.configure({chainConfig:e});const r=await this._providerEngineProxy.request({method:"solanaPrivateKey"});await this.setupProvider(r)}async lookupNetwork(){if(!this._providerEngineProxy)throw $t.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const t=await this._providerEngineProxy.request({method:"getHealth",params:[]}),{chainConfig:e}=this.config;if(t!=="ok")throw li.rpcConnectionError("Failed to lookup network for following rpc target: ".concat(e.rpcTarget));return this.update({chainId:e.chainId}),this.state.chainId!==e.chainId&&(this.provider.emit("chainChanged",this.state.chainId),this.provider.emit("connect",{chainId:this.state.chainId})),this.state.chainId}getChainSwitchMiddleware(){return Sf({addNewChainConfig:async r=>{if(!r.params)throw $t.ethErrors.rpc.invalidParams("Missing request params");const{chainId:c,chainName:i,rpcUrls:h,blockExplorerUrls:w,nativeCurrency:y}=r.params;if(!c)throw $t.ethErrors.rpc.invalidParams("Missing chainId in chainParams");if(!h||h.length===0)throw $t.ethErrors.rpc.invalidParams("Missing rpcUrls in chainParams");if(!y)throw $t.ethErrors.rpc.invalidParams("Missing nativeCurrency in chainParams");this.addChain({chainNamespace:Mn.SOLANA,chainId:c,ticker:(y==null?void 0:y.symbol)||"SOL",tickerName:(y==null?void 0:y.name)||"Solana",displayName:i,rpcTarget:h[0],blockExplorer:(w==null?void 0:w[0])||""})},switchSolanaChain:async r=>{if(!r.params)throw $t.ethErrors.rpc.invalidParams("Missing request params");if(!r.params.chainId)throw $t.ethErrors.rpc.invalidParams("Missing chainId");await this.switchChain(r.params)}})}getAccountMiddleware(){return Ef({updatePrivatekey:async e=>{if(!e.params)throw $t.ethErrors.rpc.invalidParams("Missing request params");if(!e.params.privateKey)throw $t.ethErrors.rpc.invalidParams("Missing privateKey");const{privateKey:r}=e.params;await this.updateAccount({privateKey:r})}})}}Kr(fi,"getProviderInstance",async o=>{const t=new fi({config:{chainConfig:o.chainConfig}});return await t.setupProvider(o.privKey),t});class qf{constructor(t){Kr(this,"provider",void 0),this.provider=t}async requestAccounts(){return await this.provider.request({method:"requestAccounts",params:{}})}async signAndSendTransaction(t){const{signature:e}=await this.provider.request({method:"signAndSendTransaction",params:{message:t}});return{signature:e}}async signTransaction(t){return await this.provider.request({method:"signTransaction",params:{message:t}})}async signAllTransactions(t){return await this.provider.request({method:"signAllTransactions",params:{message:t}})}async signMessage(t){return await this.provider.request({method:"signMessage",params:{message:t}})}async request(t){return await this.provider.request(t)}}const $f=Object.freeze(Object.defineProperty({__proto__:null,PhantomInjectedProvider:Bf,SlopeInjectedProxyProvider:If,SolanaPrivateKeyProvider:fi,SolanaWallet:qf,SolflareInjectedProvider:Tf,SolletInjectedProvider:Cf,TorusInjectedProvider:Of},Symbol.toStringTag,{value:"Module"}));export{it as P,Of as T,Bf as a,$f as s};
